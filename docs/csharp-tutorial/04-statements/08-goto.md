---
noteId: "eba7ca00797211f096197f4ef3b2c3fb"
tags: []

---

在 C# 中，`goto` 是一个**控制流语句（control flow statement）**，它允许程序**无条件地跳转到程序中某个指定的标签位置继续执行**。虽然 `goto` 在许多现代编程语言中被认为是不良实践（容易导致代码难以理解和维护，俗称 “面条代码” spaghetti code），但 **C# 仍然保留了 `goto` 语句，主要用于一些特定的、合理的场景**。

---

## 一、`goto` 语句的作用

| 功能 | 说明 |
|------|------|
| 🚀 **无条件跳转** | 让程序**立即跳转到程序中某个定义好的标签位置**继续执行 |
| 🎯 **控制流程** | 可用于跳出多层嵌套循环、统一错误处理、跳转到清理代码等 |
| ⚠️ **慎用** | 过度或不当使用 `goto` 会导致代码逻辑混乱、难以维护，通常有更好的替代方案（如结构化控制语句、函数封装、`return`、`break`、`continue` 等） |

---

## 二、`goto` 的基本语法

### 1. 定义标签：

```csharp
标签名:
```

- 标签名后面跟一个冒号 `:`，表示这是一个代码跳转的标记位置。
- 标签名遵循 C# 标识符命名规则（如不能以数字开头，不能是关键字，通常使用大写字母提高可读性）。

### 2. 跳转到标签：

```csharp
goto 标签名;
```

- 执行到这一句时，程序会**立即跳转到对应的标签位置**，并从那里继续执行后续代码。

---

## 三、`goto` 的常见使用场景与示例

---

### ✅ 示例 1：基本用法 —— 跳转到标签

```csharp
Console.WriteLine("开始");

goto MyLabel; // 无条件跳转

Console.WriteLine("这行不会执行"); // 被跳过了

MyLabel:
    Console.WriteLine("跳转到这里了！");
```

**输出：**
```
开始
跳转到这里了！
```

> 说明：程序执行到 `goto MyLabel;` 后，直接跳转到 `MyLabel:` 标签处继续执行，跳过了中间的代码。

---

### ✅ 示例 2：跳出多层嵌套循环（合理使用场景）

这是 `goto` 的一个**常见合理用途**：当你想从**深层嵌套循环中一次性跳出**时，使用 `goto` 可以简化代码，避免使用多个标志变量。

#### 场景：在双重循环中，满足某个条件时直接跳出所有循环

```csharp
for (int i = 1; i <= 3; i++)
{
    for (int j = 1; j <= 3; j++)
    {
        Console.WriteLine($"i = {i}, j = {j}");
        if (i == 2 && j == 2)
        {
            goto ExitLoops; // 直接跳出所有循环
        }
    }
}

ExitLoops:
Console.WriteLine("已跳出所有循环");
```

**输出：**
```
i = 1, j = 1
i = 1, j = 2
i = 1, j = 3
i = 2, j = 1
i = 2, j = 2
已跳出所有循环
```

> ✅ **这是 `goto` 的一个推荐使用场景**：当你想从深层嵌套中快速跳出，而又不想引入多个 `bool` 标志变量时，`goto` 能让代码更直接。

---

### ✅ 示例 3：统一错误处理或集中清理代码

在一些复杂逻辑中，你可能需要在多个地方判断错误，然后跳转到统一的错误处理或资源释放代码位置。

```csharp
bool hasError = false;

Console.WriteLine("步骤 1");
// 模拟出错
hasError = true;

if (hasError)
{
    goto ErrorHandler;
}

Console.WriteLine("步骤 2"); // 不会执行

ErrorHandler:
    Console.WriteLine("发生错误，进行清理或提示");
```

**输出：**
```
步骤 1
发生错误，进行清理或提示
```

> ✅ 适用于需要集中处理错误、日志记录、资源释放等场景，逻辑上把错误处理放在一个地方。

---

## 四、`goto` 的限制与规则

| 规则 | 说明 |
|------|------|
| ✅ `goto` 只能跳转到**当前方法内**的标签 | 不能跨方法跳转 |
| ✅ 标签必须定义在当前方法中 | 且格式为 `标签名:` |
| ⚠️ **不能跳入 if/else、循环、switch 等代码块的内部**（C# 不允许） | 比如不能从循环外部 `goto` 到循环内部 |
| ⚠️ **不能跳转到非代码块区域（比如变量声明之前）** | 标签必须在可执行代码区域内定义 |
| ⚠️ **避免滥用** | 过多的 `goto` 会让代码难以阅读和维护，通常有更好的替代方案 |

---

## 五、`goto` vs 其它控制语句（推荐替代方案）

| 语句 | 说明 | 是否推荐 |
|------|------|----------|
| **`goto`** | 无条件跳转到标签位置 | ⚠️ 慎用，仅在极少数合理场景下使用 |
| **`break`** | 跳出当前循环或 `switch` | ✅ 推荐，结构化 |
| **`continue`** | 跳过当前循环的剩余部分，进入下一次循环 | ✅ 推荐 |
| **`return`** | 从方法返回，可避免后续代码执行 | ✅ 推荐 |
| **标志变量 + if** | 通过布尔变量控制流程，替代 `goto` 跳出多层循环 | ✅ 更清晰，推荐 |

---

## 六、`goto` 在实际开发中的合理使用建议

虽然 `goto` 被认为是“不良实践”，但在 C# 中，它在以下**特定且可控的场景下是可以接受的**：

### ✅ 合理使用场景包括：

1. **跳出多层嵌套循环**（避免复杂的标志变量逻辑）
2. **集中错误处理或清理代码**（如跳转到统一的错误处理块）
3. **状态机或复杂控制流中简化逻辑（少数情况）**

### ❌ 应避免的场景：

- 随意跳转导致代码难以阅读（“面条代码”）
- 跳过变量初始化、跳入条件/循环内部
- 大量使用 `goto` 导致逻辑混乱

---

## 七、总结表格 ✅

| 项目 | 说明 |
|------|------|
| **语法** | `标签名:` 定义标签，`goto 标签名;` 执行跳转 |
| **作用** | 无条件跳转到程序中的某个位置继续执行 |
| **适用范围** | 只能在**当前方法内部**跳转 |
| **推荐程度** | ⚠️ 慎用！仅在极少数合理场景下使用（如跳出多层循环） |
| **替代方案** | 使用 `break`、`continue`、`return`、标志变量、函数封装等更结构化的方式 |
| **常见合理场景** | 跳出多重嵌套循环、统一错误处理、跳转到清理代码块 |

---

## ✅ 总结一句话：

> **C# 中的 `goto` 语句用于无条件跳转到程序中的某个标签位置，在某些特定场景下（如跳出多层嵌套循环）可以简化代码，但由于其容易导致代码混乱，通常应优先考虑使用结构化的控制语句（如 `break`、`continue`、`return` 等），`goto` 只应在非常明确且可控的情况下谨慎使用。**

---

### 🧠 想进一步学习？

- 如何用 `goto` 优雅地跳出多重循环（附实际例子）
- `goto` 在 **C# 异常处理流程** 或 **状态机设计** 中的应用（高级话题）
- 为什么很多语言（如 Java、Python）没有 `goto`，而 C# 保留了它？

欢迎继续提问！我可以为你提供更深入的示例与设计建议 😊。