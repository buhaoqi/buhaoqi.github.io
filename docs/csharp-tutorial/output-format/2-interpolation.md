---
noteId: "d0bc2730797d11f096197f4ef3b2c3fb"
tags: []

---


## **开场**  

> 🎙️ “大家好！欢迎观看《C#初学者实例教程》的第6课《插值字符串》—— 让输出更优雅。
> 
> 我是张杰。
> 
> 上节课我们学了如何通过 Console.ReadLine() 和 Console.WriteLine() 实现基本的数据输入与输出。
> 
> 今天，我们要让输出变得更——优——雅！

---
## 拼接字符串

先来复习下传统的拼接字符串的写法：

```csharp
string name = "小明";
int age = 20;
Console.WriteLine("姓名：" + name + "，年龄：" + age);
```

是不是有点啰嗦？尤其变量多的时候，拼接写法非常容易出错、可读性差。

---

## 插值字符串亮相！

插值字符串是一种字符串的特殊写法，特殊在于使用花括号把变量插入字符串内。语法格式更简洁：

```c# linenums="1"
$"字符串中嵌入变量：{变量名}"

```
说明：

- 字符串的双引号前面有个 美元符号 $
- 变量包在 `{}` 中

示例

```csharp
Console.WriteLine($"姓名：{name}，年龄：{age}");
```
我们来对比两种写法：插值字符串看起来更整洁，代码更易读，特别是当字符串中有多个变量时，优势更明显。

优点一看就懂：

* **更短**
* **更清晰**
* **更易维护**

---

## 支持表达式

插值字符串不仅能嵌入变量，还能直接写表达式：

```csharp
Console.WriteLine($"明年你就 {age + 1} 岁啦！");
```

甚至还能这样写：

```csharp
Console.WriteLine($"名字全大写是：{name.ToUpper()}");
```

是不是像在拼乐高，想放什么就放什么？

---

## 格式化数字输出
如果你想让数字显示得更美观，比如保留两位小数、显示为货币格式，也可以加上格式说明符。

其他常用数字格式说明符

| 格式符 | 作用 | 示例（输入=1234.5678） | 输出 |
|--------|------|-----------------------|------|
| `F2` | 固定2位小数 | `1234.5678.ToString("F2")` | `1234.57` |
| `C2` | 货币格式 | `1234.5678.ToString("C2")` | `¥1,234.57` |
| `N2` | 千分位分隔 | `1234.5678.ToString("N2")` | `1,234.57` |
| `P1` | 百分比1位小数 | `0.456.ToString("P1")` | `45.6%` |
| `0.00` | 强制补零 | `8.ToString("0.00")` | `8.00` |

---

1. 插值字符串还能格式化数字，比如：

```csharp
double price = 19.99;
Console.WriteLine($"商品价格：{price:F2} 元");  // 保留两位小数
```

`C2`表示将数值格式化为**固定小数点格式**，并**保留2位小数**。它的完整含义：

| 部分 | 说明 | 示例（price=12.5） |
|------|------|-------------------|
| `F` | Fixed-point（固定小数点格式） | 自动补零到指定小数位 |
| `2` | 小数位数 | 强制显示2位小数 |
| 结果 | `12.50`（自动补零） |

2.货币格式

```csharp
double salary = 8888.8;
Console.WriteLine($"月薪：{salary:C}");  // ¥8888.8
```

`C` 是一个**标准数字格式说明符**，表示将数值格式化为**货币（Currency）格式**。

| 特性                | 说明         | 示例（salary = 8888.8） |
|---------------------|-------------------|-------------------------|
| **货币符号**        | 自动添加当前区域设置的货币符号  | ¥8,888.80（中文环境）   |
| **千位分隔符**      | 每三位数字添加分隔符       | 8,888.80                |
| **小数位数**        | 默认保留2位小数（自动补零） | .80                     |
| **文化差异**        | 根据系统区域设置显示不同格式   | $8,888.80（美国环境）   |
| **自动四舍五入**    | 对小数部分进行银行家舍入  | 8888.8 → 8888.80        |


3.还有百分比格式：

```csharp
double rate = 0.256;
Console.WriteLine($"增长率：{rate:P1}");  // 25.6% P = Percent，保留1位小数
```
P1 是一个标准数字格式说明符，表示将数值格式化为百分比形式，并保留1位小数。

`P1` 的完整含义

| 部分 | 说明 | 数学转换规则 | 示例（rate=0.256） |
|------|------|--------------|-------------------|
| `P`  | Percentage（百分比格式） | 值 × 100 | 25.6 |
| `1`  | 小数位数 | 四舍五入到指定位数 | 25.6% |
| 结果 | **自动添加百分号** |  | `25.6%` |

关键特性

| 特性 | 说明 | 示例 |
|------|------|------|
| **自动乘100** | 输入值0.25 → 显示25% | `0.25 → "25.0%"` |
| **补零显示** | 不足小数位时补零 | `0.5 → "50.0%"` |
| **四舍五入** | 银行家舍入规则 | `0.256 → "25.6%"` |
| **文化差异** | 百分号位置可能变化 | 法语环境显示`25,6 %` |

---

与其他百分比格式对比

| 格式符 | 输入0.25678 | 输出（中文环境） | 特点 |
|--------|------------|------------------|------|
| `P`    | 0.25678    | 25.68%           | 默认2位小数 |
| `P1`   | 0.25678    | 25.7%            | 1位小数 |
| `P0`   | 0.25678    | 26%              | 整数百分比 |
| `P4`   | 0.25678    | 25.6780%         | 4位小数 |


---

## 总结
今天我们学会了：

- 插值字符串的基本语法：$"{变量}"
- 在插值字符串中使用表达式
- 格式化数字的几种方式（F2、C）

有了插值字符串，我们的输出就不再笨拙，而是清晰、自然、好维护！

---

## 结束语

到这里，我们的插值字符串就讲完啦！

不管你输出的是文字、数字，还是表情，插值字符串赶紧用起来，让你的代码更优雅！

本节课就到这里，这里是不好奇编程，我是张杰。感谢你的认真学习，我们下节课见！

下节预告：《插值字符串》—— 让输出更优雅。

慢慢学，一点点进步就很好！

## 课后练习

试试自己动手写：

1. 让用户输入姓名、成绩，用插值字符串输出一句话：

   > “学生 {name} 的成绩是 {score} 分。”

2. 输入一个价格，输出“价格为：￥xxx.xx”。

---



在 C# 中，**字符串插值（String Interpolation）** 是一种**非常简洁、直观、强大**的字符串格式化方式，它允许你**直接在字符串中嵌入变量、表达式或格式化内容**，而无需使用传统的字符串拼接（`+`）或占位符（如 `String.Format("{0}", value)`）。

---

## 一、什么是字符串插值？

**字符串插值** 是指：在字符串前加上一个 **`$` 符号**，然后你就可以在字符串中**直接使用 `{变量名}` 或 `{表达式}` 的形式，将变量的值或表达式的结果嵌入到字符串中**。

它让字符串的拼接和格式化变得更自然、更可读、更高效，是 C# 6.0 开始引入的一项重要特性。

---

## 二、基本语法

```csharp
string interpolatedString = $"文本内容 {变量名}";
```

- 在普通字符串前加一个 **`$`** 符号 → 表示这是一个**插值字符串**
- 在字符串中用 **`{表达式}`** 的形式嵌入变量、属性、方法返回值或任意表达式
- **大括号内可以是变量、简单表达式甚至格式化指令**

---

## 三、字符串插值 vs 传统字符串拼接

### ❌ 传统方式（不推荐，代码冗长、可读性差）

```csharp
string name = "Alice";
int age = 25;
string message = "姓名：" + name + "，年龄：" + age;
Console.WriteLine(message);
```

### ✅ 推荐方式：字符串插值（直观、清晰）

```csharp
string name = "Alice";
int age = 25;

// 使用 $ 符号定义插值字符串，并直接嵌入变量
string message = $"姓名：{name}，年龄：{age}";
Console.WriteLine(message);
```

**输出：**
```
姓名：Alice，年龄：25
```

> ✅ 更简洁、更直观，特别是当有多个变量需要拼接时，插值字符串优势更明显。

---

## 四、字符串插值的详细用法与示例

---

### ✅ 示例 1：基本用法 —— 嵌入变量

```csharp
string product = "苹果";
decimal price = 12.5m;

Console.WriteLine($"商品：{product}，价格：{price}");
```

**输出：**
```
商品：苹果，价格：12.5
```

---

### ✅ 示例 2：嵌入表达式

你可以在 `{}` 中放入**任意表达式**，不局限于变量名。

```csharp
int a = 10;
int b = 20;

Console.WriteLine($"a + b = {a + b}"); // 表达式
Console.WriteLine($"两数相乘：{a * b}");
Console.WriteLine($"明年年龄：{25 + 1}");
```

**输出：**
```
a + b = 30
两数相乘：200
明年年龄：26
```

---

### ✅ 示例 3：调用方法或属性

```csharp
string name = "Tom";
Console.WriteLine($"名字长度：{name.Length}"); // 调用属性
Console.WriteLine($"大写名字：{name.ToUpper()}"); // 调用方法
```

**输出：**
```
名字长度：3
大写名字：TOM
```

---

### ✅ 示例 4：格式化数字、日期等（重点 ✅）

字符串插值支持在 `{表达式}` 后加一个 **格式说明符**，用来控制该值的显示格式，语法为：

```csharp
{表达式:格式字符串}
```

#### 🧮 数字格式化示例：

```csharp
double number = 1234.5678;

Console.WriteLine($"默认：{number}");
Console.WriteLine($"保留两位小数：{number:F2}");    // 1234.57
Console.WriteLine($"整数格式：{number:F0}");       // 1235
Console.WriteLine($"千分位格式：{number:N2}");     // 1,234.57
Console.WriteLine($"科学计数法：{number:E2}");     // 1.23E+003
```

#### 💰 货币格式化：

```csharp
decimal price = 19.99m;
Console.WriteLine($"价格：{price:C}"); // ¥19.99（根据系统文化可能是 $19.99）
Console.WriteLine($"价格（美元风格）：{price:C2}"); // $19.99
```

#### 📅 日期时间格式化：

```csharp
DateTime now = DateTime.Now;

Console.WriteLine($"当前时间：{now}");
Console.WriteLine($"格式化日期：{now:yyyy-MM-dd}");          // 如：2024-06-01
Console.WriteLine($"格式化日期时间：{now:yyyy/MM/dd HH:mm:ss}");
Console.WriteLine($"友好格式：{now:dddd, MMMM dd}");
```

> 📌 常用格式说明符：
> - `F2`：保留 2 位小数
> - `N2`：带千分位分隔符，保留 2 位小数
> - `C`：货币格式
> - `P`：百分比格式（如 0.85 表示 85%）
> - `yyyy`、`MM`、`dd`、`HH:mm:ss`：年月日、时分秒
> - `dddd`：星期几全称

---

### ✅ 示例 5：多变量组合输出（适合复杂消息）

```csharp
string username = "Alice";
int loginCount = 42;
DateTime lastLogin = DateTime.Now;

Console.WriteLine($"用户 {username} 已登录 {loginCount} 次，上次登录时间：{lastLogin:yyyy-MM-dd HH:mm:ss}");
```

---

## 五、字符串插值的高级用法

---

### ✅ 嵌套插值（嵌套表达式）

你甚至可以在 `{}` 内再嵌入一个 `{}` 表达式，虽然不常见，但合法：

```csharp
int x = 10;
int y = 20;
Console.WriteLine($"结果：{ (x > y ? "X大" : "Y大 或相等") }");
```

---

### ✅ 在 LINQ 查询或集合遍历中使用插值

```csharp
using System;
using System.Linq;

var numbers = new int[] { 1, 2, 3, 4 };
var evenNumbers = numbers.Where(n => n % 2 == 0);

foreach (var n in evenNumbers)
{
    Console.WriteLine($"偶数：{n}，平方：{n * n}");
}
```

---

## 六、字符串插值 vs String.Format() vs 普通拼接

| 方法 | 语法 | 可读性 | 推荐程度 | 适用场景 |
|------|------|--------|----------|----------|
| **字符串插值 `$""`** | `"文本 {变量}"` | ✅ 非常高 | ✅ **强烈推荐**（C# 6.0+） | 大多数字符串拼接与格式化场景 |
| **String.Format()** | `"文本 {0}"`，然后传参 | ⚠️ 一般 | ⚠️ 传统写法，适合复杂格式 | 需要动态格式、本地化等高级场景 |
| **普通拼接 `+`** | `"a" + var + "b"` | ❌ 差，尤其多变量时 | ❌ 不推荐 | 简单少量固定字符串拼接 |

---

## 七、总结表格 ✅

| 特性 | 说明 |
|------|------|
| **语法** | 在字符串前加 `$`，然后使用 `{变量或表达式}` 嵌入内容 |
| **作用** | 简化字符串拼接与格式化，提高代码可读性 |
| **支持嵌入内容** | 变量、属性、方法调用、算术表达式、三元运算符等 |
| **支持格式化** | 支持数字、日期、货币等格式控制，如 `{price:F2}`, `{now:yyyy-MM-dd}` |
| **推荐程度** | ✅ **C# 开发中首选的字符串格式化方式**（尤其 C# 6.0 及以上） |
| **适用场景** | 输出信息、日志、UI 展示、调试、生成消息等几乎所有需要字符串组合的场景 |

---

## ✅ 总结一句话：

> **C# 中的字符串插值（String Interpolation）是一种通过在字符串前加 `$` 符号并使用 `{变量或表达式}` 的方式，将数据直接嵌入到字符串中的强大功能。它让代码更简洁、可读性更强，是替代传统字符串拼接和 `String.Format()` 的现代、优雅的解决方案，强烈推荐在 C# 开发中使用。**

---

### 🧠 想进一步学习？

- 如何在插值字符串中使用**自定义格式**
- 如何结合 **LINQ、集合、对象属性** 使用插值输出
- 如何在 ASP.NET Core / MVC 视图、日志系统、文件输出等场景使用插值
- 字符串插值与 **资源本地化（Localization）** 的结合

欢迎继续提问！我可以为你提供详细示例 😊。