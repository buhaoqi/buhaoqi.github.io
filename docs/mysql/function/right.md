---
noteId: "30dafb10308011f08660ed443661e5a0"
tags: []

---

---

### **MySQL 中的 `RIGHT()` 函数详解**

`RIGHT()` 函数用于从字符串的 **右侧（末尾）** 提取指定数量的字符，适用于需要截取固定后缀或末尾数据的场景。以下是其详细说明及使用指南。

---

### **一、语法与参数**
```sql
RIGHT(str, length)
```
- **参数说明**：
  - `str`：原始字符串（可以是字段名或字符串字面量）。
  - `length`：要截取的字符数（必须为正整数）。
- **返回值**：
  - 从字符串右侧开始截取的子字符串。
  - 若 `length` 为 `0` 或负数，返回空字符串 `''`。
  - 若 `str` 为 `NULL`，返回 `NULL`。

---

### **二、核心功能与示例**

#### **1. 基础截取**
| **场景**               | **示例**                   | **输出结果**      | **说明**                     |
|------------------------|---------------------------|-------------------|-----------------------------|
| 截取后 N 个字符        | `RIGHT('Hello World', 5)` | `'World'`         | 截取末尾5个字符             |
| 长度等于字符串长度     | `RIGHT('MySQL', 5)`       | `'MySQL'`         | 完整返回原字符串            |
| 长度超过字符串长度     | `RIGHT('abc', 10)`        | `'abc'`           | 返回整个字符串              |
| 空字符串或长度为0      | `RIGHT('', 3)`            | `''`              | 返回空字符串                |

#### **2. 多字节字符处理（如中文、Emoji）**
```sql
-- 示例字符串：'你好世界'（UTF-8 编码，每个中文字符占3字节）
SELECT RIGHT('你好世界', 2);  -- 输出 '世界'（按字符计数，而非字节）
```

#### **3. 边界条件处理**
| **场景**               | **示例**                   | **输出结果**      |
|------------------------|---------------------------|-------------------|
| `length` 为负数        | `RIGHT('Hello', -2)`      | `''`              |
| `length` 为0           | `RIGHT('Hello', 0)`       | `''`              |
| `str` 为 `NULL`        | `RIGHT(NULL, 3)`          | `NULL`            |

---

### **三、与 `SUBSTRING()` 的关系**
`RIGHT()` 可以看作是 `SUBSTRING()` 的简化形式，以下两种写法等价：
```sql
-- 使用 RIGHT()
SELECT RIGHT('Hello World', 5);  -- 输出 'World'

-- 使用 SUBSTRING()
SELECT SUBSTRING('Hello World', -5);  -- 输出 'World'
```

---

### **四、实际应用场景**

#### **场景 1：提取文件扩展名**
```sql
-- 假设文件名格式为 'document.pdf'
SELECT RIGHT(file_name, 3) AS file_extension FROM files;
-- 结果示例：'pdf'
```

#### **场景 2：隐藏手机号中间四位**
```sql
-- 显示后四位（如 '138****5678'）
SELECT CONCAT('****', RIGHT(phone, 4)) AS masked_phone 
FROM users;
```

#### **场景 3：提取身份证号后4位（校验码）**
```sql
SELECT RIGHT(id_card, 4) AS check_code FROM employees;
```

---

### **五、性能与注意事项**
1. **索引影响**：  
   - 在 `WHERE` 子句中直接使用 `RIGHT()` 可能导致全表扫描。  
   - **优化方案**：  
     - 预存截取结果到新字段并建立索引。  
     - 使用函数索引（MySQL 8.0+）：  
       ```sql
       CREATE INDEX idx_file_extension ON files ((RIGHT(file_name, 3)));
       ```

2. **多字节字符集**：  
   - `RIGHT()` 按字符截取，而非字节。确保字符集支持（如 `utf8mb4`）。

3. **长度参数处理**：  
   - `length` 必须是正整数，否则返回空字符串或无效结果。

---

### **六、与其他函数的对比**
| **函数**       | **语法**                     | **特点**                          | **适用场景**               |
|----------------|------------------------------|-----------------------------------|----------------------------|
| `RIGHT()`      | `RIGHT(str, length)`         | 从右侧截取固定长度的字符          | 提取后缀（如扩展名、校验码）|
| `LEFT()`       | `LEFT(str, length)`          | 从左侧截取固定长度的字符          | 提取前缀（如日期、区号）   |
| `SUBSTRING()`  | `SUBSTRING(str, start, len)` | 灵活截取任意位置的子字符串        | 复杂截取需求               |

---

### **七、总结**
- **核心作用**：快速截取字符串右侧固定长度的内容。
- **最佳实践**：  
  - 处理固定格式数据（如文件扩展名、校验码）。  
  - 结合 `CONCAT()` 或 `LEFT()` 实现复杂格式化。  
- **适用场景**：  
  - 数据清洗（提取关键字段）。  
  - 敏感信息脱敏（隐藏部分内容）。  
  - 格式验证（检查文件类型）。  

掌握 `RIGHT()` 的使用方法，可以高效完成字符串截取需求，但需注意性能优化和字符集兼容性。