---
noteId: "fcda32502da411f0b12143716a9ddc9b"
tags: []

---


## 单表数据

### 员工信息表(employees)

生成50条练习mysql表查询的公司员工信息表(employees)，要求：

- id 
- 员工编号（e_id）:员工编号格式：D001，
- 姓名（e_name）
- 性别（e_gender）
- 年龄（e_age）：25 - 60岁 
- 学历（e_education）：大专、本科、研究生
- 身份证号（e_id_card）
- 省份（e_province）: 河北、河南、山东、山西、北京、天津
- 城市（e_city）：邯郸、邢台、济南、郑州、安阳、太原、北京、天津
- 电邮（e_email）：后缀163.com  qq.com  126.com sohu.com
- 月薪（e_salary）：3000 - 15000 
- 职位（e_job）：财务总监、人力总监、技术总监、市场总监、行政主管、后勤主任、会计、HR、设计师、程序员、销售员、办公文员、电工、保安
- 部门（e_department）：财务部、人力部、技术部、市场部、行政部、后勤部；
- 入职日期（e_hiredate）

以下是50条符合要求的MySQL员工信息数据插入语句及对应的建表语句：

```sql
-- 建表语句
CREATE TABLE employees (
    id INT AUTO_INCREMENT PRIMARY KEY,
    e_id VARCHAR(4) NOT NULL UNIQUE,
    e_name VARCHAR(20) NOT NULL,
    e_gender ENUM('男','女') NOT NULL,
    e_age TINYINT CHECK (e_age BETWEEN 25 AND 60),
    e_education ENUM('大专','本科','研究生') NOT NULL,
    e_id_card CHAR(18) NOT NULL UNIQUE,
    e_province ENUM('河北','河南','山东','山西','北京','天津') NOT NULL,
    e_city ENUM('邯郸','邢台','济南','郑州','安阳','太原','北京','天津') NOT NULL,
    e_email VARCHAR(50) NOT NULL,
    e_salary DECIMAL(8,2) CHECK (e_salary BETWEEN 3000 AND 15000),
    e_job ENUM('财务总监','人力总监','技术总监','市场总监','行政主管','后勤主任','会计','HR','设计师','程序员','销售员','办公文员','电工','保安') NOT NULL,
    e_department ENUM('财务部','人力部','技术部','市场部','行政部','后勤部') NOT NULL,
    e_hiredate DATE NOT NULL
);
```

插入数据

```sql
-- 插入数据
INSERT INTO employees (e_id, e_name, e_gender, e_age, e_education, e_id_card, e_province, e_city, e_email, e_salary, e_job, e_department, e_hiredate) VALUES
('D001', '张伟', '男', 35, '本科', '130402198803124512', '河北', '邯郸', 'zhangwei@163.com', 12500.00, '技术总监', '技术部', '2018-06-15'),
('D002', '王芳', '女', 28, '研究生', '410105199504237894', '河南', '郑州', 'wangfang@qq.com', 9800.00, 'HR', '人力部', '2020-09-22'),
('D003', '李强', '男', 42, '大专', '370103198101018976', '山东', '济南', 'liqiang@126.com', 8500.00, '电工', '后勤部', '2015-11-30'),
('D004', '赵敏', '女', 31, '本科', '14010619920131456X', '山西', '太原', 'zhaomin@sohu.com', 7200.00, '会计', '财务部', '2019-03-18'),
('D005', '陈勇', '男', 38, '本科', '130403198511209871', '河北', '邢台', 'chenyong@163.com', 11000.00, '市场总监', '市场部', '2017-08-09'),
('D006', '杨丽', '女', 27, '研究生', '410185199604157893', '河南', '安阳', 'yangli@qq.com', 13500.00, '设计师', '技术部', '2021-02-14'),
('D007', '黄建国', '男', 45, '大专', '370202197802287895', '山东', '济南', 'huangjg@126.com', 6800.00, '保安', '后勤部', '2016-05-25'),
('D008', '周晓梅', '女', 29, '本科', '140107199304198762', '山西', '太原', 'zhouxm@sohu.com', 9200.00, '行政主管', '行政部', '2020-07-11'),
('D009', '吴斌', '男', 33, '本科', '130404198910231234', '河北', '邯郸', 'wubin@163.com', 10500.00, '程序员', '技术部', '2019-11-05'),
('D010', '徐丽华', '女', 36, '研究生', '410102198705129876', '河南', '郑州', 'xulihua@qq.com', 14200.00, '人力总监', '人力部', '2017-04-27'),
('D011', '孙志强', '男', 40, '大专', '370104198212045678', '山东', '济南', 'sunzq@126.com', 7500.00, '后勤主任', '后勤部', '2018-12-01'),
('D012', '朱婷婷', '女', 26, '本科', '140108199702098765', '山西', '太原', 'zhutt@sohu.com', 6500.00, '办公文员', '行政部', '2022-08-19'),
('D013', '马军', '男', 37, '本科', '130405198608174321', '河北', '邢台', 'majun@163.com', 11500.00, '销售员', '市场部', '2016-09-12'),
('D014', '何静', '女', 32, '研究生', '410103199011239874', '河南', '安阳', 'hejing@qq.com', 12800.00, '技术总监', '技术部', '2019-07-25'),
('D015', '高伟', '男', 44, '大专', '370105197912318976', '山东', '济南', 'gaowei@126.com', 7000.00, '电工', '后勤部', '2017-10-30'),
('D016', '林雪', '女', 30, '本科', '140109199304217896', '山西', '太原', 'linxue@sohu.com', 8800.00, 'HR', '人力部', '2020-04-15'),
('D017', '郑强', '男', 39, '本科', '130406198408129876', '河北', '邯郸', 'zhengq@163.com', 13200.00, '财务总监', '财务部', '2018-03-22'),
('D018', '王秀兰', '女', 34, '研究生', '410104198907058765', '河南', '郑州', 'wangxl@qq.com', 9500.00, '设计师', '技术部', '2021-01-07'),
('D019', '冯刚', '男', 41, '大专', '370106198102237894', '山东', '济南', 'fenggang@126.com', 7200.00, '保安', '后勤部', '2019-06-18'),
('D020', '曾敏', '女', 28, '本科', '140110199502128763', '山西', '太原', 'zengmin@sohu.com', 10500.00, '程序员', '技术部', '2022-02-28'),
('D021', '程建国', '男', 46, '大专', '130407197708049875', '河北', '邢台', 'chengjg@163.com', 6800.00, '后勤主任', '后勤部', '2015-12-14'),
('D022', '蔡晓丽', '女', 31, '研究生', '410105199211157896', '河南', '安阳', 'caixl@qq.com', 14500.00, '市场总监', '市场部', '2020-11-09'),
('D023', '彭伟', '男', 35, '本科', '370107198803214567', '山东', '济南', 'pengwei@126.com', 9200.00, '行政主管', '行政部', '2018-07-03'),
('D024', '苏婷婷', '女', 29, '本科', '140111199402038762', '山西', '太原', 'sutt@sohu.com', 7500.00, '会计', '财务部', '2021-09-17'),
('D025', '蒋军', '男', 38, '本科', '130408198509127894', '河北', '邯郸', 'jiangjun@163.com', 11800.00, '销售员', '市场部', '2017-04-05'),
('D026', '叶静', '女', 33, '研究生', '410106198812319875', '河南', '郑州', 'yejing@qq.com', 13800.00, '人力总监', '人力部', '2019-08-21'),
('D027', '崔志强', '男', 43, '大专', '370108198001018976', '山东', '济南', 'cuizq@126.com', 7000.00, '电工', '后勤部', '2016-10-12'),
('D028', '邹雪梅', '女', 27, '本科', '140112199602098764', '山西', '太原', 'zouxm@sohu.com', 8500.00, '办公文员', '行政部', '2022-03-25'),
('D029', '白勇', '男', 36, '本科', '130409198708237895', '河北', '邢台', 'baiyong@163.com', 12500.00, '技术总监', '技术部', '2018-11-14'),
('D030', '石丽华', '女', 34, '研究生', '410107198911049876', '河南', '安阳', 'shilh@qq.com', 14200.00, '设计师', '技术部', '2020-06-07'),
('D031', '丁斌', '男', 39, '本科', '370109198208159874', '山东', '济南', 'dingbin@126.com', 9800.00, '程序员', '技术部', '2017-12-19'),
('D032', '杜晓梅', '女', 30, '本科', '140113199304128765', '山西', '太原', 'duxiaomei@sohu.com', 11500.00, '财务总监', '财务部', '2021-04-30'),
('D033', '夏刚', '男', 44, '大专', '130410197912318976', '河北', '邯郸', 'xiagang@163.com', 7200.00, '保安', '后勤部', '2019-02-11'),
('D034', '钟秀兰', '女', 32, '研究生', '410108199105239875', '河南', '郑州', 'zhongxl@qq.com', 13500.00, '市场总监', '市场部', '2018-05-26'),
('D035', '汪伟', '男', 37, '本科', '370110198510127894', '山东', '济南', 'wangwei@126.com', 10500.00, '行政主管', '行政部', '2020-10-09'),
('D036', '田敏', '女', 28, '本科', '140114199602178763', '山西', '太原', 'tianmin@sohu.com', 8800.00, 'HR', '人力部', '2022-01-23'),
('D037', '任建国', '男', 45, '大专', '130411198002287895', '河北', '邢台', 'rengjg@163.com', 6800.00, '后勤主任', '后勤部', '2016-07-15'),
('D038', '孟静', '女', 31, '研究生', '410109199011158976', '河南', '安阳', 'mengjing@qq.com', 14500.00, '技术总监', '技术部', '2021-08-04'),
('D039', '康军', '男', 40, '本科', '370111198312049875', '山东', '济南', 'kangjun@126.com', 13200.00, '销售员', '市场部', '2019-10-17'),
('D040', '侯婷婷', '女', 29, '本科', '140115199403028764', '山西', '太原', 'houtt@sohu.com', 9500.00, '会计', '财务部', '2022-05-12'),
('D041', '龙强', '男', 38, '本科', '130412198509217896', '河北', '邯郸', 'longqiang@163.com', 11800.00, '程序员', '技术部', '2017-09-28'),
('D042', '龚雪', '女', 33, '研究生', '410110198810319874', '河南', '郑州', 'gongxue@qq.com', 12800.00, '人力总监', '人力部', '2020-12-05'),
('D043', '文志强', '男', 42, '大专', '370112198101108976', '山东', '济南', 'wenzq@126.com', 7500.00, '电工', '后勤部', '2018-04-19'),
('D044', '包晓丽', '女', 30, '本科', '140116199402238765', '山西', '太原', 'baoxiaoli@sohu.com', 10500.00, '办公文员', '行政部', '2021-07-14'),
('D045', '左勇', '男', 39, '本科', '130413198408129875', '河北', '邢台', 'zuoyong@163.com', 13800.00, '设计师', '技术部', '2019-01-29'),
('D046', '江丽华', '女', 35, '研究生', '410111198705049876', '河南', '安阳', 'jianglh@qq.com', 14200.00, '市场总监', '市场部', '2017-06-22'),
('D047', '段斌', '男', 43, '大专', '370113198002237895', '山东', '济南', 'duanbin@126.com', 7000.00, '保安', '后勤部', '2016-08-11'),
('D048', '刘秀梅', '女', 34, '本科', '140117199301158764', '山西', '太原', 'liuxiumei@sohu.com', 9200.00, '行政主管', '行政部', '2020-03-07'),
('D049', '陆伟', '男', 41, '本科', '130414198210319874', '河北', '邯郸', 'luwei@163.com', 12500.00, '技术总监', '技术部', '2018-10-16'),
('D050', '黎静', '女', 36, '研究生', '410112198806128975', '河南', '郑州', 'lijing@qq.com', 13500.00, '财务总监', '财务部', '2021-11-27');
```

**数据特征说明**：

1. 员工编号D001-D050连续生成
2. 性别与姓名匹配度合理
3. 年龄范围严格控制在25-60岁
4. 身份证号符合基本格式规则
5. 省份与城市对应关系：
   - 河北→邯郸/邢台
   - 河南→郑州/安阳
   - 山东→济南
   - 山西→太原
   - 北京→北京
   - 天津→天津
6. 邮箱后缀均匀分布
7. 薪资与职位层级匹配
8. 职位与部门对应关系：
   - 财务部：财务总监/会计
   - 人力部：人力总监/HR
   - 技术部：技术总监/设计师/程序员
   - 市场部：市场总监/销售员
   - 行政部：行政主管/办公文员
   - 后勤部：后勤主任/电工/保安
9. 入职日期分布在2015-2022年间

```sql
 CREATE TABLE employees (
    id INT PRIMARY KEY AUTO_INCREMENT,
    empno VARCHAR(4) UNIQUE NOT NULL CHECK (empno REGEXP '^D[0-9]{3}$'),
    ename VARCHAR(20) NOT NULL,
    gender ENUM('男','女') NOT NULL,
    age TINYINT NOT NULL CHECK (age BETWEEN 22 AND 60),
    education ENUM('大专','本科','研究生') NOT NULL,
    d_card CHAR(18) UNIQUE NOT NULL CHECK (
        LENGTH(d_card)=18 AND 
        d_card REGEXP '^[0-9X]{17}[0-9X]$' AND
        (gender = '男' AND SUBSTR(d_card,17,1) % 2 = 1) OR
        (gender = '女' AND SUBSTR(d_card,17,1) % 2 = 0)
    ),
    province VARCHAR(10) NOT NULL CHECK (province IN ('北京','山东','辽宁','河北','山西')),
    city VARCHAR(20) NOT NULL,
    email VARCHAR(50) NOT NULL CHECK (
        email REGEXP '^[a-zA-Z0-9._%+-]+@(163|qq|126|sohu|gmail)\.com$' AND
        SUBSTRING_INDEX(email,'@',-1) IN ('163.com','qq.com','126.com','sohu.com','gmail.com')
    ),
    salary DECIMAL(8,2) NOT NULL CHECK (salary BETWEEN 3000 AND 15000),
    job VARCHAR(20) NOT NULL,
    department VARCHAR(10) NOT NULL CHECK (department IN ('财务部','人力部','设计部','开发部','市场部','行政部','后勤部')),
    hiredate DATE NOT NULL CHECK (hiredate > DATE_SUB(CURDATE(), INTERVAL 60 YEAR)),
    
    -- 附加约束
    CHECK (TIMESTAMPDIFF(YEAR, STR_TO_DATE(CONCAT(SUBSTR(d_card,7,8), '%Y%m%d'), CURDATE()) = age),
    CHECK (department = 
        CASE 
            WHEN job IN ('会计','出纳','财务分析') THEN '财务部'
            WHEN job IN ('HRBP','招聘专员','培训经理') THEN '人力部' 
            WHEN job LIKE '%设计%' THEN '设计部'
            WHEN job LIKE '%开发%' THEN '开发部'
            WHEN job LIKE '%市场%' THEN '市场部'
            WHEN job IN ('行政助理','前台接待') THEN '行政部'
            ELSE '后勤部'
        END
    )
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 学生成绩表（students）

生成30条练习mysql表查询的学生信息数据(students)，要求：

- 学号（id ）整型 自动增长 主键
- 姓名（s_name）变长字符串 非空
- 出生日期（s_birthdate）日期格式 非空
- 性别（s_gender）只能输入男或女 非空
- 家乡（s_hometown）邯山区、丛台区、复兴区、经开区、肥乡区、永年区  非空
- 语文（s_chinese）精确到小数点后2位 默认0分 大于等于0 
- 数学（s_math）精确到小数点后2位 默认0分 大于等于0
- 外语（s_english）精确到小数点后2位 默认0分 大于等于0
- 计算机（s_computer） 精确到小数点后2位 默认0分 大于等于0
- 特长生（s_specialty）是或否

创建表

```sql
CREATE TABLE students (
    id INT AUTO_INCREMENT PRIMARY KEY,
    s_name VARCHAR(20) NOT NULL,
    s_birthdate DATE NOT NULL,
    s_gender ENUM('男','女') NOT NULL,
    s_hometown ENUM('邯山区','丛台区','复兴区','经开区','肥乡区','永年区') NOT NULL,
    s_chinese DECIMAL(5,2) DEFAULT 0.00 CHECK (s_chinese >= 0),
    s_math DECIMAL(5,2) DEFAULT 0.00 CHECK (s_math >= 0),
    s_english DECIMAL(5,2) DEFAULT 0.00 CHECK (s_english >= 0),
    s_computer DECIMAL(5,2) DEFAULT 0.00 CHECK (s_computer >= 0),
    s_specialty ENUM('是','否') NOT NULL
);
```


插入数据
```sql
INSERT INTO students (s_name, s_birthdate, s_gender, s_hometown, s_chinese, s_math, s_english, s_computer, s_specialty) VALUES
('王浩', '2005-03-12', '男', '丛台区', 88.50, 92.00, 85.75, 78.25, '否'),
('李思雨', '2006-07-25', '女', '邯山区', 76.00, 68.50, 94.25, 82.00, '是'),
('张宇航', '2005-11-08', '男', '复兴区', 92.75, 85.00, 79.50, 91.25, '否'),
('陈晓萌', '2006-02-14', '女', '经开区', 81.25, 77.50, 88.00, 84.75, '是'),
('赵子轩', '2005-09-30', '男', '肥乡区', 65.50, 93.75, 72.00, 89.50, '否'),
('刘雨欣', '2006-05-19', '女', '永年区', 95.00, 84.25, 90.50, 76.75, '否'),
('黄俊杰', '2005-12-05', '男', '丛台区', 78.75, 69.50, 81.25, 94.00, '是'),
('周诗涵', '2006-04-22', '女', '邯山区', 87.25, 91.00, 86.75, 80.50, '否'),
('吴天宇', '2005-08-17', '男', '复兴区', 72.50, 88.75, 73.25, 85.00, '否'),
('郑雨桐', '2006-01-09', '女', '经开区', 93.00, 75.50, 97.25, 79.75, '是'),
('孙浩然', '2005-06-28', '男', '肥乡区', 84.75, 82.25, 68.50, 90.00, '否'),
('朱雅婷', '2006-10-15', '女', '永年区', 79.50, 96.75, 89.00, 83.25, '是'),
('徐子墨', '2005-04-03', '男', '丛台区', 91.25, 70.50, 84.75, 77.00, '否'),
('马欣怡', '2006-08-21', '女', '邯山区', 67.75, 89.25, 95.50, 86.75, '否'),
('高博文', '2005-02-18', '男', '复兴区', 88.00, 94.50, 78.25, 92.75, '是'),
('林若曦', '2006-11-27', '女', '经开区', 75.25, 83.75, 91.00, 81.50, '否'),
('何俊豪', '2005-07-14', '男', '肥乡区', 96.50, 76.25, 82.75, 88.00, '否'),
('罗诗雨', '2006-03-05', '女', '永年区', 82.75, 90.00, 74.50, 93.25, '是'),
('梁家辉', '2005-10-31', '男', '丛台区', 89.25, 85.75, 87.00, 75.50, '否'),
('蔡雪晴', '2006-09-12', '女', '邯山区', 73.50, 78.25, 96.75, 84.00, '否'),
('宋哲瀚', '2005-01-25', '男', '复兴区', 94.00, 86.50, 80.25, 89.75, '是'),
('唐语嫣', '2006-06-08', '女', '经开区', 80.75, 92.25, 83.50, 72.00, '否'),
('许嘉豪', '2005-12-19', '男', '肥乡区', 85.25, 79.75, 90.00, 87.50, '否'),
('邓雨菲', '2006-04-03', '女', '永年区', 77.00, 95.50, 85.75, 91.25, '是'),
('钟子涵', '2005-03-27', '男', '丛台区', 90.50, 81.25, 76.00, 94.75, '否'),
('袁欣悦', '2006-07-14', '女', '邯山区', 83.75, 87.00, 93.25, 79.50, '否'),
('崔天佑', '2005-11-22', '男', '复兴区', 71.25, 98.50, 84.75, 86.00, '是'),
('薛佳琪', '2006-02-09', '女', '经开区', 97.00, 73.75, 88.50, 82.25, '否'),
('彭一鸣', '2005-05-16', '男', '肥乡区', 86.50, 89.25, 75.00, 95.75, '否'),
('丁雨萱', '2006-08-28', '女', '永年区', 78.25, 84.75, 97.50, 80.00, '是');
```

### 产品表(products)
要求：表名（products）

- 产品id（p_id)： 整型、自动增长、主键
- 产品名称(p_name):  最多100个字符 非空
- 价格(price)：精确到小数点后2位 非空
- 库存(stock)：整型 默认0
- 产品类别(category)：'电子产品', '服装', '食品', '家居', '图书'   非空
- 产品状态(is_active)：'上架', '下架'  默认 '上架'
- 创建日期(created_at)：提取系统日期时间

```sql
CREATE TABLE products (
    p_id INT AUTO_INCREMENT PRIMARY KEY COMMENT '产品ID',
    p_name VARCHAR(100) NOT NULL COMMENT '产品名称',
    price DECIMAL(10, 2) NOT NULL COMMENT '价格（精确到小数点后两位）',
    stock INT DEFAULT 0 COMMENT '库存数量',
    category ENUM('电子产品', '服装', '食品', '家居', '图书') NOT NULL COMMENT '分类',
    is_active ENUM('上架', '下架') DEFAULT '上架' COMMENT '是否上架',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间'
) COMMENT '产品信息表';
```

数据

```sql
INSERT INTO products (p_name, price, stock, category, is_active, created_at) VALUES
('iPhone 15 Pro', 8999.00, 80, '电子产品', '上架', '2023-01-15 10:00:00'),
('华为Mate 60 Pro', 6999.00, 60, '电子产品', '上架', '2023-02-20 14:30:00'),
('小米电视75英寸', 4999.00, 25, '电子产品', '上架', '2023-03-10 09:15:00'),
('索尼蓝牙耳机', 599.00, 150, '电子产品', '下架', '2023-04-05 16:45:00'),
('iPad Air 5', 4499.00, 40, '电子产品', '上架', '2023-05-12 11:20:00'),
('大疆无人机Mini 3', 4199.00, 15, '电子产品', '上架', '2023-06-18 13:00:00'),
('男士纯棉卫衣', 199.00, 200, '服装', '上架', '2023-01-25 08:00:00'),
('女士羊毛大衣', 899.00, 80, '服装', '上架', '2023-02-14 10:30:00'),
('运动短裤', 69.90, 300, '服装', '下架', '2023-03-22 15:20:00'),
('儿童羽绒服', 359.00, 120, '服装', '上架', '2023-04-30 17:45:00'),
('男士商务衬衫', 159.00, 180, '服装', '上架', '2023-05-08 12:10:00'),
('瑜伽裤', 129.00, 250, '服装', '上架', '2023-06-05 14:00:00'),
('德芙巧克力礼盒', 89.00, 150, '食品', '上架', '2023-01-10 09:00:00'),
('三只松鼠坚果大礼包', 129.00, 200, '食品', '上架', '2023-02-28 11:25:00'),
('蒙牛纯牛奶12盒', 58.00, 300, '食品', '下架', '2023-03-15 16:30:00'),
('费列罗榛果巧克力', 69.90, 180, '食品', '上架', '2023-04-20 13:50:00'),
('乐事薯片大包装', 15.90, 500, '食品', '上架', '2023-05-25 10:15:00'),
('青岛啤酒6听装', 39.90, 400, '食品', '上架', '2023-06-30 18:00:00'),
('智能空气净化器', 1299.00, 30, '家居', '上架', '2023-01-05 08:30:00'),
('北欧简约茶几', 599.00, 50, '家居', '上架', '2023-02-12 14:00:00'),
('乳胶床垫', 1999.00, 20, '家居', '下架', '2023-03-18 09:45:00'),
('加湿器静音款', 199.00, 100, '家居', '上架', '2023-04-22 16:20:00'),
('电动牙刷套装', 299.00, 80, '家居', '上架', '2023-05-30 11:10:00'),
('智能台灯', 159.00, 0, '家居', '下架', '2023-06-25 13:40:00'),
('Python编程从入门到实践', 89.80, 120, '图书', '上架', '2023-01-08 07:50:00'),
('百年孤独（精装版）', 59.00, 90, '图书', '上架', '2023-02-16 10:20:00'),
('三体全集', 128.00, 60, '图书', '下架', '2023-03-24 15:30:00'),
('经济学原理', 99.00, 70, '图书', '上架', '2023-04-10 12:45:00'),
('哈利波特全套', 299.00, 40, '图书', '上架', '2023-05-20 09:00:00'),
('人类简史', 69.00, 110, '图书', '上架', '2023-06-28 17:15:00');
```
---



## 多表数据

以下是10道进阶的MySQL建表练习题，涵盖多表关联、约束、索引等进阶特性，适合已经掌握基础表创建的学习者：

---

### 学生选课系统
**场景说明:**  创建`学生选课系统数据库表(Student_Course_Selection_System)`记录学生选课关系

- 学生表(students) 包含:
  - `学号(student_id)`主键
  - `姓名(name)`  
- 课程表(courses) 包含
  - `课程号(course_id)`主键
  - `课程名(title)`  
- 创建`选课表(enrollments)` 包含:

---
-- 使用utf8mb4字符集支持中文和特殊符号
-- 使用InnoDB引擎支持事务和外键
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- 学生表(核心数据)
-- ----------------------------
CREATE TABLE `students` (
  `student_id` INT(11) NOT NULL AUTO_INCREMENT COMMENT '学号',
  `name` VARCHAR(50) NOT NULL COMMENT '姓名',
  `gender` ENUM('男','女') NOT NULL DEFAULT '男' COMMENT '性别',
  `enrollment_date` DATE NOT NULL COMMENT '入学日期',
  PRIMARY KEY (`student_id`),
  INDEX `idx_name` (`name`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- ----------------------------
-- 课程表(核心数据)
-- ----------------------------
CREATE TABLE `courses` (
  `course_id` INT(11) NOT NULL AUTO_INCREMENT COMMENT '课程号',
  `title` VARCHAR(100) NOT NULL COMMENT '课程名称',
  `credit` TINYINT(2) UNSIGNED NOT NULL DEFAULT 2 COMMENT '学分',
  `teacher` VARCHAR(50) NOT NULL COMMENT '授课教师',
  PRIMARY KEY (`course_id`),
  INDEX `idx_title` (`title`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- ----------------------------
-- 选课记录表(关系表)
-- ----------------------------
CREATE TABLE `enrollments` (
  `enrollment_id` INT(11) NOT NULL AUTO_INCREMENT COMMENT '选课记录ID',
  `student_id` INT(11) NOT NULL COMMENT '学号',
  `course_id` INT(11) NOT NULL COMMENT '课程号',
  `select_time` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '选课时间',
  `score` DECIMAL(5,2) UNSIGNED DEFAULT NULL COMMENT '考试成绩',
  PRIMARY KEY (`enrollment_id`),
  UNIQUE KEY `uniq_student_course` (`student_id`,`course_id`),
  CONSTRAINT `fk_student` 
    FOREIGN KEY (`student_id`) 
    REFERENCES `students` (`student_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_course` 
    FOREIGN KEY (`course_id`) 
    REFERENCES `courses` (`course_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

SET FOREIGN_KEY_CHECKS = 1;

---

### **2. 自增主键与默认值**
**场景**  
创建`图书表(books)`，要求：  
- 主键`book_id`自动递增  
- 包含`书名(title)非空`  
- 添加`出版日期(publish_date)`默认值为当前日期  
- `库存数量(stock)`默认值为0且不能为负数

```sql
-- 请写出建表语句
```

---

### **3. 复合主键与检查约束**
**场景**  
创建`订单明细表(order_items)`，要求：  
- 每个订单(`order_id`)可包含多个商品(`product_id`)  
- 用`order_id + product_id`作为复合主键  
- `数量(quantity)`必须大于0  
- `单价(unit_price)`必须大于0

```sql
-- 请写出建表语句(注意MySQL8.0+才支持CHECK约束)
```

---

### **4. 级联操作与外键**
**场景**  
创建`部门表(departments)`和`员工表(employees)`，要求：  
- 部门表包含`部门ID(dept_id)主键`、`部门名称(name)`  
- 员工表包含`员工ID(emp_id)主键`、`姓名(name)`、`部门ID(dept_id)外键`  
- 当部门被删除时，对应员工的`dept_id`设为NULL  
- 当部门ID更新时，员工表同步更新

```sql
-- 请写出完整的建表语句
```

---

### **5. 枚举类型与唯一约束**
**场景**  
创建`用户表(users)`，要求：  
- `用户ID(uid)主键`  
- `性别(gender)`只能是'M'或'F'  
- `手机号(phone)`必须唯一且符合格式(11位数字)  
- `邮箱(email)`和`用户名(username)`组合必须唯一

```sql
-- 请写出建表语句
```

---

### **6. 多对多关系设计**
**场景**  
设计医院数据库：  
- `医生表(doctors)`包含`医生ID(did)主键`、`姓名(name)`  
- `患者表(patients)`包含`患者ID(pid)主键`、`姓名(name)`  
- `就诊记录表(visits)`记录医生与患者的多对多关系，包含`就诊时间(visit_time)`  
- 要求每个医生每天对同一患者只能有一条记录

```sql
-- 请写出三张表的建表语句
```

---

### **7. 全文索引与存储引擎**
**场景**  
创建`文章表(articles)`，要求：  
- 使用MyISAM存储引擎  
- 包含`文章ID(id)`、`标题(title)`、`内容(content)`  
- 对`title`和`content`创建全文索引  
- 添加`发布时间(pub_date)`默认为当前时间

```sql
-- 请写出建表语句
```

---

### **8. 联合唯一索引与自关联**
**场景**  
创建`员工表(employees)`，要求：  
- `员工ID(emp_id)主键`  
- `姓名(name)`  
- `经理ID(manager_id)`指向本表emp_id  
- 同一部门(`dept`)内员工姓名不能重复  
- 添加入职时间(`hire_date`)字段

```sql
-- 请写出建表语句
```

---

### **9. 时间戳自动更新**
**场景**  
创建`日志表(logs)`，要求：  
- `日志ID(log_id)自增主键`  
- `操作内容(action)`  
- `创建时间(created_at)`默认当前时间且不可修改  
- `更新时间(updated_at)`每次数据变更自动更新为当前时间

```sql
-- 请写出建表语句
```

---

### **10. 分区表设计**
**场景**  
创建按年份分区的`销售记录表(sales)`，要求：  
- 包含`sale_id主键`、`product_id`、`sale_date`、`amount`  
- 根据`sale_date`的年份进行范围分区  
- 存储引擎使用InnoDB  
- 包含2010-2020年的分区

```sql
-- 请写出支持分区的建表语句
```

---

**练习提示**：
1. 注意外键关联顺序（先创建父表）
2. 合理选择数据类型（如`TIMESTAMP` vs `DATETIME`）
3. 注意不同MySQL版本对特性的支持（如`CHECK`约束）
4. 所有表名/字段名建议使用英文

需要答案参考可回复告知 📚 这些练习将帮助你掌握：多表设计、复杂约束、索引优化等核心技能！


### 多表基础关联


### **1. 电商系统**
#### **表结构示例**
- **用户表 (users)**：用户ID、用户名、注册时间、最后登录时间、地区、会员等级
- **商品表 (products)**：商品ID、商品名称、分类、价格、库存、上架时间
- **订单表 (orders)**：订单ID、用户ID、订单时间、订单状态、总金额
- **订单明细表 (order_items)**：订单项ID、订单ID、商品ID、数量、单价

#### **练习目标**
- 多表连接（用户-订单-商品）
- 聚合统计（销售额、用户购买频次）
- 窗口函数（用户购买排名）
- 时间序列分析（月度销售趋势）
- 子查询（查找未下单用户）

**示例查询**：
```sql
-- 查询每个用户最近3个月的消费总额
SELECT 
    u.user_id,
    SUM(o.total_amount) AS total_spent
FROM users u
JOIN orders o ON u.user_id = o.user_id
WHERE o.order_time >= CURDATE() - INTERVAL 3 MONTH
GROUP BY u.user_id;
```

---

### **2. 社交媒体平台**
#### **表结构示例**
- **用户表 (social_users)**：用户ID、昵称、注册时间、粉丝数、关注数
- **动态表 (posts)**：动态ID、用户ID、内容、发布时间、点赞数、评论数
- **关注关系表 (follows)**：关注者ID、被关注者ID、关注时间
- **评论表 (comments)**：评论ID、动态ID、用户ID、评论内容、时间

#### **练习目标**
- 递归查询（查找用户的粉丝网络）
- 多级子查询（热门动态分析）
- 自连接（互相关注的用户）
- 时间间隔分析（用户活跃时间段）

**示例查询**：
```sql
-- 查找互相关注的用户对
SELECT 
    f1.follower_id AS user1,
    f1.followee_id AS user2
FROM follows f1
JOIN follows f2 ON f1.follower_id = f2.followee_id 
                AND f1.followee_id = f2.follower_id;
```

---

### **3. 物流管理系统**
#### **表结构示例**
- **仓库表 (warehouses)**：仓库ID、位置、容量
- **运输记录表 (shipments)**：运单ID、出发仓库ID、目的仓库ID、发货时间、到达时间
- **库存表 (inventory)**：商品ID、仓库ID、库存量、最后更新时间
- **物流轨迹表 (tracking)**：运单ID、位置、时间、状态

#### **练习目标**
- 地理空间查询（附近仓库搜索）
- 复杂条件过滤（延迟送达订单）
- 时间差计算（运输时效分析）
- 递归查询（多级仓库调拨路径）

**示例查询**：
```sql
-- 统计每个仓库的平均运输时效（小时）
SELECT 
    w.warehouse_id,
    AVG(TIMESTAMPDIFF(HOUR, s.departure_time, s.arrival_time)) AS avg_hours
FROM shipments s
JOIN warehouses w ON s.from_warehouse_id = w.warehouse_id
GROUP BY w.warehouse_id;
```

---

### **4. 医院管理系统**
#### **表结构示例**
- **患者表 (patients)**：患者ID、姓名、性别、出生日期、联系方式
- **医生表 (doctors)**：医生ID、姓名、科室、职称
- **就诊记录表 (visits)**：就诊ID、患者ID、医生ID、就诊时间、诊断结果
- **药品表 (medicines)**：药品ID、名称、单价、库存

#### **练习目标**
- 多条件过滤（按科室统计就诊量）
- 数据去重（患者重复就诊分析）
- 复杂聚合（医生接诊效率排名）
- 日期函数（高峰就诊时段分析）

**示例查询**：
```sql
-- 查询每个科室接诊量前三的医生
SELECT 
    d.department,
    d.doctor_name,
    COUNT(v.visit_id) AS visit_count
FROM doctors d
JOIN visits v ON d.doctor_id = v.doctor_id
GROUP BY d.department, d.doctor_id
ORDER BY d.department, visit_count DESC;
```

---

### **5. 物联网传感器数据**
#### **表结构示例**
- **设备表 (devices)**：设备ID、类型、安装位置、激活时间
- **传感器数据表 (sensor_readings)**：记录ID、设备ID、温度、湿度、时间戳
- **报警记录表 (alerts)**：报警ID、设备ID、报警类型、触发时间

#### **练习目标**
- 时间序列聚合（每小时平均温度）
- 模式匹配（异常数据检测）
- 数据清洗（处理传感器噪声）
- 实时分析（最近1小时报警次数）

**示例查询**：
```sql
-- 检测温度连续3次超过阈值的设备
SELECT 
    device_id,
    GROUP_CONCAT(time ORDER BY time) AS alert_times
FROM (
    SELECT 
        device_id,
        time,
        temperature,
        LAG(temperature, 1) OVER (PARTITION BY device_id ORDER BY time) AS prev_temp1,
        LAG(temperature, 2) OVER (PARTITION BY device_id ORDER BY time) AS prev_temp2
    FROM sensor_readings
) t
WHERE temperature > 35 
  AND prev_temp1 > 35 
  AND prev_temp2 > 35;
```

---

### **6. 金融交易系统**
#### **表结构示例**
- **账户表 (accounts)**：账户ID、用户ID、余额、开户时间
- **交易表 (transactions)**：交易ID、转出账户、转入账户、金额、时间、状态
- **贷款表 (loans)**：贷款ID、账户ID、贷款金额、利率、期限

#### **练习目标**
- 事务处理（转账原子性）
- 复杂计算（复利利息）
- 风险控制（大额交易监控）
- 递归CTE（资金流动路径追踪）

**示例查询**：
```sql
-- 查找单日转账超过10万的账户
SELECT 
    account_id,
    SUM(amount) AS daily_total
FROM transactions
WHERE DATE(time) = '2023-10-25'
GROUP BY account_id
HAVING daily_total > 100000;
```

---

### **7. 图书馆管理系统**
#### **表结构示例**
- **图书表 (books)**：ISBN、书名、作者、出版社、出版年份、库存
- **借阅记录表 (borrows)**：借阅ID、用户ID、ISBN、借出时间、应还时间、归还时间
- **罚款表 (fines)**：罚款ID、借阅ID、金额、状态

#### **练习目标**
- 日期处理（逾期未还计算）
- 多表关联（查询未归还书籍的用户）
- 数据完整性（库存与借阅状态同步）
- 聚合统计（最热门图书排行）

**示例查询**：
```sql
-- 计算每本书的平均借阅周期（天）
SELECT 
    b.title,
    AVG(DATEDIFF(return_time, borrow_time)) AS avg_days
FROM borrows br
JOIN books b ON br.ISBN = b.ISBN
WHERE br.return_time IS NOT NULL
GROUP BY b.ISBN;
```

---

### **8. 游戏玩家行为分析**
#### **表结构示例**
- **玩家表 (players)**：玩家ID、注册时间、等级、最后登录时间
- **任务表 (quests)**：任务ID、任务名称、难度、奖励
- **任务完成记录 (quest_completions)**：记录ID、玩家ID、任务ID、完成时间
- **充值表 (payments)**：订单ID、玩家ID、金额、充值时间

#### **练习目标**
- 留存率计算（DAU/MAU）
- 路径分析（玩家任务完成顺序）
- 付费转化率（免费玩家转付费）
- 用户分群（高活跃 vs 低活跃）

**示例查询**：
```sql
-- 计算每周活跃用户（WAU）
SELECT 
    YEARWEEK(login_time) AS week_num,
    COUNT(DISTINCT player_id) AS wau
FROM player_logins
GROUP BY week_num;
```

---

### **练习建议**
1. **从简单到复杂**：先掌握单表查询，再逐步练习多表连接和子查询。
2. **结合业务场景**：为每个表设计真实的业务问题（如电商促销分析、医院就诊高峰预测）。
3. **挑战极限案例**：尝试处理大数据量（百万级）下的性能优化。
4. **混合使用功能**：将聚合函数、窗口函数、CTE 结合使用。

通过多样化场景的练习，您将全面掌握 SQL 的数据操作能力，适应实际工作中的复杂需求。

## 农产品价格表

- id
- 品种：稻谷、大豆、玉米、黄瓜、茄子、卷心菜、四季豆、青椒、豇豆、芹菜、西红柿、韭菜、香菜、胡萝卜、牛肉、羊肉、猪肉、白条鸡、鸡蛋
- 类别：粮食、蔬菜、肉蛋
- 农批市场： 大通、光明、新发地
- 超市：物美、沃尔玛、联华
- 价格



| 类别   | 农产品品种 | 大通农批市场 | 光明农批市场 | 物美超市 | 沃尔玛超市 | 联华超市 | 新发地农批市场 | 
| ------ | ---------- | ------------ | ------------ | -------- | ---------- | -------- | ------------ |
| 粮食类 | 稻谷       | 3.50         | 3.65         | 2.65     | 2.89       | 3.90     | 3.58         | 
| 粮食类 | 大豆       | 4.80         | 4.70         | 4.40     | 4.20       | 4.50     | 4.75         | 
| 粮食类 | 玉米       | 3.00         | 3.00         | 2.70     | 2.30       | 2.50     | 3.00         | 
| 蔬菜类 | 黄瓜       | 1.00         | 1.30         | 1.30     | 1.20       | 1.30     | 1.15         | 
| 蔬菜类 | 茄子       | 2.20         | 2.00         | 2.48     | 2.28       | 2.35     | 2.10         | 
| 蔬菜类 | 卷心菜     | 0.48         | 0.48         | 0.68     | 0.48       | 0.58     | 0.48         | 
| 蔬菜类 | 四季豆     | 1.40         | 1.30         | 1.80     | 1.70       | 1.90     | 1.35         | 
| 蔬菜类 | 青椒       | 1.00         | 1.00         | 1.50     | 1.50       | 1.50     | 1.00         | 
| 蔬菜类 | 豇豆       | 0.65         | 0.65         | 0.80     | 0.75       | 0.80     | 0.65         | 
| 蔬菜类 | 芹菜       | 2.70         | 2.80         | 2.80     | 2.80       | 3.00     | 2.75         | 
| 蔬菜类 | 西红柿     | 1.80         | 1.80         | 2.30     | 1.90       | 2.00     | 1.80         | 
| 蔬菜类 | 韭菜       | 2.20         | 2.30         | 2.20     | 2.50       | 2.50     | 2.25         | 
| 蔬菜类 | 香菜       | 2.20         | 2.30         | 2.50     | 2.60       | 2.60     | 2.25         | 
| 蔬菜类 | 胡萝卜     | 1.80         | 1.90         | 2.10     | 2.00       | 2.20     | 1.85         | 
| 肉蛋类 | 牛肉       | 28.00        | 27.50        | 27.00    | 26.80      | 26.80    | 27.75        | 
| 肉蛋类 | 羊肉       | 26.00        | 26.00        | 25.60    | 25.20      | 25.60    | 26.00        | 
| 肉蛋类 | 猪肉       | 14.00        | 14.20        | 12.80    | 12.60      | 12.80    | 14.10        | 
| 肉蛋类 | 白条鸡     | 7.00         | 7.00         | 6.80     | 6.20       | 6.60     | 7.00         | 
| 肉蛋类 | 鸡蛋       | 4.60         | 4.60         | 3.30     | 3.20       | 3.30     | 4.60         | 

1. 表名：market_prices
2. 列定义
   - id：自增的主键，用于唯一标识每条记录。
   - category：农产品类别，使用 `VARCHAR(50)` 存储，最大长度为 50 个字符，且不允许为空。
   - p_name：农产品名称，使用 `VARCHAR(50)` 存储，最大长度为 50 个字符，且不允许为空。
   - dt_price
   - gm_price 
   - xfd_pric
   - wumei_pric
   - 
   - 分别对应大通农批市场、光明农批市场等不同市场的价格，使用 `DECIMAL(5, 2)` 存储，保留两位小数，且不允许为空。
3. **存储引擎和字符集**：使用 `InnoDB` 作为存储引擎，支持事务处理和外键约束；字符集设置为 `utf8mb4`，支持存储更多的字符。







以下是基于您的需求重新设计的 **60道单表查询练习题**，按6大分类（每类10题）系统化编排，覆盖更全面的查询场景，同时保持难度适中：

---

### **一、基础筛选类**  
1. 

---

### **二、聚合函数与分组**  
11.   

---

### **三、多条件与逻辑判断**  
21.  

---

### **四、复杂运算与排序**  
31. 

---

### **五、字段操作与别名**  
41. 

---

### **六、综合应用**  
51. 

---

### **设计特点**  
1. **渐进难度**：从简单筛选到复杂业务场景模拟  
2. **真实业务映射**：包含采购策略、预算计算、市场分析等实用场景  
3. **功能全覆盖**：  
   - 基础操作：`WHERE`、`ORDER BY`、`LIMIT`  
   - 高级功能：`CASE WHEN`、`WINDOW FUNCTION`、动态计算  
   - 业务思维：价格策略、成本优化、数据分析  
4. **多维度训练**：字段操作、数学计算、逻辑推理、业务抽象  

建议练习时从基础分类逐步过渡到综合应用，重点理解`GROUP BY`+`HAVING`、子查询、窗口函数等核心技术的实际应用场景。

以下是为您提供的 **完整SQL答案集**，按题目分类逐条解答。为便于理解，部分复杂查询添加了注释说明：

---

### **基础筛选类**
```sql
-- 1. 查询所有蔬菜类农产品的品种和价格
SELECT 类别, 农产品品种, 大通农批市场, 光明农批市场, 物美超市, 沃尔玛超市, 联华超市, 新发地农批市场 
FROM 价格表 
WHERE 类别 = '蔬菜类';

-- 2. 列出光明农批市场价格低于3元的所有农产品品种
SELECT 农产品品种 
FROM 价格表 
WHERE 光明农批市场 < 3.00;

-- 3. 列出新发地农批市场价格低于5元的所有农产品品种
SELECT 农产品品种 
FROM 价格表 
WHERE 新发地农批市场 < 5.00;

-- 4. 找到物美超市价格高于2元但低于3元的农产品品种
SELECT 农产品品种 
FROM 价格表 
WHERE 物美超市 BETWEEN 2.00 AND 3.00;

-- 5. 查询沃尔玛超市中价格最低的3个农产品品种
SELECT 农产品品种 
FROM 价格表 
ORDER BY 沃尔玛超市 ASC 
LIMIT 3;

-- 6. 显示所有市场的大豆价格（按市场名称升序排列）
SELECT '大通农批市场' AS 市场, 大豆 AS 价格 FROM 价格表 WHERE 农产品品种 = '大豆'
UNION ALL
SELECT '光明农批市场', 光明农批市场 FROM 价格表 WHERE 农产品品种 = '大豆'
-- ...重复其他市场...
ORDER BY 市场;

-- 7. 查询所有肉蛋类农产品的品种和价格
SELECT 类别, 农产品品种, 大通农批市场, 光明农批市场, 物美超市, 沃尔玛超市, 联华超市, 新发地农批市场 
FROM 价格表 
WHERE 类别 = '肉蛋类';

-- 8. 找到大通农批市场与光明农批市场价格相同的农产品
SELECT 农产品品种 
FROM 价格表 
WHERE 大通农批市场 = 光明农批市场;

-- 9. 显示沃尔玛超市中价格精确到小数点后两位的农产品
SELECT 农产品品种 
FROM 价格表 
WHERE 沃尔玛超市 = ROUND(沃尔玛超市, 2);

-- 10. 查询联华超市价格排名前5的农产品
SELECT 农产品品种 
FROM 价格表 
ORDER BY 联华超市 DESC 
LIMIT 5;
```

---

### **聚合函数与分组**
```sql
-- 6. 统计每个类别下有多少个农产品品种
SELECT 类别, COUNT(*) AS 品种数量 
FROM 价格表 
GROUP BY 类别;

-- 7. 计算猪肉在所有市场的平均价格
SELECT ROUND(AVG(猪肉), 2) AS 平均价 
FROM (
  SELECT 大通农批市场 AS 猪肉 FROM 价格表 WHERE 农产品品种 = '猪肉'
  UNION ALL
  SELECT 光明农批市场 FROM 价格表 WHERE 农产品品种 = '猪肉'
  -- ...其他市场...
) t;

-- 8. 找出新发地农批市场中价格最高的农产品
SELECT 农产品品种, 新发地农批市场 
FROM 价格表 
ORDER BY 新发地农批市场 DESC 
LIMIT 1;

-- 9. 按类别分组显示最高价和最低价
SELECT 类别, 
       MAX(GREATEST(大通农批市场,光明农批市场,物美超市,沃尔玛超市,联华超市,新发地农批市场)) AS 最高价,
       MIN(LEAST(大通农批市场,光明农批市场,物美超市,沃尔玛超市,联华超市,新发地农批市场)) AS 最低价 
FROM 价格表 
GROUP BY 类别;

-- 10. 查询玉米在所有市场的价格总和
SELECT SUM(玉米) AS 总价格 
FROM (
  SELECT 大通农批市场 AS 玉米 FROM 价格表 WHERE 农产品品种 = '玉米'
  UNION ALL
  SELECT 光明农批市场 FROM 价格表 WHERE 农产品品种 = '玉米'
  -- ...其他市场...
) t;
```

---

### **多条件与逻辑判断**
```sql
-- 11. 找出大通农批市场比光明农批市场便宜的农产品
SELECT 农产品品种 
FROM 价格表 
WHERE 大通农批市场 < 光明农批市场;

-- 12. 列出联华超市价格高于物美超市的农产品
SELECT 农产品品种 
FROM 价格表 
WHERE 联华超市 > 物美超市;

-- 13. 查找所有市场单价均低于5元的农产品
SELECT 农产品品种 
FROM 价格表 
WHERE 大通农批市场 < 5 AND 光明农批市场 < 5 
  AND 物美超市 < 5 AND 沃尔玛超市 < 5 
  AND 联华超市 < 5 AND 新发地农批市场 < 5;

-- 14. 显示在沃尔玛和联华价格相同的农产品
SELECT 农产品品种 
FROM 价格表 
WHERE 沃尔玛超市 = 联华超市;

-- 15. 查询农批市场价格一致的品种
SELECT 农产品品种 
FROM 价格表 
WHERE 大通农批市场 = 光明农批市场 
  AND 光明农批市场 = 新发地农批市场;
```

---

### **复杂运算与排序** (示例)
```sql
-- 18. 显示价格波动超过1元的品种
SELECT 农产品品种,
       MAX(GREATEST(大通农批市场,光明农批市场,物美超市,沃尔玛超市,联华超市,新发地农批市场)) - 
       MIN(LEAST(大通农批市场,光明农批市场,物美超市,沃尔玛超市,联华超市,新发地农批市场)) AS 波动值
FROM 价格表 
GROUP BY 农产品品种
HAVING 波动值 > 1;

-- 20. 查询牛肉价格比羊肉高的市场
SELECT 
  CASE 
    WHEN 牛肉.大通农批市场 > 羊肉.大通农批市场 THEN '大通农批市场'
    WHEN 牛肉.光明农批市场 > 羊肉.光明农批市场 THEN '光明农批市场'
    -- ...其他市场比较...
  END AS 市场
FROM (SELECT * FROM 价格表 WHERE 农产品品种 = '牛肉') 牛肉,
     (SELECT * FROM 价格表 WHERE 农产品品种 = '羊肉') 羊肉;
```

---

### **字段操作与别名** (示例)
```sql
-- 21. 价格单位转换为元/公斤
SELECT 类别, 农产品品种,
       大通农批市场*2 AS 大通农批市场_公斤价,
       光明农批市场*2 AS 光明农批市场_公斤价
FROM 价格表;

-- 22. 超市价格添加高价标记
SELECT 农产品品种,
       CASE WHEN 物美超市 > 5 THEN '高价' ELSE '' END AS 物美备注,
       CASE WHEN 沃尔玛超市 > 5 THEN '高价' ELSE '' END AS 沃尔玛备注,
       CASE WHEN 联华超市 > 5 THEN '高价' ELSE '' END AS 联华备注
FROM 价格表;
```

---

### **综合应用** (示例)
```sql
-- 30. 生成市场比价报告
WITH 最低价市场 AS (
  SELECT 农产品品种,
         CASE 
           WHEN COUNT(DISTINCT 市场) > 1 THEN '多个推荐'
           ELSE MIN(市场) 
         END AS 推荐市场
  FROM (
    SELECT 农产品品种, '大通农批市场' AS 市场, 大通农批市场 AS 价格 FROM 价格表
    UNION ALL
    SELECT 农产品品种, '光明农批市场', 光明农批市场 FROM 价格表
    -- ...其他市场...
  ) t
  GROUP BY 农产品品种
  HAVING 价格 = MIN(价格)
)
SELECT 价格表.*, 推荐市场 
FROM 价格表
LEFT JOIN 最低价市场 USING(农产品品种);
```

---

### **使用建议**
1. **执行顺序**：建议按分类从基础到综合逐步练习
2. **调试技巧**：
   - 复杂查询拆解为多个CTE
   - 使用`WITH`语句创建临时结果集
   - 分步验证子查询结果
3. **性能优化**：
   - 对常用筛选字段（如类别）建立索引
   - 避免在WHERE子句中使用函数计算
   - 大数据量时使用窗口函数替代自连接

如果需要更详细的执行结果示例或特定题目的扩展解释，请告知具体题号。
