<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-office/excel/proj2/rank" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">rank | 河北对口高考计算机专业</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://buhaoqi.github.io/img/logo-orange-social.png"><meta data-rh="true" name="twitter:image" content="https://buhaoqi.github.io/img/logo-orange-social.png"><meta data-rh="true" property="og:url" content="https://buhaoqi.github.io/docs/office/excel/proj2/rank"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="rank | 河北对口高考计算机专业"><meta data-rh="true" name="description" content="一、排名函数基本介绍"><meta data-rh="true" property="og:description" content="一、排名函数基本介绍"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://buhaoqi.github.io/docs/office/excel/proj2/rank"><link data-rh="true" rel="alternate" href="https://buhaoqi.github.io/docs/office/excel/proj2/rank" hreflang="en"><link data-rh="true" rel="alternate" href="https://buhaoqi.github.io/docs/office/excel/proj2/rank" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="河北对口高考计算机专业 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="河北对口高考计算机专业 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.761b036b.css">
<script src="/assets/js/runtime~main.ce5d4c5a.js" defer="defer"></script>
<script src="/assets/js/main.29bf499f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="不好奇 Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="不好奇 Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" docid="csharp/intro" href="/docs/csharp/intro">算法与程序设计</a><a class="navbar__item navbar__link" docid="mysql/intro" href="/docs/mysql/intro">MySQL教程</a><a class="navbar__item navbar__link" href="/docs/bookmarks/intro">网址导航</a><a class="navbar__item navbar__link" docid="teacher/intro" href="/docs/teacher/intro">教育知识与能力</a><a class="navbar__item navbar__link" docid="teacher2/intro" href="/docs/teacher2/intro">综合素质</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://buhaoqi.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-external-link">不好奇课堂<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>rank</h1></header><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="一排名函数基本介绍"><strong>一、排名函数基本介绍</strong><a href="#一排名函数基本介绍" class="hash-link" aria-label="Direct link to 一排名函数基本介绍" title="Direct link to 一排名函数基本介绍" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-函数发展历史"><strong>1. 函数发展历史</strong><a href="#1-函数发展历史" class="hash-link" aria-label="Direct link to 1-函数发展历史" title="Direct link to 1-函数发展历史" translate="no">​</a></h3>
<ul>
<li class=""><strong>RANK()</strong>：Excel 2007及以前版本的函数，为保持兼容性保留</li>
<li class=""><strong>RANK.EQ()</strong>：Excel 2010引入，功能与RANK()相同，是新标准</li>
<li class=""><strong>RANK.AVG()</strong>：Excel 2010引入，相同数值时返回平均排名</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-函数语法对比"><strong>2. 函数语法对比</strong><a href="#2-函数语法对比" class="hash-link" aria-label="Direct link to 2-函数语法对比" title="Direct link to 2-函数语法对比" translate="no">​</a></h3>
<table><thead><tr><th>函数</th><th>语法</th><th>说明</th></tr></thead><tbody><tr><td><strong>RANK()</strong></td><td><code>=RANK(number, ref, [order])</code></td><td>传统排名函数</td></tr><tr><td><strong>RANK.EQ()</strong></td><td><code>=RANK.EQ(number, ref, [order])</code></td><td>等价于RANK()，推荐使用</td></tr><tr><td><strong>RANK.AVG()</strong></td><td><code>=RANK.AVG(number, ref, [order])</code></td><td>相同数值返回平均排名</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-参数详解"><strong>3. 参数详解</strong><a href="#3-参数详解" class="hash-link" aria-label="Direct link to 3-参数详解" title="Direct link to 3-参数详解" translate="no">​</a></h3>
<table><thead><tr><th>参数</th><th>说明</th><th>必需</th></tr></thead><tbody><tr><td><strong>number</strong></td><td>要排名的数值</td><td>是</td></tr><tr><td><strong>ref</strong></td><td>包含所有要排名的数值的区域</td><td>是</td></tr><tr><td><strong>order</strong></td><td>排序方式：0或省略=降序，非0=升序</td><td>否</td></tr></tbody></table>
<p><strong>注意</strong>：</p>
<ul>
<li class=""><strong>降序排名</strong>：数值越大排名越靠前（第1名是最大值）</li>
<li class=""><strong>升序排名</strong>：数值越小排名越靠前（第1名是最小值）</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="二详细示例数据表"><strong>二、详细示例数据表</strong><a href="#二详细示例数据表" class="hash-link" aria-label="Direct link to 二详细示例数据表" title="Direct link to 二详细示例数据表" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表1学生考试成绩表20条记录"><strong>表1：学生考试成绩表（20条记录）</strong><a href="#表1学生考试成绩表20条记录" class="hash-link" aria-label="Direct link to 表1学生考试成绩表20条记录" title="Direct link to 表1学生考试成绩表20条记录" translate="no">​</a></h3>
<table><thead><tr><th>学号</th><th>姓名</th><th>语文</th><th>数学</th><th>英语</th><th>总分</th><th>平均分</th></tr></thead><tbody><tr><td>S001</td><td>张三</td><td>85</td><td>92</td><td>78</td><td>255</td><td>85.0</td></tr><tr><td>S002</td><td>李四</td><td>78</td><td>95</td><td>88</td><td>261</td><td>87.0</td></tr><tr><td>S003</td><td>王五</td><td>92</td><td>88</td><td>76</td><td>256</td><td>85.3</td></tr><tr><td>S004</td><td>赵六</td><td>65</td><td>72</td><td>68</td><td>205</td><td>68.3</td></tr><tr><td>S005</td><td>孙七</td><td>88</td><td>96</td><td>92</td><td>276</td><td>92.0</td></tr><tr><td>S006</td><td>周八</td><td>76</td><td>85</td><td>79</td><td>240</td><td>80.0</td></tr><tr><td>S007</td><td>吴九</td><td>95</td><td>89</td><td>94</td><td>278</td><td>92.7</td></tr><tr><td>S008</td><td>郑十</td><td>82</td><td>78</td><td>85</td><td>245</td><td>81.7</td></tr><tr><td>S009</td><td>钱一</td><td>89</td><td>92</td><td>87</td><td>268</td><td>89.3</td></tr><tr><td>S010</td><td>王一</td><td>73</td><td>68</td><td>72</td><td>213</td><td>71.0</td></tr><tr><td>S011</td><td>刘二</td><td>91</td><td>94</td><td>89</td><td>274</td><td>91.3</td></tr><tr><td>S012</td><td>陈三</td><td>68</td><td>75</td><td>70</td><td>213</td><td>71.0</td></tr><tr><td>S013</td><td>杨四</td><td>87</td><td>90</td><td>86</td><td>263</td><td>87.7</td></tr><tr><td>S014</td><td>黄五</td><td>79</td><td>82</td><td>80</td><td>241</td><td>80.3</td></tr><tr><td>S015</td><td>赵七</td><td>94</td><td>97</td><td>95</td><td>286</td><td>95.3</td></tr><tr><td>S016</td><td>周九</td><td>72</td><td>79</td><td>74</td><td>225</td><td>75.0</td></tr><tr><td>S017</td><td>吴十</td><td>86</td><td>88</td><td>84</td><td>258</td><td>86.0</td></tr><tr><td>S018</td><td>郑一</td><td>90</td><td>93</td><td>91</td><td>274</td><td>91.3</td></tr><tr><td>S019</td><td>王二</td><td>81</td><td>84</td><td>82</td><td>247</td><td>82.3</td></tr><tr><td>S020</td><td>孙三</td><td>70</td><td>76</td><td>73</td><td>219</td><td>73.0</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表2销售业绩表15条记录"><strong>表2：销售业绩表（15条记录）</strong><a href="#表2销售业绩表15条记录" class="hash-link" aria-label="Direct link to 表2销售业绩表15条记录" title="Direct link to 表2销售业绩表15条记录" translate="no">​</a></h3>
<table><thead><tr><th>销售员ID</th><th>姓名</th><th>1月</th><th>2月</th><th>3月</th><th>季度总额</th><th>平均月销</th></tr></thead><tbody><tr><td>SA01</td><td>张明</td><td>158000</td><td>142000</td><td>165000</td><td>465000</td><td>155000</td></tr><tr><td>SA02</td><td>李华</td><td>145000</td><td>138000</td><td>152000</td><td>435000</td><td>145000</td></tr><tr><td>SA03</td><td>王芳</td><td>128000</td><td>135000</td><td>142000</td><td>405000</td><td>135000</td></tr><tr><td>SA04</td><td>赵强</td><td>165000</td><td>158000</td><td>172000</td><td>495000</td><td>165000</td></tr><tr><td>SA05</td><td>孙丽</td><td>142000</td><td>148000</td><td>155000</td><td>445000</td><td>148333</td></tr><tr><td>SA06</td><td>周伟</td><td>135000</td><td>128000</td><td>140000</td><td>403000</td><td>134333</td></tr><tr><td>SA07</td><td>吴刚</td><td>152000</td><td>162000</td><td>158000</td><td>472000</td><td>157333</td></tr><tr><td>SA08</td><td>郑洁</td><td>138000</td><td>145000</td><td>148000</td><td>431000</td><td>143667</td></tr><tr><td>SA09</td><td>钱勇</td><td>148000</td><td>152000</td><td>146000</td><td>446000</td><td>148667</td></tr><tr><td>SA10</td><td>王静</td><td>125000</td><td>132000</td><td>128000</td><td>385000</td><td>128333</td></tr><tr><td>SA11</td><td>刘洋</td><td>162000</td><td>155000</td><td>168000</td><td>485000</td><td>161667</td></tr><tr><td>SA12</td><td>陈晨</td><td>155000</td><td>148000</td><td>162000</td><td>465000</td><td>155000</td></tr><tr><td>SA13</td><td>杨光</td><td>132000</td><td>138000</td><td>135000</td><td>405000</td><td>135000</td></tr><tr><td>SA14</td><td>黄蓉</td><td>142000</td><td>135000</td><td>148000</td><td>425000</td><td>141667</td></tr><tr><td>SA15</td><td>赵云</td><td>158000</td><td>152000</td><td>165000</td><td>475000</td><td>158333</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表3产品销量表相同数值测试"><strong>表3：产品销量表（相同数值测试）</strong><a href="#表3产品销量表相同数值测试" class="hash-link" aria-label="Direct link to 表3产品销量表相同数值测试" title="Direct link to 表3产品销量表相同数值测试" translate="no">​</a></h3>
<table><thead><tr><th>产品ID</th><th>产品名称</th><th>销量</th><th>销售额(元)</th></tr></thead><tbody><tr><td>P001</td><td>iPhone 15</td><td>150</td><td>1,125,000</td></tr><tr><td>P002</td><td>华为P60</td><td>120</td><td>960,000</td></tr><tr><td>P003</td><td>小米13</td><td>180</td><td>1,080,000</td></tr><tr><td>P004</td><td>MacBook Pro</td><td>85</td><td>1,275,000</td></tr><tr><td>P005</td><td>华为平板</td><td>120</td><td>720,000</td></tr><tr><td>P006</td><td>三星电视</td><td>95</td><td>855,000</td></tr><tr><td>P007</td><td>索尼耳机</td><td>150</td><td>450,000</td></tr><tr><td>P008</td><td>戴尔笔记本</td><td>110</td><td>990,000</td></tr><tr><td>P009</td><td>联想电脑</td><td>105</td><td>735,000</td></tr><tr><td>P010</td><td>苹果手表</td><td>180</td><td>1,080,000</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="三基础用法示例"><strong>三、基础用法示例</strong><a href="#三基础用法示例" class="hash-link" aria-label="Direct link to 三基础用法示例" title="Direct link to 三基础用法示例" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例1基本降序排名成绩排名"><strong>示例1：基本降序排名（成绩排名）</strong><a href="#示例1基本降序排名成绩排名" class="hash-link" aria-label="Direct link to 示例1基本降序排名成绩排名" title="Direct link to 示例1基本降序排名成绩排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表1的H列（总分排名）输入公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ(F2, $F$2:$F$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">或者使用RANK()：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK(F2, $F$2:$F$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- F2：要排名的总分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- $F$2:$F$21：总分区域（绝对引用）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 0：降序排名（分数越高排名越靠前）</span><br></span></code></pre></div></div>
<p><strong>结果示例</strong>：</p>
<table><thead><tr><th>姓名</th><th>总分</th><th>排名</th></tr></thead><tbody><tr><td>赵七</td><td>286</td><td>1</td></tr><tr><td>吴九</td><td>278</td><td>2</td></tr><tr><td>孙七</td><td>276</td><td>3</td></tr><tr><td>刘二</td><td>274</td><td>4</td></tr><tr><td>郑一</td><td>274</td><td>4</td></tr><tr><td>钱一</td><td>268</td><td>6</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例2升序排名用时最少排名"><strong>示例2：升序排名（用时最少排名）</strong><a href="#示例2升序排名用时最少排名" class="hash-link" aria-label="Direct link to 示例2升序排名用时最少排名" title="Direct link to 示例2升序排名用时最少排名" translate="no">​</a></h3>
<p>假设有比赛用时数据，时间越少成绩越好：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在I列（用时排名）输入公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ(G2, $G$2:$G$21, 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- G2：比赛用时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 1：升序排名（用时越少排名越靠前）</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例3多科目分别排名"><strong>示例3：多科目分别排名</strong><a href="#示例3多科目分别排名" class="hash-link" aria-label="Direct link to 示例3多科目分别排名" title="Direct link to 示例3多科目分别排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">语文排名：=RANK.EQ(C2, $C$2:$C$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数学排名：=RANK.EQ(D2, $D$2:$D$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">英语排名：=RANK.EQ(E2, $E$2:$E$21, 0)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="四rank-vs-rankeq-vs-rankavg-对比"><strong>四、RANK() vs RANK.EQ() vs RANK.AVG() 对比</strong><a href="#四rank-vs-rankeq-vs-rankavg-对比" class="hash-link" aria-label="Direct link to 四rank-vs-rankeq-vs-rankavg-对比" title="Direct link to 四rank-vs-rankeq-vs-rankavg-对比" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例4相同数值的排名对比"><strong>示例4：相同数值的排名对比</strong><a href="#示例4相同数值的排名对比" class="hash-link" aria-label="Direct link to 示例4相同数值的排名对比" title="Direct link to 示例4相同数值的排名对比" translate="no">​</a></h3>
<p>使用表3的销量数据进行测试：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. 使用RANK.EQ()或RANK()：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   =RANK.EQ(B2, $B$2:$B$11, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   结果：相同销量得到相同排名，后续排名跳过</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 使用RANK.AVG()：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   =RANK.AVG(B2, $B$2:$B$11, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   结果：相同销量得到平均排名</span><br></span></code></pre></div></div>
<p><strong>对比结果表</strong>：</p>
<table><thead><tr><th>产品名称</th><th>销量</th><th>RANK.EQ排名</th><th>RANK.AVG排名</th><th>说明</th></tr></thead><tbody><tr><td>小米13</td><td>180</td><td>1</td><td>1.5</td><td>与苹果手表并列，平均排名(1+2)/2=1.5</td></tr><tr><td>苹果手表</td><td>180</td><td>1</td><td>1.5</td><td>同上</td></tr><tr><td>iPhone 15</td><td>150</td><td>3</td><td>3.5</td><td>与索尼耳机并列，(3+4)/2=3.5</td></tr><tr><td>索尼耳机</td><td>150</td><td>3</td><td>3.5</td><td>同上</td></tr><tr><td>华为P60</td><td>120</td><td>5</td><td>5.5</td><td>与华为平板并列，(5+6)/2=5.5</td></tr><tr><td>华为平板</td><td>120</td><td>5</td><td>5.5</td><td>同上</td></tr><tr><td>戴尔笔记本</td><td>110</td><td>7</td><td>7</td><td>唯一值</td></tr><tr><td>联想电脑</td><td>105</td><td>8</td><td>8</td><td>唯一值</td></tr><tr><td>三星电视</td><td>95</td><td>9</td><td>9</td><td>唯一值</td></tr><tr><td>MacBook Pro</td><td>85</td><td>10</td><td>10</td><td>唯一值</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例5并列排名的差异"><strong>示例5：并列排名的差异</strong><a href="#示例5并列排名的差异" class="hash-link" aria-label="Direct link to 示例5并列排名的差异" title="Direct link to 示例5并列排名的差异" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">情况：4个人得分相同，都是90分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">最高分100分有1人，95分有2人</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RANK.EQ结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100分：第1名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">95分：第2名（2人并列）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">90分：第4名（4人并列）← 注意：跳过了第3名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RANK.AVG结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100分：第1名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">95分：第2.5名（(2+3)/2=2.5）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">90分：第5名（(4+5+6+7)/4=5.5）</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="五实际应用场景"><strong>五、实际应用场景</strong><a href="#五实际应用场景" class="hash-link" aria-label="Direct link to 五实际应用场景" title="Direct link to 五实际应用场景" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景1学生成绩排名系统"><strong>场景1：学生成绩排名系统</strong><a href="#场景1学生成绩排名系统" class="hash-link" aria-label="Direct link to 场景1学生成绩排名系统" title="Direct link to 场景1学生成绩排名系统" translate="no">​</a></h3>
<p>在表1中添加排名列：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">H列（总分排名）：=RANK.EQ(F2, $F$2:$F$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I列（班级排名百分比）：=H2/COUNT($F$2:$F$21)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">J列（前10%标记）：=IF(I2&lt;=0.1, &quot;优秀&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">K列（排名变化）：与前次考试排名比较</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景2销售业绩排行榜"><strong>场景2：销售业绩排行榜</strong><a href="#场景2销售业绩排行榜" class="hash-link" aria-label="Direct link to 场景2销售业绩排行榜" title="Direct link to 场景2销售业绩排行榜" translate="no">​</a></h3>
<p>在表2中添加排名列：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">H列（季度排名）：=RANK.EQ(F2, $F$2:$F$16, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I列（月度平均排名）：=RANK.EQ(G2, $G$2:$G$16, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">J列（奖金等级）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LOOKUP(H2, {1,4,8,12}, {&quot;特等&quot;,&quot;一等&quot;,&quot;二等&quot;,&quot;三等&quot;})</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景3体育比赛排名系统"><strong>场景3：体育比赛排名系统</strong><a href="#场景3体育比赛排名系统" class="hash-link" aria-label="Direct link to 场景3体育比赛排名系统" title="Direct link to 场景3体育比赛排名系统" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：运动员 | 100米成绩 | 跳远成绩 | 总分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 单项排名（时间越少越好）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   百米排名：=RANK.EQ(B2, $B$2:$B$20, 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 综合排名（分数越高越好）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   总分排名：=RANK.EQ(D2, $D$2:$D$20, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 双排名差异：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   =ABS(百米排名-总分排名)  // 发现偏科选手</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景4产品质量评分排名"><strong>场景4：产品质量评分排名</strong><a href="#场景4产品质量评分排名" class="hash-link" aria-label="Direct link to 场景4产品质量评分排名" title="Direct link to 场景4产品质量评分排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：产品ID | 外观分 | 性能分 | 耐用分 | 总分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">加权总分：=B2*0.3+C2*0.5+D2*0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">综合排名：=RANK.AVG(E2, $E$2:$E$50, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">等级划分：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=IF(F2&lt;=10, &quot;A级&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF(F2&lt;=30, &quot;B级&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       IF(F2&lt;=50, &quot;C级&quot;, &quot;D级&quot;)))</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="六常见问题与解决方案"><strong>六、常见问题与解决方案</strong><a href="#六常见问题与解决方案" class="hash-link" aria-label="Direct link to 六常见问题与解决方案" title="Direct link to 六常见问题与解决方案" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题1为什么我的排名结果不对"><strong>问题1：为什么我的排名结果不对？</strong><a href="#问题1为什么我的排名结果不对" class="hash-link" aria-label="Direct link to 问题1为什么我的排名结果不对" title="Direct link to 问题1为什么我的排名结果不对" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">可能原因及解决：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 区域引用错误：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   错误：=RANK.EQ(A2, A2:A100, 0)  // 相对引用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   正确：=RANK.EQ(A2, $A$2:$A$100, 0)  // 绝对引用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 数据包含非数值：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   解决：=RANK.EQ(VALUE(A2), $A$2:$A$100, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 排序方式理解错误：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   order=0：降序（最大值排第1）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   order=1：升序（最小值排第1）</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题2如何处理并列排名"><strong>问题2：如何处理并列排名？</strong><a href="#问题2如何处理并列排名" class="hash-link" aria-label="Direct link to 问题2如何处理并列排名" title="Direct link to 问题2如何处理并列排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">需求：中国式排名（不跳过名次）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方法1：使用COUNTIFS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUMPRODUCT(($F$2:$F$21&gt;F2)/COUNTIF($F$2:$F$21,$F$2:$F$21))+1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方法2：使用FREQUENCY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUM(--(FREQUENCY($F$2:$F$21, $F$2:$F$21)&gt;0))-SUM(--(FREQUENCY($F$2:$F$21, IF($F$2:$F$21&gt;F2, $F$2:$F$21))&gt;0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方法3：简单但有限制</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ(F2, $F$2:$F$21, 0)+COUNTIF($F$2:F2, F2)-1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题3如何排除某些值不参与排名"><strong>问题3：如何排除某些值不参与排名？</strong><a href="#问题3如何排除某些值不参与排名" class="hash-link" aria-label="Direct link to 问题3如何排除某些值不参与排名" title="Direct link to 问题3如何排除某些值不参与排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">假设成绩为0表示缺考，不参与排名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=IF(F2=0, &quot;缺考&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RANK.EQ(F2, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FILTER($F$2:$F$21, $F$2:$F$21&gt;0), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题4如何实现分组排名"><strong>问题4：如何实现分组排名？</strong><a href="#问题4如何实现分组排名" class="hash-link" aria-label="Direct link to 问题4如何实现分组排名" title="Direct link to 问题4如何实现分组排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：班级 | 姓名 | 成绩</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">需求：每个班级内部排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数组公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUMPRODUCT(($A$2:$A$100=A2)*($C$2:$C$100&gt;C2))+1</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="七高级技巧与应用"><strong>七、高级技巧与应用</strong><a href="#七高级技巧与应用" class="hash-link" aria-label="Direct link to 七高级技巧与应用" title="Direct link to 七高级技巧与应用" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧1动态排名区域"><strong>技巧1：动态排名区域</strong><a href="#技巧1动态排名区域" class="hash-link" aria-label="Direct link to 技巧1动态排名区域" title="Direct link to 技巧1动态排名区域" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">使用OFFSET定义动态区域：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ(F2, OFFSET($F$2,0,0,COUNTA($F:$F)-1,1), 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">或者使用表格：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ([@总分], [总分], 0)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧2条件排名"><strong>技巧2：条件排名</strong><a href="#技巧2条件排名" class="hash-link" aria-label="Direct link to 技巧2条件排名" title="Direct link to 技巧2条件排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">需求：只排名男生的成绩</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数组公式（Ctrl+Shift+Enter）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUM((B$2:B$100=&quot;男&quot;)*(C$2:C$100&gt;C2))+1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧3百分比排名"><strong>技巧3：百分比排名</strong><a href="#技巧3百分比排名" class="hash-link" aria-label="Direct link to 技巧3百分比排名" title="Direct link to 技巧3百分比排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">计算成绩在前百分之多少：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方法1：使用PERCENTRANK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=PERCENTRANK.INC($F$2:$F$21, F2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方法2：手动计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ(F2, $F$2:$F$21, 0)/COUNT($F$2:$F$21)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧4多条件加权排名"><strong>技巧4：多条件加权排名</strong><a href="#技巧4多条件加权排名" class="hash-link" aria-label="Direct link to 技巧4多条件加权排名" title="Direct link to 技巧4多条件加权排名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">综合成绩 = 平时成绩×30% + 期中×30% + 期末×40%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">综合排名 = RANK.EQ(综合成绩, 综合成绩区域, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">分项排名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">平时排名：RANK.EQ(平时成绩, 平时成绩区域, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">稳定性评分：=AVERAGE(各次排名标准差) // 越小越稳定</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧5排名变化追踪"><strong>技巧5：排名变化追踪</strong><a href="#技巧5排名变化追踪" class="hash-link" aria-label="Direct link to 技巧5排名变化追踪" title="Direct link to 技巧5排名变化追踪" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">本月排名：=RANK.EQ(F2, $F$2:$F$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">上月排名：从历史表获取</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">排名变化：=本月排名-上月排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">进步标记：=IF(排名变化&lt;0, &quot;↑进步&quot;, IF(排名变化&gt;0, &quot;↓退步&quot;, &quot;-持平&quot;))</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="八rank函数与其他函数组合"><strong>八、RANK函数与其他函数组合</strong><a href="#八rank函数与其他函数组合" class="hash-link" aria-label="Direct link to 八rank函数与其他函数组合" title="Direct link to 八rank函数与其他函数组合" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合1rank--if条件显示"><strong>组合1：RANK + IF（条件显示）</strong><a href="#组合1rank--if条件显示" class="hash-link" aria-label="Direct link to 组合1rank--if条件显示" title="Direct link to 组合1rank--if条件显示" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=IF(F2&gt;=60, RANK.EQ(F2, $F$2:$F$21, 0), &quot;不及格&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=IF(RANK.EQ(F2, $F$2:$F$21, 0)&lt;=10, &quot;前十名&quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合2rank--vlookup查找对应信息"><strong>组合2：RANK + VLOOKUP（查找对应信息）</strong><a href="#组合2rank--vlookup查找对应信息" class="hash-link" aria-label="Direct link to 组合2rank--vlookup查找对应信息" title="Direct link to 组合2rank--vlookup查找对应信息" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">先排名，再根据排名查找学生信息：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">排名列：=RANK.EQ(F2, $F$2:$F$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">查找第1名姓名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=VLOOKUP(1, CHOOSE({1,2}, H$2:H$21, B$2:B$21), 2, FALSE)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合3rank--largesmall获取前n名"><strong>组合3：RANK + LARGE/SMALL（获取前N名）</strong><a href="#组合3rank--largesmall获取前n名" class="hash-link" aria-label="Direct link to 组合3rank--largesmall获取前n名" title="Direct link to 组合3rank--largesmall获取前n名" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">获取前3名成绩：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">第1名：=LARGE($F$2:$F$21, 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">第2名：=LARGE($F$2:$F$21, 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">第3名：=LARGE($F$2:$F$21, 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">获取第1名姓名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=INDEX($B$2:$B$21, MATCH(LARGE($F$2:$F$21, 1), $F$2:$F$21, 0))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合4rank--countif处理重复值"><strong>组合4：RANK + COUNTIF（处理重复值）</strong><a href="#组合4rank--countif处理重复值" class="hash-link" aria-label="Direct link to 组合4rank--countif处理重复值" title="Direct link to 组合4rank--countif处理重复值" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在有重复值时添加辅助排名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=RANK.EQ(F2, $F$2:$F$21, 0) + COUNTIF($F$2:F2, F2) - 1</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="九性能优化建议"><strong>九、性能优化建议</strong><a href="#九性能优化建议" class="hash-link" aria-label="Direct link to 九性能优化建议" title="Direct link to 九性能优化建议" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-避免整列引用"><strong>1. 避免整列引用</strong><a href="#1-避免整列引用" class="hash-link" aria-label="Direct link to 1-避免整列引用" title="Direct link to 1-避免整列引用" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">不好：=RANK.EQ(A2, A:A, 0)  // 全列计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">好：=RANK.EQ(A2, $A$2:$A$1000, 0)  // 限定范围</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-使用排序减少计算"><strong>2. 使用排序减少计算</strong><a href="#2-使用排序减少计算" class="hash-link" aria-label="Direct link to 2-使用排序减少计算" title="Direct link to 2-使用排序减少计算" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">如果数据已排序，可以使用更简单的公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">降序排序后：=MATCH(F2, $F$2:$F$21, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">升序排序后：=MATCH(F2, $F$2:$F$21, 1)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-批量计算"><strong>3. 批量计算</strong><a href="#3-批量计算" class="hash-link" aria-label="Direct link to 3-批量计算" title="Direct link to 3-批量计算" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">将排名公式放在一个单元格，然后向下填充</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">避免在条件格式中直接使用RANK函数</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-考虑使用数据透视表"><strong>4. 考虑使用数据透视表</strong><a href="#4-考虑使用数据透视表" class="hash-link" aria-label="Direct link to 4-考虑使用数据透视表" title="Direct link to 4-考虑使用数据透视表" translate="no">​</a></h3>
<p>对于大数据量的排名，数据透视表的排序功能更高效。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十综合实战案例"><strong>十、综合实战案例</strong><a href="#十综合实战案例" class="hash-link" aria-label="Direct link to 十综合实战案例" title="Direct link to 十综合实战案例" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例1学生成绩综合排名系统"><strong>案例1：学生成绩综合排名系统</strong><a href="#案例1学生成绩综合排名系统" class="hash-link" aria-label="Direct link to 案例1学生成绩综合排名系统" title="Direct link to 案例1学生成绩综合排名系统" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">目标：创建包含以下功能的系统</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 各科排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 总分排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 班级排名百分比</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 进步退步分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. 奖励名单自动生成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">实现步骤：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 计算各科排名：=RANK.EQ(C2, $C$2:$C$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 计算总分排名：=RANK.EQ(F2, $F$2:$F$21, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 百分比排名：=H2/COUNT($F$2:$F$21)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 进步分析：与前次排名比较</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. 奖励名单：=IF(H2&lt;=10, &quot;获奖&quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例2销售团队绩效看板"><strong>案例2：销售团队绩效看板</strong><a href="#案例2销售团队绩效看板" class="hash-link" aria-label="Direct link to 案例2销售团队绩效看板" title="Direct link to 案例2销售团队绩效看板" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">目标：月度销售排名看板</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">功能：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 月度排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 季度累计排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 排名趋势（上升/下降）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 奖金自动计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. 可视化仪表板</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公式示例：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">月度排名：=RANK.EQ(C2, $C$2:$C$16, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">季度排名：=RANK.EQ(F2, $F$2:$F$16, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">排名变化：=本月排名-上月排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">奖金基数：=LOOKUP(月度排名, {1,2,3,4,5}, {10000,8000,6000,4000,2000})</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例3产品质量评分排名系统"><strong>案例3：产品质量评分排名系统</strong><a href="#案例3产品质量评分排名系统" class="hash-link" aria-label="Direct link to 案例3产品质量评分排名系统" title="Direct link to 案例3产品质量评分排名系统" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：产品ID | 批次 | 外观分 | 性能分 | 安全分 | 总分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">需求：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 按批次内排名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 历史排名趋势</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 等级划分（A/B/C/D）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 预警机制（连续下降）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">实现：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">批次内排名：=SUMPRODUCT(($B$2:$B$100=B2)*($F$2:$F$100&gt;F2))+1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">等级划分：=LOOKUP(排名, {1,5,10,15}, {&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">连续下降预警：=IF(AND(本次排名&gt;上次排名, 上上次排名&gt;上次排名), &quot;预警&quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十一版本兼容性说明"><strong>十一、版本兼容性说明</strong><a href="#十一版本兼容性说明" class="hash-link" aria-label="Direct link to 十一版本兼容性说明" title="Direct link to 十一版本兼容性说明" translate="no">​</a></h2>
<table><thead><tr><th>Excel版本</th><th>RANK()</th><th>RANK.EQ()</th><th>RANK.AVG()</th><th>建议</th></tr></thead><tbody><tr><td>2003及以前</td><td>✓</td><td>✗</td><td>✗</td><td>使用RANK()</td></tr><tr><td>2007</td><td>✓</td><td>✗</td><td>✗</td><td>使用RANK()</td></tr><tr><td>2010-2013</td><td>✓</td><td>✓</td><td>✓</td><td>推荐RANK.EQ()</td></tr><tr><td>2016-2019</td><td>✓</td><td>✓</td><td>✓</td><td>推荐RANK.EQ()</td></tr><tr><td>365</td><td>✓</td><td>✓</td><td>✓</td><td>推荐RANK.EQ()</td></tr></tbody></table>
<p><strong>跨版本建议</strong>：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=IFERROR(RANK.EQ(A2, $A$2:$A$100, 0), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         IFERROR(RANK(A2, $A$2:$A$100, 0), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;函数不可用&quot;))</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十二总结对比表"><strong>十二、总结对比表</strong><a href="#十二总结对比表" class="hash-link" aria-label="Direct link to 十二总结对比表" title="Direct link to 十二总结对比表" translate="no">​</a></h2>
<table><thead><tr><th>特性</th><th>RANK()</th><th>RANK.EQ()</th><th>RANK.AVG()</th><th>适用场景</th></tr></thead><tbody><tr><td>相同值处理</td><td>并列相同排名，跳过后续名次</td><td>同RANK()</td><td>返回平均排名</td><td>需要精确排名时使用EQ，需要平滑排名时使用AVG</td></tr><tr><td>版本兼容</td><td>所有版本</td><td>2010+</td><td>2010+</td><td>旧文件用RANK，新文件用EQ</td></tr><tr><td>语法</td><td>=RANK(num,ref,order)</td><td>=RANK.EQ(num,ref,order)</td><td>=RANK.AVG(num,ref,order)</td><td>参数相同</td></tr><tr><td>性能</td><td>相同</td><td>相同</td><td>稍慢（需计算平均）</td><td>大数据量慎用AVG</td></tr><tr><td>推荐度</td><td>★★★☆☆</td><td>★★★★★</td><td>★★★★☆</td><td>新项目一律用EQ</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十三最佳实践建议"><strong>十三、最佳实践建议</strong><a href="#十三最佳实践建议" class="hash-link" aria-label="Direct link to 十三最佳实践建议" title="Direct link to 十三最佳实践建议" translate="no">​</a></h2>
<ol>
<li class=""><strong>新项目一律使用RANK.EQ()</strong>，这是未来的标准</li>
<li class=""><strong>处理并列排名时</strong>，明确业务需求：<!-- -->
<ul>
<li class="">跳名次排名：RANK.EQ()</li>
<li class="">平均排名：RANK.AVG()</li>
<li class="">不跳名次（中国式排名）：使用COUNTIFS自定义公式</li>
</ul>
</li>
<li class=""><strong>使用绝对引用</strong>：$F$2:$F$100</li>
<li class=""><strong>明确排序方向</strong>：0=降序，1=升序</li>
<li class=""><strong>处理错误值</strong>：=IFERROR(RANK.EQ(...), &quot;数据异常&quot;)</li>
<li class=""><strong>考虑性能</strong>：避免在大型数据集频繁使用RANK函数</li>
<li class=""><strong>文档记录</strong>：在复杂排名逻辑旁添加注释说明</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十四练习题目"><strong>十四、练习题目</strong><a href="#十四练习题目" class="hash-link" aria-label="Direct link to 十四练习题目" title="Direct link to 十四练习题目" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="基础练习"><strong>基础练习</strong><a href="#基础练习" class="hash-link" aria-label="Direct link to 基础练习" title="Direct link to 基础练习" translate="no">​</a></h3>
<ol>
<li class="">使用RANK.EQ()计算学生总分排名</li>
<li class="">使用RANK.AVG()计算产品销量排名，观察并列差异</li>
<li class="">分别使用降序和升序对销售业绩排名</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="中级练习"><strong>中级练习</strong><a href="#中级练习" class="hash-link" aria-label="Direct link to 中级练习" title="Direct link to 中级练习" translate="no">​</a></h3>
<ol>
<li class="">实现中国式排名（不跳名次）</li>
<li class="">创建分组排名系统（按班级、部门等分组）</li>
<li class="">设计排名变化趋势分析</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="高级练习"><strong>高级练习</strong><a href="#高级练习" class="hash-link" aria-label="Direct link to 高级练习" title="Direct link to 高级练习" translate="no">​</a></h3>
<ol>
<li class="">构建多维度加权排名系统</li>
<li class="">实现动态排名仪表板</li>
<li class="">设计排名预警系统（连续下降预警）</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实战挑战"><strong>实战挑战</strong><a href="#实战挑战" class="hash-link" aria-label="Direct link to 实战挑战" title="Direct link to 实战挑战" translate="no">​</a></h3>
<ol>
<li class="">模拟奥运会奖牌榜排名规则</li>
<li class="">实现电商商品多维度综合排名</li>
<li class="">设计员工绩效考核排名系统</li>
</ol>
<hr>
<p><strong>最后建议</strong>：实际工作中，排名需求往往比想象的复杂。在开始前，一定要与业务方确认清楚排名规则，特别是如何处理并列情况。这是避免返工的关键！</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/office/excel/proj2/rank.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一排名函数基本介绍" class="table-of-contents__link toc-highlight"><strong>一、排名函数基本介绍</strong></a><ul><li><a href="#1-函数发展历史" class="table-of-contents__link toc-highlight"><strong>1. 函数发展历史</strong></a></li><li><a href="#2-函数语法对比" class="table-of-contents__link toc-highlight"><strong>2. 函数语法对比</strong></a></li><li><a href="#3-参数详解" class="table-of-contents__link toc-highlight"><strong>3. 参数详解</strong></a></li></ul></li><li><a href="#二详细示例数据表" class="table-of-contents__link toc-highlight"><strong>二、详细示例数据表</strong></a><ul><li><a href="#表1学生考试成绩表20条记录" class="table-of-contents__link toc-highlight"><strong>表1：学生考试成绩表（20条记录）</strong></a></li><li><a href="#表2销售业绩表15条记录" class="table-of-contents__link toc-highlight"><strong>表2：销售业绩表（15条记录）</strong></a></li><li><a href="#表3产品销量表相同数值测试" class="table-of-contents__link toc-highlight"><strong>表3：产品销量表（相同数值测试）</strong></a></li></ul></li><li><a href="#三基础用法示例" class="table-of-contents__link toc-highlight"><strong>三、基础用法示例</strong></a><ul><li><a href="#示例1基本降序排名成绩排名" class="table-of-contents__link toc-highlight"><strong>示例1：基本降序排名（成绩排名）</strong></a></li><li><a href="#示例2升序排名用时最少排名" class="table-of-contents__link toc-highlight"><strong>示例2：升序排名（用时最少排名）</strong></a></li><li><a href="#示例3多科目分别排名" class="table-of-contents__link toc-highlight"><strong>示例3：多科目分别排名</strong></a></li></ul></li><li><a href="#四rank-vs-rankeq-vs-rankavg-对比" class="table-of-contents__link toc-highlight"><strong>四、RANK() vs RANK.EQ() vs RANK.AVG() 对比</strong></a><ul><li><a href="#示例4相同数值的排名对比" class="table-of-contents__link toc-highlight"><strong>示例4：相同数值的排名对比</strong></a></li><li><a href="#示例5并列排名的差异" class="table-of-contents__link toc-highlight"><strong>示例5：并列排名的差异</strong></a></li></ul></li><li><a href="#五实际应用场景" class="table-of-contents__link toc-highlight"><strong>五、实际应用场景</strong></a><ul><li><a href="#场景1学生成绩排名系统" class="table-of-contents__link toc-highlight"><strong>场景1：学生成绩排名系统</strong></a></li><li><a href="#场景2销售业绩排行榜" class="table-of-contents__link toc-highlight"><strong>场景2：销售业绩排行榜</strong></a></li><li><a href="#场景3体育比赛排名系统" class="table-of-contents__link toc-highlight"><strong>场景3：体育比赛排名系统</strong></a></li><li><a href="#场景4产品质量评分排名" class="table-of-contents__link toc-highlight"><strong>场景4：产品质量评分排名</strong></a></li></ul></li><li><a href="#六常见问题与解决方案" class="table-of-contents__link toc-highlight"><strong>六、常见问题与解决方案</strong></a><ul><li><a href="#问题1为什么我的排名结果不对" class="table-of-contents__link toc-highlight"><strong>问题1：为什么我的排名结果不对？</strong></a></li><li><a href="#问题2如何处理并列排名" class="table-of-contents__link toc-highlight"><strong>问题2：如何处理并列排名？</strong></a></li><li><a href="#问题3如何排除某些值不参与排名" class="table-of-contents__link toc-highlight"><strong>问题3：如何排除某些值不参与排名？</strong></a></li><li><a href="#问题4如何实现分组排名" class="table-of-contents__link toc-highlight"><strong>问题4：如何实现分组排名？</strong></a></li></ul></li><li><a href="#七高级技巧与应用" class="table-of-contents__link toc-highlight"><strong>七、高级技巧与应用</strong></a><ul><li><a href="#技巧1动态排名区域" class="table-of-contents__link toc-highlight"><strong>技巧1：动态排名区域</strong></a></li><li><a href="#技巧2条件排名" class="table-of-contents__link toc-highlight"><strong>技巧2：条件排名</strong></a></li><li><a href="#技巧3百分比排名" class="table-of-contents__link toc-highlight"><strong>技巧3：百分比排名</strong></a></li><li><a href="#技巧4多条件加权排名" class="table-of-contents__link toc-highlight"><strong>技巧4：多条件加权排名</strong></a></li><li><a href="#技巧5排名变化追踪" class="table-of-contents__link toc-highlight"><strong>技巧5：排名变化追踪</strong></a></li></ul></li><li><a href="#八rank函数与其他函数组合" class="table-of-contents__link toc-highlight"><strong>八、RANK函数与其他函数组合</strong></a><ul><li><a href="#组合1rank--if条件显示" class="table-of-contents__link toc-highlight"><strong>组合1：RANK + IF（条件显示）</strong></a></li><li><a href="#组合2rank--vlookup查找对应信息" class="table-of-contents__link toc-highlight"><strong>组合2：RANK + VLOOKUP（查找对应信息）</strong></a></li><li><a href="#组合3rank--largesmall获取前n名" class="table-of-contents__link toc-highlight"><strong>组合3：RANK + LARGE/SMALL（获取前N名）</strong></a></li><li><a href="#组合4rank--countif处理重复值" class="table-of-contents__link toc-highlight"><strong>组合4：RANK + COUNTIF（处理重复值）</strong></a></li></ul></li><li><a href="#九性能优化建议" class="table-of-contents__link toc-highlight"><strong>九、性能优化建议</strong></a><ul><li><a href="#1-避免整列引用" class="table-of-contents__link toc-highlight"><strong>1. 避免整列引用</strong></a></li><li><a href="#2-使用排序减少计算" class="table-of-contents__link toc-highlight"><strong>2. 使用排序减少计算</strong></a></li><li><a href="#3-批量计算" class="table-of-contents__link toc-highlight"><strong>3. 批量计算</strong></a></li><li><a href="#4-考虑使用数据透视表" class="table-of-contents__link toc-highlight"><strong>4. 考虑使用数据透视表</strong></a></li></ul></li><li><a href="#十综合实战案例" class="table-of-contents__link toc-highlight"><strong>十、综合实战案例</strong></a><ul><li><a href="#案例1学生成绩综合排名系统" class="table-of-contents__link toc-highlight"><strong>案例1：学生成绩综合排名系统</strong></a></li><li><a href="#案例2销售团队绩效看板" class="table-of-contents__link toc-highlight"><strong>案例2：销售团队绩效看板</strong></a></li><li><a href="#案例3产品质量评分排名系统" class="table-of-contents__link toc-highlight"><strong>案例3：产品质量评分排名系统</strong></a></li></ul></li><li><a href="#十一版本兼容性说明" class="table-of-contents__link toc-highlight"><strong>十一、版本兼容性说明</strong></a></li><li><a href="#十二总结对比表" class="table-of-contents__link toc-highlight"><strong>十二、总结对比表</strong></a></li><li><a href="#十三最佳实践建议" class="table-of-contents__link toc-highlight"><strong>十三、最佳实践建议</strong></a></li><li><a href="#十四练习题目" class="table-of-contents__link toc-highlight"><strong>十四、练习题目</strong></a><ul><li><a href="#基础练习" class="table-of-contents__link toc-highlight"><strong>基础练习</strong></a></li><li><a href="#中级练习" class="table-of-contents__link toc-highlight"><strong>中级练习</strong></a></li><li><a href="#高级练习" class="table-of-contents__link toc-highlight"><strong>高级练习</strong></a></li><li><a href="#实战挑战" class="table-of-contents__link toc-highlight"><strong>实战挑战</strong></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>