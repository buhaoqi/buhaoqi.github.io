<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-office/excel/proj2/replace" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">replace | 河北对口高考计算机专业</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://buhaoqi.github.io/img/logo-orange-social.png"><meta data-rh="true" name="twitter:image" content="https://buhaoqi.github.io/img/logo-orange-social.png"><meta data-rh="true" property="og:url" content="https://buhaoqi.github.io/docs/office/excel/proj2/replace"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="replace | 河北对口高考计算机专业"><meta data-rh="true" name="description" content="Excel REPLACE()函数详解：精准的文本替换专家"><meta data-rh="true" property="og:description" content="Excel REPLACE()函数详解：精准的文本替换专家"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://buhaoqi.github.io/docs/office/excel/proj2/replace"><link data-rh="true" rel="alternate" href="https://buhaoqi.github.io/docs/office/excel/proj2/replace" hreflang="en"><link data-rh="true" rel="alternate" href="https://buhaoqi.github.io/docs/office/excel/proj2/replace" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="河北对口高考计算机专业 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="河北对口高考计算机专业 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.761b036b.css">
<script src="/assets/js/runtime~main.c31f22bc.js" defer="defer"></script>
<script src="/assets/js/main.40ba17e7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="不好奇 Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="不好奇 Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" docid="csharp/intro" href="/docs/csharp/intro">算法与程序设计</a><a class="navbar__item navbar__link" docid="mysql/intro" href="/docs/mysql/intro">MySQL教程</a><a class="navbar__item navbar__link" href="/docs/bookmarks/intro">网址导航</a><a class="navbar__item navbar__link" docid="teacher/intro" href="/docs/teacher/intro">教育知识与能力</a><a class="navbar__item navbar__link" docid="teacher2/intro" href="/docs/teacher2/intro">综合素质</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://buhaoqi.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-external-link">不好奇课堂<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>replace</h1></header><p>Excel REPLACE()函数详解：精准的文本替换专家</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="一replace函数基础"><strong>一、REPLACE()函数基础</strong><a href="#一replace函数基础" class="hash-link" aria-label="Direct link to 一replace函数基础" title="Direct link to 一replace函数基础" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-函数语法"><strong>1. 函数语法</strong><a href="#1-函数语法" class="hash-link" aria-label="Direct link to 1-函数语法" title="Direct link to 1-函数语法" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(old_text, start_num, num_chars, new_text)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-参数详解"><strong>2. 参数详解</strong><a href="#2-参数详解" class="hash-link" aria-label="Direct link to 2-参数详解" title="Direct link to 2-参数详解" translate="no">​</a></h3>
<table><thead><tr><th>参数</th><th>说明</th><th>必需</th><th>注意事项</th></tr></thead><tbody><tr><td><strong>old_text</strong></td><td>原始文本</td><td>是</td><td>可以是单元格引用或文本字符串</td></tr><tr><td><strong>start_num</strong></td><td>开始位置</td><td>是</td><td>从1开始计数</td></tr><tr><td><strong>num_chars</strong></td><td>要替换的字符数</td><td>是</td><td>0表示插入而不删除</td></tr><tr><td><strong>new_text</strong></td><td>新文本</td><td>是</td><td>替换后的内容</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-重要特性"><strong>3. 重要特性</strong><a href="#3-重要特性" class="hash-link" aria-label="Direct link to 3-重要特性" title="Direct link to 3-重要特性" translate="no">​</a></h3>
<ul>
<li class="">按<strong>位置</strong>替换，而不是按内容</li>
<li class="">可以<strong>删除</strong>字符（new_text为空）</li>
<li class="">可以<strong>插入</strong>字符（num_chars=0）</li>
<li class="">返回<strong>文本</strong>类型</li>
<li class="">区分中英文，每个字符都算一个位置</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="二详细示例数据表"><strong>二、详细示例数据表</strong><a href="#二详细示例数据表" class="hash-link" aria-label="Direct link to 二详细示例数据表" title="Direct link to 二详细示例数据表" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表1产品编码修正表"><strong>表1：产品编码修正表</strong><a href="#表1产品编码修正表" class="hash-link" aria-label="Direct link to 表1产品编码修正表" title="Direct link to 表1产品编码修正表" translate="no">​</a></h3>
<table><thead><tr><th>原始编码</th><th>产品名称</th><th>问题描述</th></tr></thead><tbody><tr><td>IPHON15PRO</td><td>iPhone 15 Pro</td><td>缺少连字符</td></tr><tr><td>HW-P60PRO</td><td>华为P60 Pro</td><td>型号少连字符</td></tr><tr><td>MB-AIR-M1</td><td>MacBook Air M1</td><td>芯片型号错误</td></tr><tr><td>MI13ULTRA</td><td>小米13 Ultra</td><td>缺少连字符</td></tr><tr><td>SN-WH100XM4</td><td>索尼WH-1000XM4</td><td>型号数字错误</td></tr><tr><td>AP-WTCHS8</td><td>Apple Watch S8</td><td>拼写错误</td></tr><tr><td>SM-GALAXY23</td><td>Samsung Galaxy S23</td><td>型号错误</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表2电话号码格式化表"><strong>表2：电话号码格式化表</strong><a href="#表2电话号码格式化表" class="hash-link" aria-label="Direct link to 表2电话号码格式化表" title="Direct link to 表2电话号码格式化表" translate="no">​</a></h3>
<table><thead><tr><th>联系人</th><th>原始号码</th><th>地区</th></tr></thead><tbody><tr><td>张三</td><td>13800138001</td><td>北京</td></tr><tr><td>李四</td><td>13912345678</td><td>上海</td></tr><tr><td>王五</td><td>13678901234</td><td>广州</td></tr><tr><td>赵六</td><td>13755556666</td><td>深圳</td></tr><tr><td>孙七</td><td>13512341234</td><td>杭州</td></tr><tr><td>周八</td><td>13400001111</td><td>成都</td></tr><tr><td>吴九</td><td>13399998888</td><td>武汉</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表3身份证号脱敏表"><strong>表3：身份证号脱敏表</strong><a href="#表3身份证号脱敏表" class="hash-link" aria-label="Direct link to 表3身份证号脱敏表" title="Direct link to 表3身份证号脱敏表" translate="no">​</a></h3>
<table><thead><tr><th>姓名</th><th>完整身份证号</th><th>出生日期</th><th>性别</th></tr></thead><tbody><tr><td>张明</td><td>110101199003075678</td><td>1990-03-07</td><td>男</td></tr><tr><td>李华</td><td>310104199105128912</td><td>1991-05-12</td><td>女</td></tr><tr><td>王芳</td><td>440305199208153456</td><td>1992-08-15</td><td>女</td></tr><tr><td>赵强</td><td>330106198512204321</td><td>1985-12-20</td><td>男</td></tr><tr><td>孙丽</td><td>420111199510087890</td><td>1995-10-08</td><td>女</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表4文件重命名表"><strong>表4：文件重命名表</strong><a href="#表4文件重命名表" class="hash-link" aria-label="Direct link to 表4文件重命名表" title="Direct link to 表4文件重命名表" translate="no">​</a></h3>
<table><thead><tr><th>原始文件名</th><th>文件类型</th><th>日期</th><th>版本</th></tr></thead><tbody><tr><td>report20240101</td><td>销售报告</td><td>2024-01-01</td><td>v1</td></tr><tr><td>data_analysis_0102</td><td>数据分析</td><td>2024-01-02</td><td>v2</td></tr><tr><td>budget_Q1_2024</td><td>预算表</td><td>2024-01-03</td><td>v3</td></tr><tr><td>meeting_minutes_0104</td><td>会议纪要</td><td>2024-01-04</td><td>v1</td></tr><tr><td>project_plan_0105</td><td>项目计划</td><td>2024-01-05</td><td>v2</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表5错误代码修正表"><strong>表5：错误代码修正表</strong><a href="#表5错误代码修正表" class="hash-link" aria-label="Direct link to 表5错误代码修正表" title="Direct link to 表5错误代码修正表" translate="no">​</a></h3>
<table><thead><tr><th>错误代码</th><th>错误描述</th><th>正确格式</th></tr></thead><tbody><tr><td>ERR001-2024</td><td>系统错误001</td><td>ERR-001-2024</td></tr><tr><td>WARN005-2023</td><td>警告005</td><td>WARN-005-2023</td></tr><tr><td>INFO010-2024</td><td>信息010</td><td>INFO-010-2024</td></tr><tr><td>DEBUG100-2023</td><td>调试100</td><td>DEBUG-100-2023</td></tr><tr><td>FATAL001-2024</td><td>致命错误001</td><td>FATAL-001-2024</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="三基础用法示例"><strong>三、基础用法示例</strong><a href="#三基础用法示例" class="hash-link" aria-label="Direct link to 三基础用法示例" title="Direct link to 三基础用法示例" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-简单替换"><strong>1. 简单替换</strong><a href="#1-简单替换" class="hash-link" aria-label="Direct link to 1-简单替换" title="Direct link to 1-简单替换" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;Hello World&quot;, 7, 5, &quot;Excel&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果：Hello Excel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 从第7个字符开始，替换5个字符（&quot;World&quot;）为&quot;Excel&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;ABCDEFG&quot;, 2, 3, &quot;123&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果：A123FG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 从第2个字符开始，替换3个字符（&quot;BCD&quot;）为&quot;123&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-删除字符"><strong>2. 删除字符</strong><a href="#2-删除字符" class="hash-link" aria-label="Direct link to 2-删除字符" title="Direct link to 2-删除字符" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;Hello World&quot;, 7, 5, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果：Hello </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 从第7个字符开始，删除5个字符（&quot;World&quot;）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;13800138001&quot;, 4, 4, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果：1388001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 删除手机号中间4位</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-插入字符"><strong>3. 插入字符</strong><a href="#3-插入字符" class="hash-link" aria-label="Direct link to 3-插入字符" title="Direct link to 3-插入字符" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;HelloWorld&quot;, 6, 0, &quot; &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果：Hello World</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 在第6个字符后插入空格（num_chars=0表示只插入不删除）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;20240101&quot;, 5, 0, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果：2024-0101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 在日期中插入分隔符</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-替换单元格内容"><strong>4. 替换单元格内容</strong><a href="#4-替换单元格内容" class="hash-link" aria-label="Direct link to 4-替换单元格内容" title="Direct link to 4-替换单元格内容" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表1的D列（修正后编码）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, 5, 0, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;IPHON15PRO&quot; → &quot;IPHON-15PRO&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;HW-P60PRO&quot; → &quot;HW-P60PRO&quot;（不变，已有连字符）</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="四实际应用场景"><strong>四、实际应用场景</strong><a href="#四实际应用场景" class="hash-link" aria-label="Direct link to 四实际应用场景" title="Direct link to 四实际应用场景" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景1产品编码标准化"><strong>场景1：产品编码标准化</strong><a href="#场景1产品编码标准化" class="hash-link" aria-label="Direct link to 场景1产品编码标准化" title="Direct link to 场景1产品编码标准化" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例1iphone编码修正"><strong>示例1：iPhone编码修正</strong><a href="#示例1iphone编码修正" class="hash-link" aria-label="Direct link to 示例1iphone编码修正" title="Direct link to 示例1iphone编码修正" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始：IPHON15PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">问题：缺少连字符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">修正：=REPLACE(REPLACE(A2, 6, 0, &quot;-&quot;), 9, 0, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">分步解析：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 第一次REPLACE：在位置6插入&quot;-&quot; → IPHON-15PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 第二次REPLACE：在位置9插入&quot;-&quot; → IPHON-15-PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：IPHON-15-PRO</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例2华为编码修正"><strong>示例2：华为编码修正</strong><a href="#示例2华为编码修正" class="hash-link" aria-label="Direct link to 示例2华为编码修正" title="Direct link to 示例2华为编码修正" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始：HW-P60PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">问题：型号少连字符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">修正：=REPLACE(A2, 6, 0, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：HW-P60-PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">位置分析：H(1) W(2) -(3) P(4) 6(5) 0(6) P(7) R(8) O(9)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在第6位（&quot;0&quot;后面）插入&quot;-&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景2电话号码格式化"><strong>场景2：电话号码格式化</strong><a href="#场景2电话号码格式化" class="hash-link" aria-label="Direct link to 场景2电话号码格式化" title="Direct link to 场景2电话号码格式化" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例3手机号分段显示"><strong>示例3：手机号分段显示</strong><a href="#示例3手机号分段显示" class="hash-link" aria-label="Direct link to 示例3手机号分段显示" title="Direct link to 示例3手机号分段显示" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表2的D列（格式化号码）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(REPLACE(B2, 8, 0, &quot; &quot;), 4, 0, &quot; &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">分步：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 13800138001 → 138 00138001（在第4位后插入空格）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 138 00138001 → 138 0013 8001（在第8位后插入空格）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：138 0013 8001</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例4添加国际区号"><strong>示例4：添加国际区号</strong><a href="#示例4添加国际区号" class="hash-link" aria-label="Direct link to 示例4添加国际区号" title="Direct link to 示例4添加国际区号" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">为北京号码添加+86：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(B2, 1, 0, &quot;+86 &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">13800138001 → +86 13800138001</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景3数据脱敏处理"><strong>场景3：数据脱敏处理</strong><a href="#场景3数据脱敏处理" class="hash-link" aria-label="Direct link to 场景3数据脱敏处理" title="Direct link to 场景3数据脱敏处理" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例5身份证号脱敏"><strong>示例5：身份证号脱敏</strong><a href="#示例5身份证号脱敏" class="hash-link" aria-label="Direct link to 示例5身份证号脱敏" title="Direct link to 示例5身份证号脱敏" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表3的E列（脱敏后身份证）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(B2, 7, 8, &quot;********&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">110101199003075678 → 110101********5678</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：从第7位开始（出生日期），替换8位为8个星号</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例6邮箱脱敏"><strong>示例6：邮箱脱敏</strong><a href="#示例6邮箱脱敏" class="hash-link" aria-label="Direct link to 示例6邮箱脱敏" title="Direct link to 示例6邮箱脱敏" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">假设A2=&quot;zhangsan@company.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">脱敏用户名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, 4, LEN(LEFT(A2, FIND(&quot;@&quot;, A2)-1))-3, &quot;***&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解析：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. FIND(&quot;@&quot;, A2)-1：用户名的长度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 保留前3位，其余替换为***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：zha***@company.com</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景4文件重命名"><strong>场景4：文件重命名</strong><a href="#场景4文件重命名" class="hash-link" aria-label="Direct link to 场景4文件重命名" title="Direct link to 场景4文件重命名" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例7添加日期前缀"><strong>示例7：添加日期前缀</strong><a href="#示例7添加日期前缀" class="hash-link" aria-label="Direct link to 示例7添加日期前缀" title="Direct link to 示例7添加日期前缀" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表4的E列（新文件名）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, 1, 0, TEXT(C2, &quot;yyyymmdd_&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;report20240101&quot; → &quot;20240101_report20240101&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注意：这会在原文件名前添加日期</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例8标准化文件后缀"><strong>示例8：标准化文件后缀</strong><a href="#示例8标准化文件后缀" class="hash-link" aria-label="Direct link to 示例8标准化文件后缀" title="Direct link to 示例8标准化文件后缀" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">统一添加版本号：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, LEN(A2)+1, 0, &quot;_&quot; &amp; D2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;report20240101&quot; → &quot;report20240101_v1&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="五replace与substitute对比"><strong>五、REPLACE()与SUBSTITUTE()对比</strong><a href="#五replace与substitute对比" class="hash-link" aria-label="Direct link to 五replace与substitute对比" title="Direct link to 五replace与substitute对比" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-功能对比"><strong>1. 功能对比</strong><a href="#1-功能对比" class="hash-link" aria-label="Direct link to 1-功能对比" title="Direct link to 1-功能对比" translate="no">​</a></h3>
<table><thead><tr><th>特性</th><th>REPLACE()</th><th>SUBSTITUTE()</th></tr></thead><tbody><tr><td><strong>替换依据</strong></td><td>位置</td><td>内容</td></tr><tr><td><strong>参数</strong></td><td>4个参数</td><td>3-4个参数</td></tr><tr><td><strong>精确控制</strong></td><td>按位置精确控制</td><td>按内容替换</td></tr><tr><td><strong>批量替换</strong></td><td>一次替换一个位置</td><td>可替换所有匹配项</td></tr><tr><td><strong>插入功能</strong></td><td>支持（num_chars=0）</td><td>不支持</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-语法对比"><strong>2. 语法对比</strong><a href="#2-语法对比" class="hash-link" aria-label="Direct link to 2-语法对比" title="Direct link to 2-语法对比" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">REPLACE: =REPLACE(文本, 开始位置, 字符数, 新文本)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUBSTITUTE: =SUBSTITUTE(文本, 旧文本, 新文本, [替换第几个])</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-应用场景对比"><strong>3. 应用场景对比</strong><a href="#3-应用场景对比" class="hash-link" aria-label="Direct link to 3-应用场景对比" title="Direct link to 3-应用场景对比" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景a修正产品编码"><strong>场景A：修正产品编码</strong><a href="#场景a修正产品编码" class="hash-link" aria-label="Direct link to 场景a修正产品编码" title="Direct link to 场景a修正产品编码" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">用REPLACE（已知位置）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;IPHON15PRO&quot;, 6, 0, &quot;-&quot;)  // IPHON-15PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">用SUBSTITUTE（已知内容）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;IPHON15PRO&quot;, &quot;15&quot;, &quot;-15-&quot;)  // IPHON-15-PRO</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景b删除特定字符"><strong>场景B：删除特定字符</strong><a href="#场景b删除特定字符" class="hash-link" aria-label="Direct link to 场景b删除特定字符" title="Direct link to 场景b删除特定字符" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">用REPLACE删除空格：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(&quot;Hello World&quot;, 6, 1, &quot;&quot;)  // HelloWorld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">用SUBSTITUTE删除所有空格：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;Hello World&quot;, &quot; &quot;, &quot;&quot;)  // HelloWorld</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景c复杂替换"><strong>场景C：复杂替换</strong><a href="#场景c复杂替换" class="hash-link" aria-label="Direct link to 场景c复杂替换" title="Direct link to 场景c复杂替换" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">混合使用：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(REPLACE(A2, 5, 0, &quot;-&quot;), &quot;PRO&quot;, &quot;PRO-MAX&quot;)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="六replace与其他函数组合"><strong>六、REPLACE()与其他函数组合</strong><a href="#六replace与其他函数组合" class="hash-link" aria-label="Direct link to 六replace与其他函数组合" title="Direct link to 六replace与其他函数组合" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合1replace--find动态定位"><strong>组合1：REPLACE + FIND（动态定位）</strong><a href="#组合1replace--find动态定位" class="hash-link" aria-label="Direct link to 组合1replace--find动态定位" title="Direct link to 组合1replace--find动态定位" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例9在特定字符后插入"><strong>示例9：在特定字符后插入</strong><a href="#示例9在特定字符后插入" class="hash-link" aria-label="Direct link to 示例9在特定字符后插入" title="Direct link to 示例9在特定字符后插入" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在第一个&quot;-&quot;后插入&quot;NEW-&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, FIND(&quot;-&quot;, A2)+1, 0, &quot;NEW-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例如：A2=&quot;IPHONE-15PRO&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：IPHONE-NEW-15PRO</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例10替换两个标记之间的内容"><strong>示例10：替换两个标记之间的内容</strong><a href="#示例10替换两个标记之间的内容" class="hash-link" aria-label="Direct link to 示例10替换两个标记之间的内容" title="Direct link to 示例10替换两个标记之间的内容" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">替换[]之间的内容：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_pos, FIND(&quot;[&quot;, text) + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end_pos, FIND(&quot;]&quot;, text),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REPLACE(text, start_pos, end_pos - start_pos, &quot;NEW&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例如：A2=&quot;产品[旧型号]详情&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：产品[NEW]详情</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合2replace--len末尾操作"><strong>组合2：REPLACE + LEN（末尾操作）</strong><a href="#组合2replace--len末尾操作" class="hash-link" aria-label="Direct link to 组合2replace--len末尾操作" title="Direct link to 组合2replace--len末尾操作" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例11在末尾添加文本"><strong>示例11：在末尾添加文本</strong><a href="#示例11在末尾添加文本" class="hash-link" aria-label="Direct link to 示例11在末尾添加文本" title="Direct link to 示例11在末尾添加文本" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在文本末尾添加后缀：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, LEN(A2)+1, 0, &quot;_final&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">等同于：=A2 &amp; &quot;_final&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但REPLACE可以更灵活地控制位置</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例12删除最后n个字符"><strong>示例12：删除最后N个字符</strong><a href="#示例12删除最后n个字符" class="hash-link" aria-label="Direct link to 示例12删除最后n个字符" title="Direct link to 示例12删除最后n个字符" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">删除最后3个字符：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, LEN(A2)-2, 3, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例如：A2=&quot;document_v1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：document_</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合3replace--mid提取并替换"><strong>组合3：REPLACE + MID（提取并替换）</strong><a href="#组合3replace--mid提取并替换" class="hash-link" aria-label="Direct link to 组合3replace--mid提取并替换" title="Direct link to 组合3replace--mid提取并替换" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例13替换部分内容并保留格式"><strong>示例13：替换部分内容并保留格式</strong><a href="#示例13替换部分内容并保留格式" class="hash-link" aria-label="Direct link to 示例13替换部分内容并保留格式" title="Direct link to 示例13替换部分内容并保留格式" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">保留前3位和后4位，中间替换：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LEFT(A2, 3) &amp; &quot;***&quot; &amp; RIGHT(A2, 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">用REPLACE实现：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, 4, LEN(A2)-7, &quot;***&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合4嵌套replace多重替换"><strong>组合4：嵌套REPLACE（多重替换）</strong><a href="#组合4嵌套replace多重替换" class="hash-link" aria-label="Direct link to 组合4嵌套replace多重替换" title="Direct link to 组合4嵌套replace多重替换" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例14多重位置修正"><strong>示例14：多重位置修正</strong><a href="#示例14多重位置修正" class="hash-link" aria-label="Direct link to 示例14多重位置修正" title="Direct link to 示例14多重位置修正" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">修正错误代码格式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(REPLACE(A2, 7, 0, &quot;-&quot;), 4, 0, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例如：A2=&quot;ERR0012024&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">过程：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. ERR001-2024（在第7位插入&quot;-&quot;）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. ERR-001-2024（在第4位插入&quot;-&quot;）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：ERR-001-2024</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="七实际工作场景案例"><strong>七、实际工作场景案例</strong><a href="#七实际工作场景案例" class="hash-link" aria-label="Direct link to 七实际工作场景案例" title="Direct link to 七实际工作场景案例" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例1批量修正产品数据库"><strong>案例1：批量修正产品数据库</strong><a href="#案例1批量修正产品数据库" class="hash-link" aria-label="Direct link to 案例1批量修正产品数据库" title="Direct link to 案例1批量修正产品数据库" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题产品编码格式不一致"><strong>问题</strong>：产品编码格式不一致<a href="#问题产品编码格式不一致" class="hash-link" aria-label="Direct link to 问题产品编码格式不一致" title="Direct link to 问题产品编码格式不一致" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始数据在A列，各种格式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. IPHON15PRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. HW-P60PRO  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. MI13ULTRA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. SN-WH100XM4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">目标：统一为&quot;品牌-型号-规格&quot;格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TRIM(UPPER(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REPLACE(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        REPLACE(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SUBSTITUTE(SUBSTITUTE(A2, &quot; &quot;, &quot;&quot;), &quot;PRO&quot;, &quot;-PRO&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FIND(&quot;-&quot;, SUBSTITUTE(SUBSTITUTE(A2, &quot; &quot;, &quot;&quot;), &quot;PRO&quot;, &quot;-PRO&quot;) &amp; &quot;-&quot;)+1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;-&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MAX(1, FIND(&quot;-&quot;, A2 &amp; &quot;-&quot;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IF(ISNUMBER(FIND(&quot;-&quot;, A2)), &quot;&quot;, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例2客户手机号隐私保护"><strong>案例2：客户手机号隐私保护</strong><a href="#案例2客户手机号隐私保护" class="hash-link" aria-label="Direct link to 案例2客户手机号隐私保护" title="Direct link to 案例2客户手机号隐私保护" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="需求显示手机号但保护隐私"><strong>需求</strong>：显示手机号但保护隐私<a href="#需求显示手机号但保护隐私" class="hash-link" aria-label="Direct link to 需求显示手机号但保护隐私" title="Direct link to 需求显示手机号但保护隐私" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">显示格式：138****8001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(B2, 4, 4, &quot;****&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更智能的版本（处理各种长度）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(B2, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ROUNDUP(LEN(B2)/3, 0), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ROUNDUP(LEN(B2)/3, 0), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         REPT(&quot;*&quot;, ROUNDUP(LEN(B2)/3, 0)))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例3文件版本管理系统"><strong>案例3：文件版本管理系统</strong><a href="#案例3文件版本管理系统" class="hash-link" aria-label="Direct link to 案例3文件版本管理系统" title="Direct link to 案例3文件版本管理系统" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="需求自动更新文件版本号"><strong>需求</strong>：自动更新文件版本号<a href="#需求自动更新文件版本号" class="hash-link" aria-label="Direct link to 需求自动更新文件版本号" title="Direct link to 需求自动更新文件版本号" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始文件名：report_v1.docx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">新版本：report_v2.docx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         FIND(&quot;_v&quot;, A2) + 2, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         FIND(&quot;.&quot;, A2) - FIND(&quot;_v&quot;, A2) - 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         TEXT(--MID(A2, FIND(&quot;_v&quot;, A2)+2, 1)+1, &quot;0&quot;))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例4数据迁移格式转换"><strong>案例4：数据迁移格式转换</strong><a href="#案例4数据迁移格式转换" class="hash-link" aria-label="Direct link to 案例4数据迁移格式转换" title="Direct link to 案例4数据迁移格式转换" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="需求旧系统到新系统的数据转换"><strong>需求</strong>：旧系统到新系统的数据转换<a href="#需求旧系统到新系统的数据转换" class="hash-link" aria-label="Direct link to 需求旧系统到新系统的数据转换" title="Direct link to 需求旧系统到新系统的数据转换" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">旧格式：2024-01-01 14:30:45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">新格式：2024/01/01 14:30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(SUBSTITUTE(LEFT(A2, 10), &quot;-&quot;, &quot;/&quot;), 12, 4, &quot;&quot;)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="八常见问题与解决方案"><strong>八、常见问题与解决方案</strong><a href="#八常见问题与解决方案" class="hash-link" aria-label="Direct link to 八常见问题与解决方案" title="Direct link to 八常见问题与解决方案" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题1位置计算错误"><strong>问题1：位置计算错误</strong><a href="#问题1位置计算错误" class="hash-link" aria-label="Direct link to 问题1位置计算错误" title="Direct link to 问题1位置计算错误" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">错误：=REPLACE(&quot;你好Hello&quot;, 3, 1, &quot;X&quot;)  // 期望替换第一个&quot;l&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">实际上：替换的是&quot;H&quot;，因为中英文混合位置难计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">先统计英文部分位置：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eng_part, MID(text, LENB(text)/2 - LEN(text) + 2, 255),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_part, LEFT(text, LEN(text) - LEN(eng_part)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_part &amp; REPLACE(eng_part, 1, 1, &quot;X&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题2替换后类型变化"><strong>问题2：替换后类型变化</strong><a href="#问题2替换后类型变化" class="hash-link" aria-label="Direct link to 问题2替换后类型变化" title="Direct link to 问题2替换后类型变化" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">现象：替换数字后变成文本，无法计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始：A1=100（数值），替换后=&quot;1X0&quot;（文本）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果需要计算，用VALUE转换：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=VALUE(REPLACE(TEXT(A1, &quot;0&quot;), 2, 1, &quot;X&quot;))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题3处理空值错误"><strong>问题3：处理空值错误</strong><a href="#问题3处理空值错误" class="hash-link" aria-label="Direct link to 问题3处理空值错误" title="Direct link to 问题3处理空值错误" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">错误：=REPLACE(A2, 1, 1, &quot;X&quot;)  // A2为空时错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=IF(LEN(A2)&gt;0, REPLACE(A2, 1, 1, &quot;X&quot;), &quot;X&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题4动态位置不确定"><strong>问题4：动态位置不确定</strong><a href="#问题4动态位置不确定" class="hash-link" aria-label="Direct link to 问题4动态位置不确定" title="Direct link to 问题4动态位置不确定" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">需求：替换第二个&quot;-&quot;后的内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但不同文本&quot;-&quot;数量不同</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_dash, FIND(&quot;-&quot;, text),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    second_dash, FIND(&quot;-&quot;, text, first_dash + 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF(second_dash &gt; 0, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       REPLACE(text, second_dash + 1, 3, &quot;NEW&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="九高级技巧与应用"><strong>九、高级技巧与应用</strong><a href="#九高级技巧与应用" class="hash-link" aria-label="Direct link to 九高级技巧与应用" title="Direct link to 九高级技巧与应用" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧1使用rept生成替换文本"><strong>技巧1：使用REPT生成替换文本</strong><a href="#技巧1使用rept生成替换文本" class="hash-link" aria-label="Direct link to 技巧1使用rept生成替换文本" title="Direct link to 技巧1使用rept生成替换文本" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">用星号替换敏感信息：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(A2, 5, LEN(A2)-8, REPT(&quot;*&quot;, LEN(A2)-8))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例如：A2=&quot;张三的手机号13800138001&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：张三的手机号138****8001</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧2数组公式批量替换"><strong>技巧2：数组公式批量替换</strong><a href="#技巧2数组公式批量替换" class="hash-link" aria-label="Direct link to 技巧2数组公式批量替换" title="Direct link to 技巧2数组公式批量替换" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">批量替换多个位置（旧版数组公式）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{=REPLACE(REPLACE(A2, {5,9}, {0,0}, {&quot;-&quot;,&quot;-&quot;}))}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Excel 365简化版：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REDUCE(A2, {5,9}, LAMBDA(a,b, REPLACE(a, b, 0, &quot;-&quot;)))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧3模式匹配替换"><strong>技巧3：模式匹配替换</strong><a href="#技巧3模式匹配替换" class="hash-link" aria-label="Direct link to 技巧3模式匹配替换" title="Direct link to 技巧3模式匹配替换" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">替换特定模式（如日期格式）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=IF(AND(LEN(A2)=8, ISNUMBER(--A2)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REPLACE(REPLACE(A2, 5, 0, &quot;-&quot;), 8, 0, &quot;-&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">将20240101转为2024-01-01</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧4创建模板填充系统"><strong>技巧4：创建模板填充系统</strong><a href="#技巧4创建模板填充系统" class="hash-link" aria-label="Direct link to 技巧4创建模板填充系统" title="Direct link to 技巧4创建模板填充系统" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">模板：&quot;尊敬的{姓名}，您的订单{订单号}已发货&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">填充：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REPLACE(REPLACE(template, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 FIND(&quot;{姓名}&quot;, template), 3, B2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 FIND(&quot;{订单号}&quot;, template), 4, C2)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧5递归替换复杂数据处理"><strong>技巧5：递归替换（复杂数据处理）</strong><a href="#技巧5递归替换复杂数据处理" class="hash-link" aria-label="Direct link to 技巧5递归替换复杂数据处理" title="Direct link to 技巧5递归替换复杂数据处理" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">使用LAMBDA创建递归替换函数：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LAMBDA(text, patterns,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF(ROWS(patterns)=0, text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pattern, INDEX(patterns, 1, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            replacement, INDEX(patterns, 1, 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new_text, REPLACE(text, pattern, LEN(pattern), replacement),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ReplaceRecursive(new_text, DROP(patterns, 1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十综合实战练习"><strong>十、综合实战练习</strong><a href="#十综合实战练习" class="hash-link" aria-label="Direct link to 十综合实战练习" title="Direct link to 十综合实战练习" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习1产品编码标准化系统"><strong>练习1：产品编码标准化系统</strong><a href="#练习1产品编码标准化系统" class="hash-link" aria-label="Direct link to 练习1产品编码标准化系统" title="Direct link to 练习1产品编码标准化系统" translate="no">​</a></h3>
<p><strong>输入</strong>：混乱的产品编码
<strong>输出</strong>：统一的标准编码</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">编写一个综合处理函数：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code, UPPER(TRIM(A2)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 移除多余空格和大写化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 处理iPhone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code1, IF(LEFT(code, 5)=&quot;IPHON&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             REPLACE(REPLACE(code, 6, 0, &quot;-&quot;), 9, 0, &quot;-&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             code),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 处理华为</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code2, IF(AND(LEFT(code, 2)=&quot;HW&quot;, ISNUMBER(FIND(&quot;-&quot;, code))),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             REPLACE(code, FIND(&quot;-&quot;, code)+4, 0, &quot;-&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             code1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 处理小米</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code3, IF(LEFT(code, 2)=&quot;MI&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             REPLACE(code, 3, 0, &quot;-&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             code2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习2智能电话号码格式化"><strong>练习2：智能电话号码格式化</strong><a href="#练习2智能电话号码格式化" class="hash-link" aria-label="Direct link to 练习2智能电话号码格式化" title="Direct link to 练习2智能电话号码格式化" translate="no">​</a></h3>
<p><strong>需求</strong>：处理各种格式的电话号码</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">输入可能是：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 13800138001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 138-0013-8001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. (86)13800138001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 008613800138001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">输出统一格式：+86 138 0013 8001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phone, SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        A2, &quot;(&quot;, &quot;&quot;), &quot;)&quot;, &quot;&quot;), &quot;-&quot;, &quot;&quot;), &quot; &quot;, &quot;&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 移除所有非数字字符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean_phone, TEXTJOIN(&quot;&quot;, TRUE,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IFERROR(--MID(phone, SEQUENCE(LEN(phone)), 1), &quot;&quot;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 标准化为11位手机号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std_phone, IF(LEN(clean_phone)=13, RIGHT(clean_phone, 11),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 IF(LEN(clean_phone)=11, clean_phone,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    IF(LEN(clean_phone)=10, &quot;1&quot; &amp; clean_phone, clean_phone))),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 格式化输出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF(LEN(std_phone)=11,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;+86 &quot; &amp; REPLACE(REPLACE(std_phone, 8, 0, &quot; &quot;), 4, 0, &quot; &quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;格式错误&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习3数据脱敏报告生成"><strong>练习3：数据脱敏报告生成</strong><a href="#练习3数据脱敏报告生成" class="hash-link" aria-label="Direct link to 练习3数据脱敏报告生成" title="Direct link to 练习3数据脱敏报告生成" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">生成脱敏报告：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始：姓名=张三，身份证=110101199003075678，手机=13800138001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">脱敏：张*，110101********5678，138****8001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">综合公式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id_card, B2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phone, C2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name_masked, REPLACE(name, 2, LEN(name)-1, REPT(&quot;*&quot;, LEN(name)-1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id_masked, REPLACE(id_card, 7, 8, REPT(&quot;*&quot;, 8)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phone_masked, REPLACE(phone, 4, 4, REPT(&quot;*&quot;, 4)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;姓名：&quot; &amp; name_masked &amp; &quot;，身份证：&quot; &amp; id_masked &amp; &quot;，手机：&quot; &amp; phone_masked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十一性能优化建议"><strong>十一、性能优化建议</strong><a href="#十一性能优化建议" class="hash-link" aria-label="Direct link to 十一性能优化建议" title="Direct link to 十一性能优化建议" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-避免多层嵌套"><strong>1. 避免多层嵌套</strong><a href="#1-避免多层嵌套" class="hash-link" aria-label="Direct link to 1-避免多层嵌套" title="Direct link to 1-避免多层嵌套" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">不好：=REPLACE(REPLACE(REPLACE(A2,1,1,&quot;X&quot;),3,1,&quot;Y&quot;),5,1,&quot;Z&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">好：使用LET存储中间结果</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-使用辅助列"><strong>2. 使用辅助列</strong><a href="#2-使用辅助列" class="hash-link" aria-label="Direct link to 2-使用辅助列" title="Direct link to 2-使用辅助列" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">复杂替换分步骤进行：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B列：=SUBSTITUTE(A2, &quot;旧&quot;, &quot;新&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C列：=REPLACE(B2, 5, 0, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D列：最终结果</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-批量处理时考虑效率"><strong>3. 批量处理时考虑效率</strong><a href="#3-批量处理时考虑效率" class="hash-link" aria-label="Direct link to 3-批量处理时考虑效率" title="Direct link to 3-批量处理时考虑效率" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">大数据量时：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 先筛选出需要处理的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 使用数组公式或Power Query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 避免在条件格式中直接使用复杂REPLACE</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-使用新函数excel-365"><strong>4. 使用新函数（Excel 365）</strong><a href="#4-使用新函数excel-365" class="hash-link" aria-label="Direct link to 4-使用新函数excel-365" title="Direct link to 4-使用新函数excel-365" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Excel 365中可以使用：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TEXTBEFORE(A2, &quot;-&quot;) &amp; &quot;-NEW-&quot; &amp; TEXTAFTER(A2, &quot;-&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更易读，性能更好</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十二版本兼容性"><strong>十二、版本兼容性</strong><a href="#十二版本兼容性" class="hash-link" aria-label="Direct link to 十二版本兼容性" title="Direct link to 十二版本兼容性" translate="no">​</a></h2>
<table><thead><tr><th>Excel版本</th><th>REPLACE()</th><th>相关新函数</th></tr></thead><tbody><tr><td>2003及以前</td><td>✓</td><td>✗</td></tr><tr><td>2007-2013</td><td>✓</td><td>✗</td></tr><tr><td>2016-2019</td><td>✓</td><td>✗</td></tr><tr><td>365</td><td>✓</td><td>TEXTBEFORE/TEXTAFTER</td></tr></tbody></table>
<p><strong>最佳实践</strong>：</p>
<ul>
<li class="">REPLACE()全版本兼容，可放心使用</li>
<li class="">新版本可考虑使用更直观的新函数</li>
<li class="">复杂需求可混合使用</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十三总结与记忆技巧"><strong>十三、总结与记忆技巧</strong><a href="#十三总结与记忆技巧" class="hash-link" aria-label="Direct link to 十三总结与记忆技巧" title="Direct link to 十三总结与记忆技巧" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="replace核心要点"><strong>REPLACE()核心要点</strong><a href="#replace核心要点" class="hash-link" aria-label="Direct link to replace核心要点" title="Direct link to replace核心要点" translate="no">​</a></h3>
<ol>
<li class=""><strong>按位置操作</strong>：精准控制替换位置</li>
<li class=""><strong>四参数模式</strong>：老文本、起始位、字符数、新文本</li>
<li class=""><strong>灵活多变</strong>：可删除、插入、替换</li>
<li class=""><strong>文本处理利器</strong>：数据清洗、格式转换必备</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="参数记忆口诀"><strong>参数记忆口诀</strong><a href="#参数记忆口诀" class="hash-link" aria-label="Direct link to 参数记忆口诀" title="Direct link to 参数记忆口诀" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">REPLACE四兄弟，各司其职不忘记：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">老大要改谁（old_text），老二从哪起（start_num），</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">老三改几个（num_chars），老四新东西（new_text）。</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="使用场景总结"><strong>使用场景总结</strong><a href="#使用场景总结" class="hash-link" aria-label="Direct link to 使用场景总结" title="Direct link to 使用场景总结" translate="no">​</a></h3>
<table><thead><tr><th>场景</th><th>REPLACE适用性</th><th>技巧</th></tr></thead><tbody><tr><td><strong>固定位置替换</strong></td><td>★★★★★</td><td>直接使用</td></tr><tr><td><strong>动态位置替换</strong></td><td>★★★★☆</td><td>结合FIND</td></tr><tr><td><strong>数据脱敏</strong></td><td>★★★★★</td><td>结合REPT</td></tr><tr><td><strong>格式标准化</strong></td><td>★★★★☆</td><td>嵌套使用</td></tr><tr><td><strong>批量处理</strong></td><td>★★★☆☆</td><td>考虑其他工具</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="常见错误避免"><strong>常见错误避免</strong><a href="#常见错误避免" class="hash-link" aria-label="Direct link to 常见错误避免" title="Direct link to 常见错误避免" translate="no">​</a></h3>
<ol>
<li class=""><strong>位置从1开始</strong>：不是从0开始</li>
<li class=""><strong>中英文混合</strong>：注意字符位置计算</li>
<li class=""><strong>空值处理</strong>：先检查LEN()</li>
<li class=""><strong>类型转换</strong>：数值替换后变文本</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="一句话总结"><strong>一句话总结</strong><a href="#一句话总结" class="hash-link" aria-label="Direct link to 一句话总结" title="Direct link to 一句话总结" translate="no">​</a></h3>
<p><strong>REPLACE()函数是Excel的&quot;文本外科医生&quot;——能精准地在指定位置进行字符的&quot;切除&quot;、&quot;移植&quot;和&quot;整形&quot;手术！</strong></p>
<hr>
<p>掌握REPLACE()函数，你就能精准控制文本的每一个字符。记住：<strong>知道在哪改，比知道改什么更重要</strong>！</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/office/excel/proj2/replace.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一replace函数基础" class="table-of-contents__link toc-highlight"><strong>一、REPLACE()函数基础</strong></a><ul><li><a href="#1-函数语法" class="table-of-contents__link toc-highlight"><strong>1. 函数语法</strong></a></li><li><a href="#2-参数详解" class="table-of-contents__link toc-highlight"><strong>2. 参数详解</strong></a></li><li><a href="#3-重要特性" class="table-of-contents__link toc-highlight"><strong>3. 重要特性</strong></a></li></ul></li><li><a href="#二详细示例数据表" class="table-of-contents__link toc-highlight"><strong>二、详细示例数据表</strong></a><ul><li><a href="#表1产品编码修正表" class="table-of-contents__link toc-highlight"><strong>表1：产品编码修正表</strong></a></li><li><a href="#表2电话号码格式化表" class="table-of-contents__link toc-highlight"><strong>表2：电话号码格式化表</strong></a></li><li><a href="#表3身份证号脱敏表" class="table-of-contents__link toc-highlight"><strong>表3：身份证号脱敏表</strong></a></li><li><a href="#表4文件重命名表" class="table-of-contents__link toc-highlight"><strong>表4：文件重命名表</strong></a></li><li><a href="#表5错误代码修正表" class="table-of-contents__link toc-highlight"><strong>表5：错误代码修正表</strong></a></li></ul></li><li><a href="#三基础用法示例" class="table-of-contents__link toc-highlight"><strong>三、基础用法示例</strong></a><ul><li><a href="#1-简单替换" class="table-of-contents__link toc-highlight"><strong>1. 简单替换</strong></a></li><li><a href="#2-删除字符" class="table-of-contents__link toc-highlight"><strong>2. 删除字符</strong></a></li><li><a href="#3-插入字符" class="table-of-contents__link toc-highlight"><strong>3. 插入字符</strong></a></li><li><a href="#4-替换单元格内容" class="table-of-contents__link toc-highlight"><strong>4. 替换单元格内容</strong></a></li></ul></li><li><a href="#四实际应用场景" class="table-of-contents__link toc-highlight"><strong>四、实际应用场景</strong></a><ul><li><a href="#场景1产品编码标准化" class="table-of-contents__link toc-highlight"><strong>场景1：产品编码标准化</strong></a></li><li><a href="#场景2电话号码格式化" class="table-of-contents__link toc-highlight"><strong>场景2：电话号码格式化</strong></a></li><li><a href="#场景3数据脱敏处理" class="table-of-contents__link toc-highlight"><strong>场景3：数据脱敏处理</strong></a></li><li><a href="#场景4文件重命名" class="table-of-contents__link toc-highlight"><strong>场景4：文件重命名</strong></a></li></ul></li><li><a href="#五replace与substitute对比" class="table-of-contents__link toc-highlight"><strong>五、REPLACE()与SUBSTITUTE()对比</strong></a><ul><li><a href="#1-功能对比" class="table-of-contents__link toc-highlight"><strong>1. 功能对比</strong></a></li><li><a href="#2-语法对比" class="table-of-contents__link toc-highlight"><strong>2. 语法对比</strong></a></li><li><a href="#3-应用场景对比" class="table-of-contents__link toc-highlight"><strong>3. 应用场景对比</strong></a></li></ul></li><li><a href="#六replace与其他函数组合" class="table-of-contents__link toc-highlight"><strong>六、REPLACE()与其他函数组合</strong></a><ul><li><a href="#组合1replace--find动态定位" class="table-of-contents__link toc-highlight"><strong>组合1：REPLACE + FIND（动态定位）</strong></a></li><li><a href="#组合2replace--len末尾操作" class="table-of-contents__link toc-highlight"><strong>组合2：REPLACE + LEN（末尾操作）</strong></a></li><li><a href="#组合3replace--mid提取并替换" class="table-of-contents__link toc-highlight"><strong>组合3：REPLACE + MID（提取并替换）</strong></a></li><li><a href="#组合4嵌套replace多重替换" class="table-of-contents__link toc-highlight"><strong>组合4：嵌套REPLACE（多重替换）</strong></a></li></ul></li><li><a href="#七实际工作场景案例" class="table-of-contents__link toc-highlight"><strong>七、实际工作场景案例</strong></a><ul><li><a href="#案例1批量修正产品数据库" class="table-of-contents__link toc-highlight"><strong>案例1：批量修正产品数据库</strong></a></li><li><a href="#案例2客户手机号隐私保护" class="table-of-contents__link toc-highlight"><strong>案例2：客户手机号隐私保护</strong></a></li><li><a href="#案例3文件版本管理系统" class="table-of-contents__link toc-highlight"><strong>案例3：文件版本管理系统</strong></a></li><li><a href="#案例4数据迁移格式转换" class="table-of-contents__link toc-highlight"><strong>案例4：数据迁移格式转换</strong></a></li></ul></li><li><a href="#八常见问题与解决方案" class="table-of-contents__link toc-highlight"><strong>八、常见问题与解决方案</strong></a><ul><li><a href="#问题1位置计算错误" class="table-of-contents__link toc-highlight"><strong>问题1：位置计算错误</strong></a></li><li><a href="#问题2替换后类型变化" class="table-of-contents__link toc-highlight"><strong>问题2：替换后类型变化</strong></a></li><li><a href="#问题3处理空值错误" class="table-of-contents__link toc-highlight"><strong>问题3：处理空值错误</strong></a></li><li><a href="#问题4动态位置不确定" class="table-of-contents__link toc-highlight"><strong>问题4：动态位置不确定</strong></a></li></ul></li><li><a href="#九高级技巧与应用" class="table-of-contents__link toc-highlight"><strong>九、高级技巧与应用</strong></a><ul><li><a href="#技巧1使用rept生成替换文本" class="table-of-contents__link toc-highlight"><strong>技巧1：使用REPT生成替换文本</strong></a></li><li><a href="#技巧2数组公式批量替换" class="table-of-contents__link toc-highlight"><strong>技巧2：数组公式批量替换</strong></a></li><li><a href="#技巧3模式匹配替换" class="table-of-contents__link toc-highlight"><strong>技巧3：模式匹配替换</strong></a></li><li><a href="#技巧4创建模板填充系统" class="table-of-contents__link toc-highlight"><strong>技巧4：创建模板填充系统</strong></a></li><li><a href="#技巧5递归替换复杂数据处理" class="table-of-contents__link toc-highlight"><strong>技巧5：递归替换（复杂数据处理）</strong></a></li></ul></li><li><a href="#十综合实战练习" class="table-of-contents__link toc-highlight"><strong>十、综合实战练习</strong></a><ul><li><a href="#练习1产品编码标准化系统" class="table-of-contents__link toc-highlight"><strong>练习1：产品编码标准化系统</strong></a></li><li><a href="#练习2智能电话号码格式化" class="table-of-contents__link toc-highlight"><strong>练习2：智能电话号码格式化</strong></a></li><li><a href="#练习3数据脱敏报告生成" class="table-of-contents__link toc-highlight"><strong>练习3：数据脱敏报告生成</strong></a></li></ul></li><li><a href="#十一性能优化建议" class="table-of-contents__link toc-highlight"><strong>十一、性能优化建议</strong></a><ul><li><a href="#1-避免多层嵌套" class="table-of-contents__link toc-highlight"><strong>1. 避免多层嵌套</strong></a></li><li><a href="#2-使用辅助列" class="table-of-contents__link toc-highlight"><strong>2. 使用辅助列</strong></a></li><li><a href="#3-批量处理时考虑效率" class="table-of-contents__link toc-highlight"><strong>3. 批量处理时考虑效率</strong></a></li><li><a href="#4-使用新函数excel-365" class="table-of-contents__link toc-highlight"><strong>4. 使用新函数（Excel 365）</strong></a></li></ul></li><li><a href="#十二版本兼容性" class="table-of-contents__link toc-highlight"><strong>十二、版本兼容性</strong></a></li><li><a href="#十三总结与记忆技巧" class="table-of-contents__link toc-highlight"><strong>十三、总结与记忆技巧</strong></a><ul><li><a href="#replace核心要点" class="table-of-contents__link toc-highlight"><strong>REPLACE()核心要点</strong></a></li><li><a href="#参数记忆口诀" class="table-of-contents__link toc-highlight"><strong>参数记忆口诀</strong></a></li><li><a href="#使用场景总结" class="table-of-contents__link toc-highlight"><strong>使用场景总结</strong></a></li><li><a href="#常见错误避免" class="table-of-contents__link toc-highlight"><strong>常见错误避免</strong></a></li><li><a href="#一句话总结" class="table-of-contents__link toc-highlight"><strong>一句话总结</strong></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>