<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-office/excel/proj2/substitute" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">substitute | 河北对口高考计算机专业</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://buhaoqi.github.io/img/logo-orange-social.png"><meta data-rh="true" name="twitter:image" content="https://buhaoqi.github.io/img/logo-orange-social.png"><meta data-rh="true" property="og:url" content="https://buhaoqi.github.io/docs/office/excel/proj2/substitute"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="substitute | 河北对口高考计算机专业"><meta data-rh="true" name="description" content="Excel SUBSTITUTE()函数详解：智能文本替换专家"><meta data-rh="true" property="og:description" content="Excel SUBSTITUTE()函数详解：智能文本替换专家"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://buhaoqi.github.io/docs/office/excel/proj2/substitute"><link data-rh="true" rel="alternate" href="https://buhaoqi.github.io/docs/office/excel/proj2/substitute" hreflang="en"><link data-rh="true" rel="alternate" href="https://buhaoqi.github.io/docs/office/excel/proj2/substitute" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="河北对口高考计算机专业 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="河北对口高考计算机专业 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.761b036b.css">
<script src="/assets/js/runtime~main.eac8a2a3.js" defer="defer"></script>
<script src="/assets/js/main.3bcaae73.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="不好奇 Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="不好奇 Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" docid="csharp/intro" href="/docs/csharp/intro">算法与程序设计</a><a class="navbar__item navbar__link" docid="mysql/intro" href="/docs/mysql/intro">MySQL教程</a><a class="navbar__item navbar__link" href="/docs/bookmarks/intro">网址导航</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://buhaoqi.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-external-link">不好奇课堂<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>substitute</h1></header><p>Excel SUBSTITUTE()函数详解：智能文本替换专家</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="一substitute函数基础"><strong>一、SUBSTITUTE()函数基础</strong><a href="#一substitute函数基础" class="hash-link" aria-label="Direct link to 一substitute函数基础" title="Direct link to 一substitute函数基础" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-函数语法"><strong>1. 函数语法</strong><a href="#1-函数语法" class="hash-link" aria-label="Direct link to 1-函数语法" title="Direct link to 1-函数语法" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(text, old_text, new_text, [instance_num])</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-参数详解"><strong>2. 参数详解</strong><a href="#2-参数详解" class="hash-link" aria-label="Direct link to 2-参数详解" title="Direct link to 2-参数详解" translate="no">​</a></h3>
<table><thead><tr><th>参数</th><th>说明</th><th>必需</th></tr></thead><tbody><tr><td><strong>text</strong></td><td>原始文本</td><td>是</td></tr><tr><td><strong>old_text</strong></td><td>要被替换的旧文本</td><td>是</td></tr><tr><td><strong>new_text</strong></td><td>要替换成的新文本</td><td>是</td></tr><tr><td><strong>instance_num</strong></td><td>替换第几次出现的旧文本（可选）</td><td>否</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-重要特性"><strong>3. 重要特性</strong><a href="#3-重要特性" class="hash-link" aria-label="Direct link to 3-重要特性" title="Direct link to 3-重要特性" translate="no">​</a></h3>
<ul>
<li class="">返回<strong>文本</strong>类型</li>
<li class="">按<strong>内容</strong>替换，不是按位置</li>
<li class="">区分<strong>大小写</strong></li>
<li class="">可以指定替换<strong>第几次出现</strong></li>
<li class="">支持<strong>嵌套使用</strong></li>
<li class="">对中英文、数字、符号都有效</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="二详细示例数据表"><strong>二、详细示例数据表</strong><a href="#二详细示例数据表" class="hash-link" aria-label="Direct link to 二详细示例数据表" title="Direct link to 二详细示例数据表" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表1产品名称统一表"><strong>表1：产品名称统一表</strong><a href="#表1产品名称统一表" class="hash-link" aria-label="Direct link to 表1产品名称统一表" title="Direct link to 表1产品名称统一表" translate="no">​</a></h3>
<table><thead><tr><th>产品ID</th><th>原始名称</th><th>品牌</th><th>型号</th><th>问题描述</th></tr></thead><tbody><tr><td>P001</td><td>iphone 15 pro max</td><td>Apple</td><td>iPhone 15</td><td>大小写不统一</td></tr><tr><td>P002</td><td>华为 P60 Pro</td><td>Huawei</td><td>P60</td><td>空格不一致</td></tr><tr><td>P003</td><td>三星Galaxy S23 Ultra</td><td>Samsung</td><td>S23</td><td>缺少空格</td></tr><tr><td>P004</td><td>小米-13-ultra</td><td>Xiaomi</td><td>13</td><td>使用短横线</td></tr><tr><td>P005</td><td>SONY WH-1000XM5</td><td>Sony</td><td>WH-1000XM5</td><td>品牌全大写</td></tr><tr><td>P006</td><td>apple macbook pro m2</td><td>Apple</td><td>MacBook Pro</td><td>全小写</td></tr><tr><td>P007</td><td>华为 Mate 60 Pro+</td><td>Huawei</td><td>Mate 60</td><td>有特殊字符</td></tr><tr><td>P008</td><td>OPPO Find X6 Pro</td><td>OPPO</td><td>Find X6</td><td>正常</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表2客户联系信息表"><strong>表2：客户联系信息表</strong><a href="#表2客户联系信息表" class="hash-link" aria-label="Direct link to 表2客户联系信息表" title="Direct link to 表2客户联系信息表" translate="no">​</a></h3>
<table><thead><tr><th>客户ID</th><th>客户姓名</th><th>联系电话</th><th>邮箱</th><th>备注</th></tr></thead><tbody><tr><td>C001</td><td>张 明</td><td>138-0013-8001</td><td><a href="mailto:zhang.ming@company.com" target="_blank" rel="noopener noreferrer" class="">zhang.ming@company.com</a></td><td>VIP客户</td></tr><tr><td>C002</td><td>李 华</td><td>139 1234 5678</td><td><a href="mailto:li.hua@company.com" target="_blank" rel="noopener noreferrer" class="">li.hua@company.com</a></td><td>新客户</td></tr><tr><td>C003</td><td>王 芳</td><td>(010)8765-4321</td><td><a href="mailto:wang.fang@company.com" target="_blank" rel="noopener noreferrer" class="">wang.fang@company.com</a></td><td>长期合作</td></tr><tr><td>C004</td><td>赵 强</td><td>13755556666</td><td><a href="mailto:zhao.qiang@company.com" target="_blank" rel="noopener noreferrer" class="">zhao.qiang@company.com</a></td><td>紧急订单</td></tr><tr><td>C005</td><td>孙 丽</td><td>136-7890-1234</td><td><a href="mailto:sun.li@company.com" target="_blank" rel="noopener noreferrer" class="">sun.li@company.com</a></td><td>普通客户</td></tr><tr><td>C006</td><td>周 伟</td><td>135 1234 1234</td><td><a href="mailto:zhou.wei@company.com" target="_blank" rel="noopener noreferrer" class="">zhou.wei@company.com</a></td><td>需跟进</td></tr><tr><td>C007</td><td>吴 刚</td><td>134-0000-0000</td><td><a href="mailto:wu.gang@company.com" target="_blank" rel="noopener noreferrer" class="">wu.gang@company.com</a></td><td>已流失</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表3文章关键词替换表"><strong>表3：文章关键词替换表</strong><a href="#表3文章关键词替换表" class="hash-link" aria-label="Direct link to 表3文章关键词替换表" title="Direct link to 表3文章关键词替换表" translate="no">​</a></h3>
<table><thead><tr><th>文章ID</th><th>原标题</th><th>关键词</th><th>替换要求</th><th>新关键词</th></tr></thead><tbody><tr><td>A001</td><td>AI人工智能发展报告</td><td>AI</td><td>替换为&quot;人工智能&quot;</td><td>人工智能</td></tr><tr><td>A002</td><td>5G技术应用分析</td><td>5G</td><td>替换为&quot;第五代移动通信&quot;</td><td>第五代移动通信</td></tr><tr><td>A003</td><td>COVID-19疫情影响研究</td><td>COVID-19</td><td>替换为&quot;新冠病毒&quot;</td><td>新冠病毒</td></tr><tr><td>A004</td><td>ESG投资策略指南</td><td>ESG</td><td>替换为&quot;环境社会治理&quot;</td><td>环境社会治理</td></tr><tr><td>A005</td><td>IoT智能家居方案</td><td>IoT</td><td>替换为&quot;物联网&quot;</td><td>物联网</td></tr><tr><td>A006</td><td>VR虚拟现实体验报告</td><td>VR</td><td>替换为&quot;虚拟现实&quot;</td><td>虚拟现实</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表4数据清洗示例表"><strong>表4：数据清洗示例表</strong><a href="#表4数据清洗示例表" class="hash-link" aria-label="Direct link to 表4数据清洗示例表" title="Direct link to 表4数据清洗示例表" translate="no">​</a></h3>
<table><thead><tr><th>原始数据</th><th>数据类型</th><th>清洗要求</th><th>期望结果</th></tr></thead><tbody><tr><td>1,234.56</td><td>金额</td><td>去掉千分符</td><td>1234.56</td></tr><tr><td>2023-12-25 14:30:00</td><td>日期时间</td><td>去掉时间部分</td><td>2023-12-25</td></tr><tr><td>abc-def-ghi</td><td>编码</td><td>去掉所有短横线</td><td>abcdefghi</td></tr><tr><td>姓名：张三，年龄：25</td><td>文本</td><td>去掉所有标点</td><td>姓名张三年龄25</td></tr><tr><td>hello world</td><td>文本</td><td>替换空格为下划线</td><td>hello_world</td></tr><tr><td>ABC123DEF456</td><td>混合</td><td>去掉所有数字</td><td>ABCDEF</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="表5多语言文本处理表"><strong>表5：多语言文本处理表</strong><a href="#表5多语言文本处理表" class="hash-link" aria-label="Direct link to 表5多语言文本处理表" title="Direct link to 表5多语言文本处理表" translate="no">​</a></h3>
<table><thead><tr><th>文本内容</th><th>语言</th><th>需要替换的内容</th><th>替换为</th></tr></thead><tbody><tr><td>I love apple.</td><td>英文</td><td>apple</td><td>Apple</td></tr><tr><td>这是一个test测试。</td><td>中英混合</td><td>test</td><td>测试</td></tr><tr><td>Hello, world!</td><td>英文</td><td>world</td><td>World</td></tr><tr><td>Excel 2023 → Excel 2024</td><td>混合</td><td>2023</td><td>2024</td></tr><tr><td>a+b=c</td><td>数学公式</td><td>+</td><td>加</td></tr><tr><td><a href="http://www.example.com" target="_blank" rel="noopener noreferrer" class="">www.example.com</a></td><td>URL</td><td>www</td><td><a href="https://www" target="_blank" rel="noopener noreferrer" class="">https://www</a></td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="三基础用法示例"><strong>三、基础用法示例</strong><a href="#三基础用法示例" class="hash-link" aria-label="Direct link to 三基础用法示例" title="Direct link to 三基础用法示例" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-简单替换"><strong>1. 简单替换</strong><a href="#1-简单替换" class="hash-link" aria-label="Direct link to 1-简单替换" title="Direct link to 1-简单替换" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;Hello World&quot;, &quot;World&quot;, &quot;Excel&quot;)  // &quot;Hello Excel&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：将&quot;World&quot;替换为&quot;Excel&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;2023年报告&quot;, &quot;2023&quot;, &quot;2024&quot;)     // &quot;2024年报告&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：将&quot;2023&quot;替换为&quot;2024&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;你好世界&quot;, &quot;世界&quot;, &quot;中国&quot;)      // &quot;你好中国&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：将&quot;世界&quot;替换为&quot;中国&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-实际应用示例"><strong>2. 实际应用示例</strong><a href="#2-实际应用示例" class="hash-link" aria-label="Direct link to 2-实际应用示例" title="Direct link to 2-实际应用示例" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例1统一产品名称大小写"><strong>示例1：统一产品名称大小写</strong><a href="#示例1统一产品名称大小写" class="hash-link" aria-label="Direct link to 示例1统一产品名称大小写" title="Direct link to 示例1统一产品名称大小写" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表1的F列（标准化名称）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=PROPER(SUBSTITUTE(LOWER(B2), &quot;iphone&quot;, &quot;iPhone&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">分解步骤：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. LOWER(B2)：转为全小写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. SUBSTITUTE(..., &quot;iphone&quot;, &quot;iPhone&quot;)：替换为正确大小写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. PROPER(...)：每个单词首字母大写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;iphone 15 pro max&quot; → &quot;iPhone 15 Pro Max&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;apple macbook pro m2&quot; → &quot;Apple Macbook Pro M2&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例2清理电话号码格式"><strong>示例2：清理电话号码格式</strong><a href="#示例2清理电话号码格式" class="hash-link" aria-label="Direct link to 示例2清理电话号码格式" title="Direct link to 示例2清理电话号码格式" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表2的E列（统一格式电话）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(C2, &quot; &quot;, &quot;&quot;), &quot;-&quot;, &quot;&quot;), &quot;(&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">分解：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. SUBSTITUTE(C2, &quot; &quot;, &quot;&quot;)：去掉空格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. SUBSTITUTE(..., &quot;-&quot;, &quot;&quot;)：去掉短横线</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. SUBSTITUTE(..., &quot;(&quot;, &quot;&quot;)：去掉左括号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更完整：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(C2, &quot; &quot;, &quot;&quot;), &quot;-&quot;, &quot;&quot;), &quot;(&quot;, &quot;&quot;), &quot;)&quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例3文章关键词替换"><strong>示例3：文章关键词替换</strong><a href="#示例3文章关键词替换" class="hash-link" aria-label="Direct link to 示例3文章关键词替换" title="Direct link to 示例3文章关键词替换" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表3的F列（新标题）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(B2, C2, E2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;AI人工智能发展报告&quot; → &quot;人工智能人工智能发展报告&quot; ❌</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">问题：AI是&quot;人工智能&quot;的缩写，替换后重复</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进：只替换独立的AI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot; &quot; &amp; B2 &amp; &quot; &quot;, &quot; AI &quot;, &quot; 人工智能 &quot;)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="四指定替换次数instance_num参数"><strong>四、指定替换次数（instance_num参数）</strong><a href="#四指定替换次数instance_num参数" class="hash-link" aria-label="Direct link to 四指定替换次数instance_num参数" title="Direct link to 四指定替换次数instance_num参数" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-替换第n次出现"><strong>1. 替换第N次出现</strong><a href="#1-替换第n次出现" class="hash-link" aria-label="Direct link to 1-替换第n次出现" title="Direct link to 1-替换第n次出现" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;A-B-C-D&quot;, &quot;-&quot;, &quot;|&quot;, 2)  // &quot;A-B|C-D&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：只替换第2次出现的&quot;-&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;苹果,苹果,苹果&quot;, &quot;苹果&quot;, &quot;香蕉&quot;, 2)  // &quot;苹果,香蕉,苹果&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：只替换第2次出现的&quot;苹果&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-实际应用示例-1"><strong>2. 实际应用示例</strong><a href="#2-实际应用示例-1" class="hash-link" aria-label="Direct link to 2-实际应用示例-1" title="Direct link to 2-实际应用示例-1" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例4只替换最后一个分隔符"><strong>示例4：只替换最后一个分隔符</strong><a href="#示例4只替换最后一个分隔符" class="hash-link" aria-label="Direct link to 示例4只替换最后一个分隔符" title="Direct link to 示例4只替换最后一个分隔符" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：A2=&quot;A-B-C-D-E&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">替换最后一个&quot;-&quot;为&quot;|&quot;：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;-&quot;, &quot;|&quot;, LEN(A2)-LEN(SUBSTITUTE(A2, &quot;-&quot;, &quot;&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LEN(A2)-LEN(SUBSTITUTE(A2, &quot;-&quot;, &quot;&quot;))：计算&quot;-&quot;出现的次数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：&quot;A-B-C-D|E&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例5处理多级分类"><strong>示例5：处理多级分类</strong><a href="#示例5处理多级分类" class="hash-link" aria-label="Direct link to 示例5处理多级分类" title="Direct link to 示例5处理多级分类" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：A2=&quot;电子产品&gt;手机&gt;苹果&gt;iPhone&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">只替换第二级分隔符：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;&gt;&quot;, &quot; - &quot;, 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：&quot;电子产品&gt;手机 - 苹果&gt;iPhone&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例6替换特定位置的文本"><strong>示例6：替换特定位置的文本</strong><a href="#示例6替换特定位置的文本" class="hash-link" aria-label="Direct link to 示例6替换特定位置的文本" title="Direct link to 示例6替换特定位置的文本" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">数据：A2=&quot;项目A,项目B,项目C,项目D&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">只替换第三个项目：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;项目&quot;, &quot;任务&quot;, 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：&quot;项目A,项目B,任务C,项目D&quot; ❌</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这会把&quot;项目C&quot;中的&quot;项目&quot;替换，而不是第三个逗号前的&quot;项目&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">正确做法：先拆分再替换</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="五substitute的三种特殊用法"><strong>五、SUBSTITUTE()的三种特殊用法</strong><a href="#五substitute的三种特殊用法" class="hash-link" aria-label="Direct link to 五substitute的三种特殊用法" title="Direct link to 五substitute的三种特殊用法" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-删除字符new_text--"><strong>1. 删除字符（new_text = &quot;&quot;）</strong><a href="#1-删除字符new_text--" class="hash-link" aria-label="Direct link to 1-删除字符new_text--" title="Direct link to 1-删除字符new_text--" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">删除所有空格：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot; &quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">删除所有短横线：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;-&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">删除特定单词：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;有限公司&quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-插入字符替换空字符"><strong>2. 插入字符（替换空字符）</strong><a href="#2-插入字符替换空字符" class="hash-link" aria-label="Direct link to 2-插入字符替换空字符" title="Direct link to 2-插入字符替换空字符" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在特定字符后插入：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;@&quot;, &quot;@company.&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但不能直接插入，因为空字符无法作为old_text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">替代方案：使用REPLACE或&amp;连接</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-计数功能间接使用"><strong>3. 计数功能（间接使用）</strong><a href="#3-计数功能间接使用" class="hash-link" aria-label="Direct link to 3-计数功能间接使用" title="Direct link to 3-计数功能间接使用" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">统计某个字符出现的次数：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LEN(A2) - LEN(SUBSTITUTE(A2, &quot;A&quot;, &quot;&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原理：原长度 - 去掉&quot;A&quot;后的长度 = &quot;A&quot;出现的次数</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="六实际工作场景应用"><strong>六、实际工作场景应用</strong><a href="#六实际工作场景应用" class="hash-link" aria-label="Direct link to 六实际工作场景应用" title="Direct link to 六实际工作场景应用" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景1数据清洗标准化"><strong>场景1：数据清洗标准化</strong><a href="#场景1数据清洗标准化" class="hash-link" aria-label="Direct link to 场景1数据清洗标准化" title="Direct link to 场景1数据清洗标准化" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例1批量清理电话号码"><strong>案例1：批量清理电话号码</strong><a href="#案例1批量清理电话号码" class="hash-link" aria-label="Direct link to 案例1批量清理电话号码" title="Direct link to 案例1批量清理电话号码" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在表2的F列（纯净电话）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SUBSTITUTE(C2, &quot; &quot;, &quot;&quot;), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;-&quot;, &quot;&quot;), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;(&quot;, &quot;&quot;), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;)&quot;, &quot;&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;+86&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">简化版（用TRIM和CLEAN先处理）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(TRIM(CLEAN(C2)), &quot;-&quot;, &quot;&quot;), &quot; &quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例2统一金额格式"><strong>案例2：统一金额格式</strong><a href="#案例2统一金额格式" class="hash-link" aria-label="Direct link to 案例2统一金额格式" title="Direct link to 案例2统一金额格式" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">清理千分符和货币符号：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始：A2=&quot;$1,234.56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">清理：=SUBSTITUTE(SUBSTITUTE(A2, &quot;$&quot;, &quot;&quot;), &quot;,&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：&quot;1234.56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">转为数值：=--SUBSTITUTE(SUBSTITUTE(A2, &quot;$&quot;, &quot;&quot;), &quot;,&quot;, &quot;&quot;)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例3清理文件路径"><strong>案例3：清理文件路径</strong><a href="#案例3清理文件路径" class="hash-link" aria-label="Direct link to 案例3清理文件路径" title="Direct link to 案例3清理文件路径" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Windows路径转统一格式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始：A2=&quot;C:\Users\Admin\Documents\报告.docx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">标准化：=SUBSTITUTE(A2, &quot;\&quot;, &quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">或者提取文件名：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=MID(A2, FIND(&quot;@&quot;, SUBSTITUTE(A2, &quot;\&quot;, &quot;@&quot;, LEN(A2)-LEN(SUBSTITUTE(A2, &quot;\&quot;, &quot;&quot;))))+1, 100)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景2文本内容替换"><strong>场景2：文本内容替换</strong><a href="#场景2文本内容替换" class="hash-link" aria-label="Direct link to 场景2文本内容替换" title="Direct link to 场景2文本内容替换" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例4批量替换文章关键词"><strong>案例4：批量替换文章关键词</strong><a href="#案例4批量替换文章关键词" class="hash-link" aria-label="Direct link to 案例4批量替换文章关键词" title="Direct link to 案例4批量替换文章关键词" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">批量替换多个关键词：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(B2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;AI&quot;, &quot;人工智能&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;5G&quot;, &quot;第五代移动通信&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;IoT&quot;, &quot;物联网&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用LET函数更清晰：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text, B2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    step1, SUBSTITUTE(text, &quot;AI&quot;, &quot;人工智能&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    step2, SUBSTITUTE(step1, &quot;5G&quot;, &quot;第五代移动通信&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    step3, SUBSTITUTE(step2, &quot;IoT&quot;, &quot;物联网&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    step3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例5模板内容填充"><strong>案例5：模板内容填充</strong><a href="#案例5模板内容填充" class="hash-link" aria-label="Direct link to 案例5模板内容填充" title="Direct link to 案例5模板内容填充" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">合同模板替换：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">模板：A2=&quot;尊敬的{姓名}，您的订单{订单号}已确认&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数据：B2=&quot;张三&quot;，C2=&quot;ORD2024001&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">填充：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(A2, &quot;{姓名}&quot;, B2), &quot;{订单号}&quot;, C2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：&quot;尊敬的张三，您的订单ORD2024001已确认&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景3编码格式转换"><strong>场景3：编码格式转换</strong><a href="#场景3编码格式转换" class="hash-link" aria-label="Direct link to 场景3编码格式转换" title="Direct link to 场景3编码格式转换" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例6sku编码标准化"><strong>案例6：SKU编码标准化</strong><a href="#案例6sku编码标准化" class="hash-link" aria-label="Direct link to 案例6sku编码标准化" title="Direct link to 案例6sku编码标准化" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">旧编码转新编码规则：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始：A2=&quot;IPH-15-PRO-MAX-256-BLK&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">新规则：去掉所有短横线，颜色代码在前</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">步骤：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 去掉短横线：=SUBSTITUTE(A2, &quot;-&quot;, &quot;&quot;)  // &quot;IPH15PROMAX256BLK&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 调整顺序需要更复杂的处理</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例7统一日期格式"><strong>案例7：统一日期格式</strong><a href="#案例7统一日期格式" class="hash-link" aria-label="Direct link to 案例7统一日期格式" title="Direct link to 案例7统一日期格式" translate="no">​</a></h4>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">多种格式统一：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始可能是：2023.12.25、2023/12/25、2023-12-25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">统一为：2023-12-25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(A2, &quot;.&quot;, &quot;-&quot;), &quot;/&quot;, &quot;-&quot;)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="七substitute与其他函数组合"><strong>七、SUBSTITUTE()与其他函数组合</strong><a href="#七substitute与其他函数组合" class="hash-link" aria-label="Direct link to 七substitute与其他函数组合" title="Direct link to 七substitute与其他函数组合" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合1substitute--trim清理空格"><strong>组合1：SUBSTITUTE + TRIM（清理空格）</strong><a href="#组合1substitute--trim清理空格" class="hash-link" aria-label="Direct link to 组合1substitute--trim清理空格" title="Direct link to 组合1substitute--trim清理空格" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">清理多余空格：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TRIM(SUBSTITUTE(A2, &quot;  &quot;, &quot; &quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 先将两个空格替换为一个，再TRIM清理首尾</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合2substitute--find智能替换"><strong>组合2：SUBSTITUTE + FIND（智能替换）</strong><a href="#组合2substitute--find智能替换" class="hash-link" aria-label="Direct link to 组合2substitute--find智能替换" title="Direct link to 组合2substitute--find智能替换" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">替换特定位置的内容：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, MID(A2, FIND(&quot;@&quot;, A2)+1, FIND(&quot;.&quot;, A2)-FIND(&quot;@&quot;, A2)-1), &quot;company&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释：替换@和.之间的邮箱域名</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合3substitute--len字符计数"><strong>组合3：SUBSTITUTE + LEN（字符计数）</strong><a href="#组合3substitute--len字符计数" class="hash-link" aria-label="Direct link to 组合3substitute--len字符计数" title="Direct link to 组合3substitute--len字符计数" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">统计中文字数：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=(LENB(A2) - LEN(A2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">统计特定字符个数：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LEN(A2) - LEN(SUBSTITUTE(A2, &quot;，&quot;, &quot;&quot;))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合4嵌套substitute"><strong>组合4：嵌套SUBSTITUTE</strong><a href="#组合4嵌套substitute" class="hash-link" aria-label="Direct link to 组合4嵌套substitute" title="Direct link to 组合4嵌套substitute" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">多次替换：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;AI&quot;, &quot;人工智能&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;VR&quot;, &quot;虚拟现实&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;AR&quot;, &quot;增强现实&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用REDUCE函数（Excel 365）更简洁：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REDUCE(A2, {&quot;AI&quot;,&quot;VR&quot;,&quot;AR&quot;}, LAMBDA(a,b,SUBSTITUTE(a,b,&quot;对应替换词&quot;)))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="组合5substitute--textjoin"><strong>组合5：SUBSTITUTE + TEXTJOIN</strong><a href="#组合5substitute--textjoin" class="hash-link" aria-label="Direct link to 组合5substitute--textjoin" title="Direct link to 组合5substitute--textjoin" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">提取并重组：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">假设A2=&quot;苹果,香蕉,橙子,葡萄&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">提取前两个水果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TEXTJOIN(&quot;,&quot;, TRUE, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LEFT(SUBSTITUTE(A2, &quot;,&quot;, REPT(&quot; &quot;, 100)), 100),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TRIM(MID(SUBSTITUTE(A2, &quot;,&quot;, REPT(&quot; &quot;, 100)), 100, 100)))</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="八substitute-vs-replace"><strong>八、SUBSTITUTE() vs REPLACE()</strong><a href="#八substitute-vs-replace" class="hash-link" aria-label="Direct link to 八substitute-vs-replace" title="Direct link to 八substitute-vs-replace" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="对比表"><strong>对比表</strong><a href="#对比表" class="hash-link" aria-label="Direct link to 对比表" title="Direct link to 对比表" translate="no">​</a></h3>
<table><thead><tr><th>特性</th><th>SUBSTITUTE()</th><th>REPLACE()</th></tr></thead><tbody><tr><td><strong>替换依据</strong></td><td>按内容</td><td>按位置</td></tr><tr><td><strong>区分大小写</strong></td><td>是</td><td>不适用</td></tr><tr><td><strong>指定次数</strong></td><td>支持</td><td>不支持</td></tr><tr><td><strong>插入功能</strong></td><td>间接支持</td><td>直接支持</td></tr><tr><td><strong>删除功能</strong></td><td>直接支持</td><td>直接支持</td></tr><tr><td><strong>灵活性</strong></td><td>内容驱动</td><td>位置驱动</td></tr><tr><td><strong>适用场景</strong></td><td>知道要替换什么</td><td>知道在哪里替换</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="选择指南"><strong>选择指南</strong><a href="#选择指南" class="hash-link" aria-label="Direct link to 选择指南" title="Direct link to 选择指南" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">使用SUBSTITUTE当：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 知道要替换的具体文本内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 需要替换所有出现的地方</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 需要替换第N次出现的文本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 文本模式固定但位置可能变化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用REPLACE当：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 知道要替换的字符位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 需要在特定位置插入字符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 文本格式固定但内容变化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✓ 按固定规则处理（如第N个字符）</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例对比"><strong>示例对比</strong><a href="#示例对比" class="hash-link" aria-label="Direct link to 示例对比" title="Direct link to 示例对比" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">相同任务：将电话号码中的&quot;-&quot;替换为&quot; &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUBSTITUTE：=SUBSTITUTE(A2, &quot;-&quot;, &quot; &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPLACE：需要知道每个&quot;-&quot;的位置，很麻烦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结论：这种情况下SUBSTITUTE更合适</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="九常见问题与解决方案"><strong>九、常见问题与解决方案</strong><a href="#九常见问题与解决方案" class="hash-link" aria-label="Direct link to 九常见问题与解决方案" title="Direct link to 九常见问题与解决方案" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题1大小写敏感"><strong>问题1：大小写敏感</strong><a href="#问题1大小写敏感" class="hash-link" aria-label="Direct link to 问题1大小写敏感" title="Direct link to 问题1大小写敏感" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SUBSTITUTE区分大小写：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot;Hello World&quot;, &quot;hello&quot;, &quot;Hi&quot;)  // 无变化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：先统一大小写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(LOWER(A2), &quot;hello&quot;, &quot;hi&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">或</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(UPPER(A2), &quot;HELLO&quot;, &quot;HI&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题2部分匹配问题"><strong>问题2：部分匹配问题</strong><a href="#问题2部分匹配问题" class="hash-link" aria-label="Direct link to 问题2部分匹配问题" title="Direct link to 问题2部分匹配问题" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">问题：=SUBSTITUTE(&quot;这是一个测试&quot;, &quot;测试&quot;, &quot;实验&quot;)  // &quot;这是一个实验&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但如果&quot;测试&quot;是其他词的一部分也会被替换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：添加分隔符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(&quot; &quot; &amp; A2 &amp; &quot; &quot;, &quot; 测试 &quot;, &quot; 实验 &quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题3替换顺序问题"><strong>问题3：替换顺序问题</strong><a href="#问题3替换顺序问题" class="hash-link" aria-label="Direct link to 问题3替换顺序问题" title="Direct link to 问题3替换顺序问题" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">嵌套替换时顺序重要：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(&quot;a-b-c&quot;, &quot;-&quot;, &quot;|&quot;), &quot;|&quot;, &quot;_&quot;)  // &quot;a_b_c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">所有&quot;-&quot;和&quot;|&quot;都变成了&quot;_&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">正确顺序：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(&quot;a-b-c&quot;, &quot;-&quot;, &quot;|&quot;), &quot;b&quot;, &quot;B&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题4性能问题"><strong>问题4：性能问题</strong><a href="#问题4性能问题" class="hash-link" aria-label="Direct link to 问题4性能问题" title="Direct link to 问题4性能问题" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">大量嵌套影响性能：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">超过5层嵌套考虑：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 使用辅助列分步计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 使用LET函数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 使用Power Query</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="问题5替换空文本"><strong>问题5：替换空文本</strong><a href="#问题5替换空文本" class="hash-link" aria-label="Direct link to 问题5替换空文本" title="Direct link to 问题5替换空文本" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">不能直接替换空文本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;&quot;, &quot;X&quot;)  // 错误用法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">要在每个字符间插入，使用其他方法：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TEXTJOIN(&quot;X&quot;, TRUE, MID(A2, ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A2))), 1))</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十高级技巧与应用"><strong>十、高级技巧与应用</strong><a href="#十高级技巧与应用" class="hash-link" aria-label="Direct link to 十高级技巧与应用" title="Direct link to 十高级技巧与应用" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧1使用rept辅助复杂替换"><strong>技巧1：使用REPT辅助复杂替换</strong><a href="#技巧1使用rept辅助复杂替换" class="hash-link" aria-label="Direct link to 技巧1使用rept辅助复杂替换" title="Direct link to 技巧1使用rept辅助复杂替换" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">将多个连续空格替换为一个：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TRIM(SUBSTITUTE(A2, &quot;  &quot;, &quot; &quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但这样只处理两个连续空格，三个以上需要循环</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更好：使用REPT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TRIM(SUBSTITUTE(A2, REPT(&quot; &quot;, 10), &quot; &quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">然后多次应用直到没有连续空格</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧2模拟正则表达式"><strong>技巧2：模拟正则表达式</strong><a href="#技巧2模拟正则表达式" class="hash-link" aria-label="Direct link to 技巧2模拟正则表达式" title="Direct link to 技巧2模拟正则表达式" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">删除所有数字：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TEXTJOIN(&quot;&quot;, TRUE, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF(ISERROR(--MID(A2, ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A2))), 1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MID(A2, ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A2))), 1), &quot;&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">或者用SUBSTITUTE逐个替换数字（繁琐）：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(...A2, &quot;0&quot;, &quot;&quot;), &quot;1&quot;, &quot;&quot;), ...)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧3提取特定符号间的内容"><strong>技巧3：提取特定符号间的内容</strong><a href="#技巧3提取特定符号间的内容" class="hash-link" aria-label="Direct link to 技巧3提取特定符号间的内容" title="Direct link to 技巧3提取特定符号间的内容" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">提取括号内的内容：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=MID(A2, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     FIND(&quot;(&quot;, A2) + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     FIND(&quot;)&quot;, A2) - FIND(&quot;(&quot;, A2) - 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但如果有多层括号，使用SUBSTITUTE：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=TRIM(MID(SUBSTITUTE(SUBSTITUTE(A2, &quot;(&quot;, &quot;|&quot;), &quot;)&quot;, &quot;|&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          FIND(&quot;|&quot;, SUBSTITUTE(SUBSTITUTE(A2, &quot;(&quot;, &quot;|&quot;), &quot;)&quot;, &quot;|&quot;)) + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          FIND(&quot;|&quot;, SUBSTITUTE(SUBSTITUTE(A2, &quot;(&quot;, &quot;|&quot;), &quot;)&quot;, &quot;|&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               FIND(&quot;|&quot;, SUBSTITUTE(SUBSTITUTE(A2, &quot;(&quot;, &quot;|&quot;), &quot;)&quot;, &quot;|&quot;)) + 1) -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          FIND(&quot;|&quot;, SUBSTITUTE(SUBSTITUTE(A2, &quot;(&quot;, &quot;|&quot;), &quot;)&quot;, &quot;|&quot;)) - 1))</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧4创建缩写扩展器"><strong>技巧4：创建缩写扩展器</strong><a href="#技巧4创建缩写扩展器" class="hash-link" aria-label="Direct link to 技巧4创建缩写扩展器" title="Direct link to 技巧4创建缩写扩展器" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">自动扩展常见缩写：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    abbreviations, {&quot;AI&quot;,&quot;IoT&quot;,&quot;VR&quot;,&quot;AR&quot;,&quot;5G&quot;,&quot;ESG&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fullforms, {&quot;人工智能&quot;,&quot;物联网&quot;,&quot;虚拟现实&quot;,&quot;增强现实&quot;,&quot;第五代移动通信&quot;,&quot;环境社会治理&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REDUCE(text, SEQUENCE(ROWS(abbreviations)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LAMBDA(acc, i,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SUBSTITUTE(acc, INDEX(abbreviations, i), INDEX(fullforms, i))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="技巧5智能换行符处理"><strong>技巧5：智能换行符处理</strong><a href="#技巧5智能换行符处理" class="hash-link" aria-label="Direct link to 技巧5智能换行符处理" title="Direct link to 技巧5智能换行符处理" translate="no">​</a></h3>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">将文本中的换行符替换为其他字符：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, CHAR(10), &quot; | &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">将其他分隔符替换为换行符：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(A2, &quot;;&quot;, CHAR(10))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">记得设置单元格格式为自动换行</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十一综合实战案例"><strong>十一、综合实战案例</strong><a href="#十一综合实战案例" class="hash-link" aria-label="Direct link to 十一综合实战案例" title="Direct link to 十一综合实战案例" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例1完整的数据清洗流程"><strong>案例1：完整的数据清洗流程</strong><a href="#案例1完整的数据清洗流程" class="hash-link" aria-label="Direct link to 案例1完整的数据清洗流程" title="Direct link to 案例1完整的数据清洗流程" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="需求清理客户信息数据"><strong>需求</strong>：清理客户信息数据<a href="#需求清理客户信息数据" class="hash-link" aria-label="Direct link to 需求清理客户信息数据" title="Direct link to 需求清理客户信息数据" translate="no">​</a></h4>
<p><strong>原始数据</strong>：A2=&quot;张 明 | 138-0013-8001 | <a href="mailto:zhang@company.com" target="_blank" rel="noopener noreferrer" class="">zhang@company.com</a> | 北京-海淀&quot;</p>
<p><strong>清洗要求</strong>：</p>
<ol>
<li class="">统一分隔符为逗号</li>
<li class="">清理电话号码中的符号</li>
<li class="">邮箱统一为小写</li>
<li class="">地址替换短横线为空格</li>
<li class="">移除多余空格</li>
</ol>
<p><strong>公式</strong>：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    raw, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. 统一分隔符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    step1, SUBSTITUTE(raw, &quot; | &quot;, &quot;,&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. 拆分各部分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name, TRIM(LEFT(step1, FIND(&quot;,&quot;, step1)-1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rest1, MID(step1, FIND(&quot;,&quot;, step1)+1, LEN(step1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phone, TRIM(LEFT(rest1, FIND(&quot;,&quot;, rest1)-1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rest2, MID(rest1, FIND(&quot;,&quot;, rest1)+1, LEN(rest1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email, TRIM(LEFT(rest2, FIND(&quot;,&quot;, rest2)-1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address, TRIM(MID(rest2, FIND(&quot;,&quot;, rest2)+1, LEN(rest2))),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. 清理各部分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean_phone, SUBSTITUTE(SUBSTITUTE(phone, &quot;-&quot;, &quot;&quot;), &quot; &quot;, &quot;&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean_email, LOWER(email),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean_address, SUBSTITUTE(address, &quot;-&quot;, &quot; &quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4. 重新组合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name &amp; &quot;,&quot; &amp; clean_phone &amp; &quot;,&quot; &amp; clean_email &amp; &quot;,&quot; &amp; clean_address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例2批量模板填充系统"><strong>案例2：批量模板填充系统</strong><a href="#案例2批量模板填充系统" class="hash-link" aria-label="Direct link to 案例2批量模板填充系统" title="Direct link to 案例2批量模板填充系统" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="需求根据模板和数据表生成个性化文档"><strong>需求</strong>：根据模板和数据表生成个性化文档<a href="#需求根据模板和数据表生成个性化文档" class="hash-link" aria-label="Direct link to 需求根据模板和数据表生成个性化文档" title="Direct link to 需求根据模板和数据表生成个性化文档" translate="no">​</a></h4>
<p><strong>模板</strong>：<code>A2=&quot;尊敬的{客户姓名}，您的订单{订单号}金额为{金额}元，预计{日期}发货。</code>&quot;</p>
<p><strong>数据表</strong>：</p>
<ul>
<li class="">B2：客户姓名=&quot;张三&quot;</li>
<li class="">C2：订单号=&quot;ORD2024001&quot;</li>
<li class="">D2：金额=&quot;1580&quot;</li>
<li class="">E2：日期=&quot;2024年1月15日&quot;</li>
</ul>
<p><strong>公式</strong>：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;{客户姓名}&quot;, B2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;{订单号}&quot;, C2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;{金额}&quot;, D2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;{日期}&quot;, E2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用LAMBDA简化：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=REDUCE(A2, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {&quot;{客户姓名}&quot;,&quot;{订单号}&quot;,&quot;{金额}&quot;,&quot;{日期}&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LAMBDA(acc, pattern,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SUBSTITUTE(acc, pattern, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SWITCH(pattern,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;{客户姓名}&quot;, B2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;{订单号}&quot;, C2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;{金额}&quot;, D2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;{日期}&quot;, E2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                pattern)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例3智能关键词高亮系统"><strong>案例3：智能关键词高亮系统</strong><a href="#案例3智能关键词高亮系统" class="hash-link" aria-label="Direct link to 案例3智能关键词高亮系统" title="Direct link to 案例3智能关键词高亮系统" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="需求在文本中高亮显示关键词用包围"><strong>需求</strong>：在文本中高亮显示关键词（用**包围）<a href="#需求在文本中高亮显示关键词用包围" class="hash-link" aria-label="Direct link to 需求在文本中高亮显示关键词用包围" title="Direct link to 需求在文本中高亮显示关键词用包围" translate="no">​</a></h4>
<p><strong>文本</strong>：A2=&quot;人工智能正在改变世界，AI技术发展迅速。&quot;
<strong>关键词</strong>：B2=&quot;人工智能,AI&quot;</p>
<p><strong>公式</strong>：</p>
<div class="language-excel codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-excel codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=LET(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text, A2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keywords, TEXTSPLIT(B2, &quot;,&quot;, , TRUE),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    highlighted, REDUCE(text, keywords,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LAMBDA(acc, keyword,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SUBSTITUTE(acc, keyword, &quot;**&quot; &amp; keyword &amp; &quot;**&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    highlighted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">结果：&quot;**人工智能**正在改变世界，**AI**技术发展迅速。&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十二练习与测试"><strong>十二、练习与测试</strong><a href="#十二练习与测试" class="hash-link" aria-label="Direct link to 十二练习与测试" title="Direct link to 十二练习与测试" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习1电话号码格式统一"><strong>练习1：电话号码格式统一</strong><a href="#练习1电话号码格式统一" class="hash-link" aria-label="Direct link to 练习1电话号码格式统一" title="Direct link to 练习1电话号码格式统一" translate="no">​</a></h3>
<p><strong>输入</strong>：</p>
<ol>
<li class="">&quot;138-0013-8001&quot;</li>
<li class="">&quot;138 0013 8001&quot;</li>
<li class="">&quot;(138)00138001&quot;</li>
<li class="">&quot;86-138-0013-8001&quot;</li>
</ol>
<p><strong>要求</strong>：统一输出为&quot;+86 138 0013 8001&quot;</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习2清理csv格式错误"><strong>练习2：清理CSV格式错误</strong><a href="#练习2清理csv格式错误" class="hash-link" aria-label="Direct link to 练习2清理csv格式错误" title="Direct link to 练习2清理csv格式错误" translate="no">​</a></h3>
<p><strong>输入</strong>：A2=&#x27;张三,&quot;苹果,香蕉&quot;,100,&quot;北京,上海&quot;&#x27;
<strong>问题</strong>：字段内包含逗号，导致CSV解析错误</p>
<p><strong>要求</strong>：将字段内的逗号替换为顿号</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习3多语言混排清理"><strong>练习3：多语言混排清理</strong><a href="#练习3多语言混排清理" class="hash-link" aria-label="Direct link to 练习3多语言混排清理" title="Direct link to 练习3多语言混排清理" translate="no">​</a></h3>
<p><strong>输入</strong>：&quot;Hello 你好 world 世界！2023→2024&quot;
<strong>要求</strong>：</p>
<ol>
<li class="">英文单词首字母大写</li>
<li class="">中文保持不变</li>
<li class="">替换&quot;→&quot;为&quot;至&quot;</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="练习4创建密码复杂度检查"><strong>练习4：创建密码复杂度检查</strong><a href="#练习4创建密码复杂度检查" class="hash-link" aria-label="Direct link to 练习4创建密码复杂度检查" title="Direct link to 练习4创建密码复杂度检查" translate="no">​</a></h3>
<p><strong>规则</strong>：密码必须包含大小写字母、数字、特殊符号
<strong>要求</strong>：检查并提示缺失的类型</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="十三最佳实践总结"><strong>十三、最佳实践总结</strong><a href="#十三最佳实践总结" class="hash-link" aria-label="Direct link to 十三最佳实践总结" title="Direct link to 十三最佳实践总结" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="使用substitute的最佳场景"><strong>使用SUBSTITUTE()的最佳场景</strong><a href="#使用substitute的最佳场景" class="hash-link" aria-label="Direct link to 使用substitute的最佳场景" title="Direct link to 使用substitute的最佳场景" translate="no">​</a></h3>
<ol>
<li class=""><strong>批量内容替换</strong>：替换所有出现的特定文本</li>
<li class=""><strong>数据清洗</strong>：移除不需要的字符或符号</li>
<li class=""><strong>模板填充</strong>：替换模板中的占位符</li>
<li class=""><strong>格式标准化</strong>：统一数据格式</li>
<li class=""><strong>内容更新</strong>：更新过时或错误的内容</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="避免使用substitute的场景"><strong>避免使用SUBSTITUTE()的场景</strong><a href="#避免使用substitute的场景" class="hash-link" aria-label="Direct link to 避免使用substitute的场景" title="Direct link to 避免使用substitute的场景" translate="no">​</a></h3>
<ol>
<li class="">复杂的模式匹配（考虑正则表达式）</li>
<li class="">大量数据的性能敏感场景（考虑Power Query）</li>
<li class="">需要保持原格式的富文本（会丢失格式）</li>
<li class="">超长文本的多次替换（性能差）</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="性能优化建议"><strong>性能优化建议</strong><a href="#性能优化建议" class="hash-link" aria-label="Direct link to 性能优化建议" title="Direct link to 性能优化建议" translate="no">​</a></h3>
<ol>
<li class=""><strong>减少嵌套层数</strong>：超过5层考虑其他方案</li>
<li class=""><strong>先TRIM后SUBSTITUTE</strong>：先清理首尾空格</li>
<li class=""><strong>使用辅助列</strong>：复杂替换分步进行</li>
<li class=""><strong>批量处理</strong>：使用数组公式或Power Query</li>
<li class=""><strong>避免循环依赖</strong>：注意公式的引用关系</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="调试与验证"><strong>调试与验证</strong><a href="#调试与验证" class="hash-link" aria-label="Direct link to 调试与验证" title="Direct link to 调试与验证" translate="no">​</a></h3>
<ol>
<li class=""><strong>分步测试</strong>：使用辅助列验证每一步</li>
<li class=""><strong>检查大小写</strong>：确认是否区分大小写</li>
<li class=""><strong>验证替换次数</strong>：确认instance_num参数正确</li>
<li class=""><strong>检查特殊字符</strong>：注意不可见字符的影响</li>
<li class=""><strong>测试边界情况</strong>：测试空值、错误值等情况</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="一句话总结"><strong>一句话总结</strong><a href="#一句话总结" class="hash-link" aria-label="Direct link to 一句话总结" title="Direct link to 一句话总结" translate="no">​</a></h3>
<p><strong>SUBSTITUTE()是Excel的&quot;智能查找替换&quot;——能精确找到并替换文本中的特定内容，是处理内容驱动的文本替换任务的终极武器！</strong></p>
<hr></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/office/excel/proj2/substitute.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一substitute函数基础" class="table-of-contents__link toc-highlight"><strong>一、SUBSTITUTE()函数基础</strong></a><ul><li><a href="#1-函数语法" class="table-of-contents__link toc-highlight"><strong>1. 函数语法</strong></a></li><li><a href="#2-参数详解" class="table-of-contents__link toc-highlight"><strong>2. 参数详解</strong></a></li><li><a href="#3-重要特性" class="table-of-contents__link toc-highlight"><strong>3. 重要特性</strong></a></li></ul></li><li><a href="#二详细示例数据表" class="table-of-contents__link toc-highlight"><strong>二、详细示例数据表</strong></a><ul><li><a href="#表1产品名称统一表" class="table-of-contents__link toc-highlight"><strong>表1：产品名称统一表</strong></a></li><li><a href="#表2客户联系信息表" class="table-of-contents__link toc-highlight"><strong>表2：客户联系信息表</strong></a></li><li><a href="#表3文章关键词替换表" class="table-of-contents__link toc-highlight"><strong>表3：文章关键词替换表</strong></a></li><li><a href="#表4数据清洗示例表" class="table-of-contents__link toc-highlight"><strong>表4：数据清洗示例表</strong></a></li><li><a href="#表5多语言文本处理表" class="table-of-contents__link toc-highlight"><strong>表5：多语言文本处理表</strong></a></li></ul></li><li><a href="#三基础用法示例" class="table-of-contents__link toc-highlight"><strong>三、基础用法示例</strong></a><ul><li><a href="#1-简单替换" class="table-of-contents__link toc-highlight"><strong>1. 简单替换</strong></a></li><li><a href="#2-实际应用示例" class="table-of-contents__link toc-highlight"><strong>2. 实际应用示例</strong></a></li></ul></li><li><a href="#四指定替换次数instance_num参数" class="table-of-contents__link toc-highlight"><strong>四、指定替换次数（instance_num参数）</strong></a><ul><li><a href="#1-替换第n次出现" class="table-of-contents__link toc-highlight"><strong>1. 替换第N次出现</strong></a></li><li><a href="#2-实际应用示例-1" class="table-of-contents__link toc-highlight"><strong>2. 实际应用示例</strong></a></li></ul></li><li><a href="#五substitute的三种特殊用法" class="table-of-contents__link toc-highlight"><strong>五、SUBSTITUTE()的三种特殊用法</strong></a><ul><li><a href="#1-删除字符new_text--" class="table-of-contents__link toc-highlight"><strong>1. 删除字符（new_text = &quot;&quot;）</strong></a></li><li><a href="#2-插入字符替换空字符" class="table-of-contents__link toc-highlight"><strong>2. 插入字符（替换空字符）</strong></a></li><li><a href="#3-计数功能间接使用" class="table-of-contents__link toc-highlight"><strong>3. 计数功能（间接使用）</strong></a></li></ul></li><li><a href="#六实际工作场景应用" class="table-of-contents__link toc-highlight"><strong>六、实际工作场景应用</strong></a><ul><li><a href="#场景1数据清洗标准化" class="table-of-contents__link toc-highlight"><strong>场景1：数据清洗标准化</strong></a></li><li><a href="#场景2文本内容替换" class="table-of-contents__link toc-highlight"><strong>场景2：文本内容替换</strong></a></li><li><a href="#场景3编码格式转换" class="table-of-contents__link toc-highlight"><strong>场景3：编码格式转换</strong></a></li></ul></li><li><a href="#七substitute与其他函数组合" class="table-of-contents__link toc-highlight"><strong>七、SUBSTITUTE()与其他函数组合</strong></a><ul><li><a href="#组合1substitute--trim清理空格" class="table-of-contents__link toc-highlight"><strong>组合1：SUBSTITUTE + TRIM（清理空格）</strong></a></li><li><a href="#组合2substitute--find智能替换" class="table-of-contents__link toc-highlight"><strong>组合2：SUBSTITUTE + FIND（智能替换）</strong></a></li><li><a href="#组合3substitute--len字符计数" class="table-of-contents__link toc-highlight"><strong>组合3：SUBSTITUTE + LEN（字符计数）</strong></a></li><li><a href="#组合4嵌套substitute" class="table-of-contents__link toc-highlight"><strong>组合4：嵌套SUBSTITUTE</strong></a></li><li><a href="#组合5substitute--textjoin" class="table-of-contents__link toc-highlight"><strong>组合5：SUBSTITUTE + TEXTJOIN</strong></a></li></ul></li><li><a href="#八substitute-vs-replace" class="table-of-contents__link toc-highlight"><strong>八、SUBSTITUTE() vs REPLACE()</strong></a><ul><li><a href="#对比表" class="table-of-contents__link toc-highlight"><strong>对比表</strong></a></li><li><a href="#选择指南" class="table-of-contents__link toc-highlight"><strong>选择指南</strong></a></li><li><a href="#示例对比" class="table-of-contents__link toc-highlight"><strong>示例对比</strong></a></li></ul></li><li><a href="#九常见问题与解决方案" class="table-of-contents__link toc-highlight"><strong>九、常见问题与解决方案</strong></a><ul><li><a href="#问题1大小写敏感" class="table-of-contents__link toc-highlight"><strong>问题1：大小写敏感</strong></a></li><li><a href="#问题2部分匹配问题" class="table-of-contents__link toc-highlight"><strong>问题2：部分匹配问题</strong></a></li><li><a href="#问题3替换顺序问题" class="table-of-contents__link toc-highlight"><strong>问题3：替换顺序问题</strong></a></li><li><a href="#问题4性能问题" class="table-of-contents__link toc-highlight"><strong>问题4：性能问题</strong></a></li><li><a href="#问题5替换空文本" class="table-of-contents__link toc-highlight"><strong>问题5：替换空文本</strong></a></li></ul></li><li><a href="#十高级技巧与应用" class="table-of-contents__link toc-highlight"><strong>十、高级技巧与应用</strong></a><ul><li><a href="#技巧1使用rept辅助复杂替换" class="table-of-contents__link toc-highlight"><strong>技巧1：使用REPT辅助复杂替换</strong></a></li><li><a href="#技巧2模拟正则表达式" class="table-of-contents__link toc-highlight"><strong>技巧2：模拟正则表达式</strong></a></li><li><a href="#技巧3提取特定符号间的内容" class="table-of-contents__link toc-highlight"><strong>技巧3：提取特定符号间的内容</strong></a></li><li><a href="#技巧4创建缩写扩展器" class="table-of-contents__link toc-highlight"><strong>技巧4：创建缩写扩展器</strong></a></li><li><a href="#技巧5智能换行符处理" class="table-of-contents__link toc-highlight"><strong>技巧5：智能换行符处理</strong></a></li></ul></li><li><a href="#十一综合实战案例" class="table-of-contents__link toc-highlight"><strong>十一、综合实战案例</strong></a><ul><li><a href="#案例1完整的数据清洗流程" class="table-of-contents__link toc-highlight"><strong>案例1：完整的数据清洗流程</strong></a></li><li><a href="#案例2批量模板填充系统" class="table-of-contents__link toc-highlight"><strong>案例2：批量模板填充系统</strong></a></li><li><a href="#案例3智能关键词高亮系统" class="table-of-contents__link toc-highlight"><strong>案例3：智能关键词高亮系统</strong></a></li></ul></li><li><a href="#十二练习与测试" class="table-of-contents__link toc-highlight"><strong>十二、练习与测试</strong></a><ul><li><a href="#练习1电话号码格式统一" class="table-of-contents__link toc-highlight"><strong>练习1：电话号码格式统一</strong></a></li><li><a href="#练习2清理csv格式错误" class="table-of-contents__link toc-highlight"><strong>练习2：清理CSV格式错误</strong></a></li><li><a href="#练习3多语言混排清理" class="table-of-contents__link toc-highlight"><strong>练习3：多语言混排清理</strong></a></li><li><a href="#练习4创建密码复杂度检查" class="table-of-contents__link toc-highlight"><strong>练习4：创建密码复杂度检查</strong></a></li></ul></li><li><a href="#十三最佳实践总结" class="table-of-contents__link toc-highlight"><strong>十三、最佳实践总结</strong></a><ul><li><a href="#使用substitute的最佳场景" class="table-of-contents__link toc-highlight"><strong>使用SUBSTITUTE()的最佳场景</strong></a></li><li><a href="#避免使用substitute的场景" class="table-of-contents__link toc-highlight"><strong>避免使用SUBSTITUTE()的场景</strong></a></li><li><a href="#性能优化建议" class="table-of-contents__link toc-highlight"><strong>性能优化建议</strong></a></li><li><a href="#调试与验证" class="table-of-contents__link toc-highlight"><strong>调试与验证</strong></a></li><li><a href="#一句话总结" class="table-of-contents__link toc-highlight"><strong>一句话总结</strong></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>