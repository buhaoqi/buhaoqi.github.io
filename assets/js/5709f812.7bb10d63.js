"use strict";(globalThis.webpackChunkbuhaoqi_github_io=globalThis.webpackChunkbuhaoqi_github_io||[]).push([[5901],{8059(d,e,s){s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>j,frontMatter:()=>t,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"mysql/ch09/exercise1","title":"\u89e6\u53d1\u5668\u4e13\u9879\u7ec3\u4e60","description":"\u5168\u771f\u6a21\u62df\u4e00\u7b2c 87 \u9898","source":"@site/docs/mysql/ch09/exercise1.md","sourceDirName":"mysql/ch09","slug":"/mysql/ch09/exercise1","permalink":"/docs/mysql/ch09/exercise1","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/mysql/ch09/exercise1.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"\u89e6\u53d1\u5668\u4e13\u9879\u7ec3\u4e60","sidebar_label":"\u89e6\u53d1\u5668\u4e13\u9879\u7ec3\u4e60","sidebar_position":10},"sidebar":"mysqlSidebar","previous":{"title":"\u53d8\u91cf","permalink":"/docs/mysql/ch09/atta-variable"},"next":{"title":"\u5b58\u50a8\u8fc7\u7a0b\u4e13\u9879\u7ec3\u4e60","permalink":"/docs/mysql/ch09/exercise2"}}');var r=s(4848),i=s(8453);const t={title:"\u89e6\u53d1\u5668\u4e13\u9879\u7ec3\u4e60",sidebar_label:"\u89e6\u53d1\u5668\u4e13\u9879\u7ec3\u4e60",sidebar_position:10},l=void 0,c={},h=[{value:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c 87 \u9898",id:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c-87-\u9898",level:2},{value:"\u5168\u771f\u6a21\u62df\u56db\u7b2c 84 \u9898",id:"\u5168\u771f\u6a21\u62df\u56db\u7b2c-84-\u9898",level:2},{value:"\u5168\u771f\u6a21\u62df\u56db\u7b2c 88 \u9898",id:"\u5168\u771f\u6a21\u62df\u56db\u7b2c-88-\u9898",level:2},{value:"\u53c2\u8003\u7b54\u6848",id:"\u53c2\u8003\u7b54\u6848",level:2},{value:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c 87 \u9898",id:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c-87-\u9898-1",level:3},{value:"\u5168\u771f\u6a21\u62df\u56db\u7b2c 84 \u9898",id:"\u5168\u771f\u6a21\u62df\u56db\u7b2c-84-\u9898-1",level:3}];function x(d){const e={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...d.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{id:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c-87-\u9898",children:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c 87 \u9898"}),"\n",(0,r.jsxs)(e.ol,{start:"87",children:["\n",(0,r.jsx)(e.li,{children:"\u8fd0\u884c\u4e0b\u9762\u7684 MySQL \u7a0b\u5e8f\uff0c\u8f93\u51fa\u7684\u7ed3\u679c\u662f______\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"create procedure js()\nbegin\n    declare i int default 1;\n    declare s varchar(100) default '';\n    mylabel:repeat\n    if i mod 2=0 then\n        set i=i+1;\n        iterate mylabel;\n    end if;\n    set s=concat(s,convert(i,char),' ');\n    set i=i+1;\n    until i>=10\n    end repeat;\n    select s;\nend;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5168\u771f\u6a21\u62df\u56db\u7b2c-84-\u9898",children:"\u5168\u771f\u6a21\u62df\u56db\u7b2c 84 \u9898"}),"\n",(0,r.jsxs)(e.ol,{start:"84",children:["\n",(0,r.jsx)(e.li,{children:"\u5047\u8bbe\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u6709sell\u8868\uff0c\u5185\u5bb9\u59824-84\u9898\u8868\u6240\u793a\u3002\u6267\u4e0b\u4ee5\u4e0bMySQL\u7a0b\u5e8f\u4ee3\u7801\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"4-84\u9898\u8868 sell \u5185\u5bb9"})}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8ba2\u5355\u53f7"}),(0,r.jsx)(e.th,{children:"\u7528\u6237\u53f7"}),(0,r.jsx)(e.th,{children:"\u56fe\u4e66\u7f16\u53f7"}),(0,r.jsx)(e.th,{children:"\u8ba2\u8d2d\u518c\u6570"}),(0,r.jsx)(e.th,{children:"\u8ba2\u8d2d\u5355\u4ef7"}),(0,r.jsx)(e.th,{children:"\u8ba2\u8d2d\u65f6\u95f4"}),(0,r.jsx)(e.th,{children:"\u662f\u5426\u53d1\u8d27"}),(0,r.jsx)(e.th,{children:"\u662f\u5426\u6536\u8d27"}),(0,r.jsx)(e.th,{children:"\u662f\u5426\u7ed3\u6e05"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"C0132"}),(0,r.jsx)(e.td,{children:"TP.2525"}),(0,r.jsx)(e.td,{children:"13"}),(0,r.jsx)(e.td,{children:"20"}),(0,r.jsx)(e.td,{children:"2020/11/14 00:00"}),(0,r.jsx)(e.td,{children:"\u5df2\u53d1\u8d27"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"D1963"}),(0,r.jsx)(e.td,{children:"TP.2463"}),(0,r.jsx)(e.td,{children:"3"}),(0,r.jsx)(e.td,{children:"31.5"}),(0,r.jsx)(e.td,{children:"2020/11/21 00:00"}),(0,r.jsx)(e.td,{children:"\u5df2\u53d1\u8d27"}),(0,r.jsx)(e.td,{children:"\u5df2\u6536\u8d27"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"3"}),(0,r.jsx)(e.td,{children:"D1963"}),(0,r.jsx)(e.td,{children:"TP.2525"}),(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"23.45"}),(0,r.jsx)(e.td,{children:"2020/3/26 00:00"}),(0,r.jsx)(e.td,{children:"\u5df2\u53d1\u8d27"}),(0,r.jsx)(e.td,{children:"\u5df2\u6536\u8d27"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"4"}),(0,r.jsx)(e.td,{children:"C0138"}),(0,r.jsx)(e.td,{children:"Ts.3035"}),(0,r.jsx)(e.td,{children:"10"}),(0,r.jsx)(e.td,{children:"23.5"}),(0,r.jsx)(e.td,{children:"2020/8/1 00:00"}),(0,r.jsx)(e.td,{children:"\u5df2\u53d1\u8d27"}),(0,r.jsx)(e.td,{children:"\u5df2\u6536\u8d27"}),(0,r.jsx)(e.td,{children:"\u5df2\u7ed3\u6e05"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"5"}),(0,r.jsx)(e.td,{children:"C0138"}),(0,r.jsx)(e.td,{children:"TP.2525"}),(0,r.jsx)(e.td,{children:"133"}),(0,r.jsx)(e.td,{children:"33.5"}),(0,r.jsx)(e.td,{children:"2020/8/1 00:00"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"A3013"}),(0,r.jsx)(e.td,{children:"Tw.2562"}),(0,r.jsx)(e.td,{children:"4"}),(0,r.jsx)(e.td,{children:"89"}),(0,r.jsx)(e.td,{children:"2020/8/20 00:00"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"7"}),(0,r.jsx)(e.td,{children:"C0138"}),(0,r.jsx)(e.td,{children:"TP.2463"}),(0,r.jsx)(e.td,{children:"43"}),(0,r.jsx)(e.td,{children:"30"}),(0,r.jsx)(e.td,{children:"2020/11/8 00:00"}),(0,r.jsx)(e.td,{children:"\u5df2\u53d1\u8d27"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"8"}),(0,r.jsx)(e.td,{children:"C0138"}),(0,r.jsx)(e.td,{children:"Ts.3035"}),(0,r.jsx)(e.td,{children:"5"}),(0,r.jsx)(e.td,{children:"45.5"}),(0,r.jsx)(e.td,{children:"2020/11/21 00:00"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"9"}),(0,r.jsx)(e.td,{children:"C0132"}),(0,r.jsx)(e.td,{children:"Tw.1283"}),(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"23"}),(0,r.jsx)(e.td,{children:"2020/11/28 00:00"}),(0,r.jsx)(e.td,{children:"\u5df2\u53d1\u8d27"}),(0,r.jsx)(e.td,{children:"\u5df2\u6536\u8d27"}),(0,r.jsx)(e.td,{})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u73b0\u6709\u4e0b\u9762\u7684 MySQL \u8bed\u53e5\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DELIMITER $$  \nCREATE TRIGGER book_del AFTER DELETE  \n    ON Book FOR EACH ROW  \nBEGIN  \n    DELETE FROM sell WHERE \u56fe\u4e66\u7f16\u53f7 =OLD. \u56fe\u4e66\u7f16\u53f7 ;  \nEND$$  \nDELIMITER ;  \n"})}),"\n",(0,r.jsx)(e.p,{children:"\u73b0\u5728\u9a8c\u8bc1\u7a0b\u5e8f\u529f\u80fd\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DELETE FROM book WHERE \u56fe\u4e66\u7f16\u53f7 ='Tw.1283';  \nSELECT * FROM sell WHERE \u56fe\u4e66\u7f16\u53f7 ='Tw.1283';  \n"})}),"\n",(0,r.jsx)(e.p,{children:"\u67e5\u8be2\u7ed3\u679c\u6709______\u6761\u8bb0\u5f55\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u5168\u771f\u6a21\u62df\u56db\u7b2c-88-\u9898",children:"\u5168\u771f\u6a21\u62df\u56db\u7b2c 88 \u9898"}),"\n",(0,r.jsxs)(e.p,{children:["\u73b0\u6709\u5ba0\u7269\u5546\u5e97\u7535\u5b50\u5546\u52a1\u7cfb\u7edf\u6570\u636e\u5e93 ",(0,r.jsx)(e.code,{children:"petstore"}),"\uff1a"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u679c\u5ba2\u6237\u9009\u62e9\u4e86\u67d0\u4ef6\u5546\u54c1\uff0c\u786e\u8ba4\u8d2d\u4e70\u65f6\uff0c\u9700\u8981\u4e0b\u8ba2\u5355\uff0c",(0,r.jsx)(e.code,{children:"orders"}),"\uff08\u8ba2\u5355\u8868\uff09\u8bb0\u5f55\u4e86\u5ba2\u6237\u7684\u8ba2\u5355\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u679c\u5ba2\u6237\u4e00\u6b21\u8d2d\u4e70\u4e86\u51e0\u79cd\u5546\u54c1\uff0c\u5219\u9700\u8981 ",(0,r.jsx)(e.code,{children:"lineitem"}),"\uff08\u8ba2\u5355\u660e\u7ec6\u8868\uff09\u8bb0\u5f55\u6240\u8d2d\u4e70\u5546\u54c1\u7684\u6570\u91cf\u3001\u5355\u4ef7\u7b49\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u8ba2\u5355\u8868 ",(0,r.jsx)(e.code,{children:"orders"})]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"orderid"}),(0,r.jsx)(e.th,{children:"userid"}),(0,r.jsx)(e.th,{children:"orderdate"}),(0,r.jsx)(e.th,{children:"totalprice"}),(0,r.jsx)(e.th,{children:"status"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130411"}),(0,r.jsx)(e.td,{children:"u0001"}),(0,r.jsx)(e.td,{children:"2013/4/11 15:07:34"}),(0,r.jsx)(e.td,{children:"500.0"}),(0,r.jsx)(e.td,{children:"0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130412"}),(0,r.jsx)(e.td,{children:"u0002"}),(0,r.jsx)(e.td,{children:"2013/4/9 15:08:11"}),(0,r.jsx)(e.td,{children:"305.6"}),(0,r.jsx)(e.td,{children:"0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130413"}),(0,r.jsx)(e.td,{children:"u0003"}),(0,r.jsx)(e.td,{children:"2013/4/15 15:09:00"}),(0,r.jsx)(e.td,{children:"212.4"}),(0,r.jsx)(e.td,{children:"0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130414"}),(0,r.jsx)(e.td,{children:"u0003"}),(0,r.jsx)(e.td,{children:"2013/4/16 15:09:30"}),(0,r.jsx)(e.td,{children:"120.45"}),(0,r.jsx)(e.td,{children:"1"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130415"}),(0,r.jsx)(e.td,{children:"u0004"}),(0,r.jsx)(e.td,{children:"2013/4/2 15:10:05"}),(0,r.jsx)(e.td,{children:"120.3"}),(0,r.jsx)(e.td,{children:"0"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:["\u8ba2\u5355\u660e\u7ec6\u8868 ",(0,r.jsx)(e.code,{children:"lineitem"})]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"orderid"}),(0,r.jsx)(e.th,{children:"itemid"}),(0,r.jsx)(e.th,{children:"quantity"}),(0,r.jsx)(e.th,{children:"unitprice"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130411"}),(0,r.jsx)(e.td,{children:"FI-SW-01"}),(0,r.jsx)(e.td,{children:"10"}),(0,r.jsx)(e.td,{children:"18.5"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130411"}),(0,r.jsx)(e.td,{children:"FI-SW-02"}),(0,r.jsx)(e.td,{children:"12"}),(0,r.jsx)(e.td,{children:"16.5"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130412"}),(0,r.jsx)(e.td,{children:"K9-BD-01"}),(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"120"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130412"}),(0,r.jsx)(e.td,{children:"K9-PO-02"}),(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"220"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130413"}),(0,r.jsx)(e.td,{children:"K9-DL-01"}),(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"130"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130414"}),(0,r.jsx)(e.td,{children:"RP-SN-01"}),(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"125"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"20130415"}),(0,r.jsx)(e.td,{children:"AV-SB-02"}),(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"50"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u6709\u5982\u4e0b MySQL \u7a0b\u5e8f\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DELIMITER $$\nCREATE TRIGGER ord_upd AFTER INSERT\nON lineitem FOR EACH ROW\nBEGIN\n    DECLARE tp decimal(10,2);\n    DECLARE id int(11);\n    SELECT quantity*unitprice INTO tp FROM lineitem\n    WHERE orderid=NEW.orderid and itemid=NEW.itemid;\n    SELECT orderid INTO id FROM orders WHERE orderid=NEW.orderid;\n    IF id>0 THEN\n        UPDATE orders SET totalprice=totalprice+tp WHERE orderid=NEW.orderid;\n    END IF;\nEND $$\nDELIMITER ;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5229\u7528\u4e0b\u9762\u7684\u8bed\u53e5\u9a8c\u8bc1\u4ee5\u4e0a\u7a0b\u5e8f\u529f\u80fd\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"INSERT INTO lineitem (orderid ,itemid ,quantity ,unitprice)\nVALUES (20130414, 'FL-DSH-01', 2, 80);\n\nSelect orderid,userid,totalprice from orders;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u95ee\u9898\uff1a\u663e\u793a\u7ed3\u679c\u4e3a\uff1a__________"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u53c2\u8003\u7b54\u6848",children:"\u53c2\u8003\u7b54\u6848"}),"\n",(0,r.jsx)(e.h3,{id:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c-87-\u9898-1",children:"\u5168\u771f\u6a21\u62df\u4e00\u7b2c 87 \u9898"}),"\n",(0,r.jsxs)(e.p,{children:["\u7b54\u6848\u662f\uff1a",(0,r.jsx)(e.strong,{children:"1 3 5 7 9"})]}),"\n",(0,r.jsx)(e.h3,{id:"\u5168\u771f\u6a21\u62df\u56db\u7b2c-84-\u9898-1",children:"\u5168\u771f\u6a21\u62df\u56db\u7b2c 84 \u9898"}),"\n",(0,r.jsxs)(e.p,{children:["\u7b54\u6848\u662f\uff1a",(0,r.jsx)(e.strong,{children:"0"}),"\n\u6ce8\u610f\u4e8b\u9879"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u89e6\u53d1\u5668\u4e2d\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"OLD.\u56fe\u4e66\u7f16\u53f7"})," \u83b7\u53d6\u88ab\u5220\u9664\u884c\u7684\u56fe\u4e66\u7f16\u53f7"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"AFTER DELETE"})," \u8868\u793a\u5728\u5220\u9664\u64cd\u4f5c\u5b8c\u6210\u540e\u6267\u884c\u89e6\u53d1\u5668"]}),"\n",(0,r.jsx)(e.li,{children:"\u8fd9\u4e2a\u89e6\u53d1\u5668\u53ef\u80fd\u5bfc\u81f4\u7ea7\u8054\u5220\u9664\uff0c\u5b9e\u9645\u5e94\u7528\u4e2d\u9700\u8981\u8003\u8651\u4e1a\u52a1\u903b\u8f91\u662f\u5426\u9700\u8981\u8fd9\u79cd\u64cd\u4f5c"}),"\n"]})]})}function j(d={}){const{wrapper:e}={...(0,i.R)(),...d.components};return e?(0,r.jsx)(e,{...d,children:(0,r.jsx)(x,{...d})}):x(d)}},8453(d,e,s){s.d(e,{R:()=>t,x:()=>l});var n=s(6540);const r={},i=n.createContext(r);function t(d){const e=n.useContext(i);return n.useMemo(function(){return"function"==typeof d?d(e):{...e,...d}},[e,d])}function l(d){let e;return e=d.disableParentContext?"function"==typeof d.components?d.components(r):d.components||r:t(d.components),n.createElement(i.Provider,{value:e},d.children)}}}]);